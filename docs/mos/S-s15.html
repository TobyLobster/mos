<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 15: OSBYTE and OSWORD</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*CAT</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory-mapped i/o</a></li>
<li><a href="S-s4.html"><b>$C000</b>: chapter 4</a></li>
<li><a href="S-s5.html"><b>$C4C0</b>: chapter 5</a></li>
<li><a href="S-s6.html"><b>$CB1D</b>: chapter 6</a></li>
<li><a href="S-s7.html"><b>$CCF8</b>: chapter 7</a></li>
<li><a href="S-s8.html"><b>$D060</b>: chapter 8</a></li>
<li><a href="S-s9.html"><b>$D7C2</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$D940</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$DC1C</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$DEC5</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$E0A4</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$E20E</b>: chapter 14</a></li>
<li><span class="unlink"><b>$E5B3</b>: chapter 15</span></li>
<li><a href="S-s16.html"><b>$EB03</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$EEDA</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$F135</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$F588</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$F8A9</b>: chapter 20</a></li>
<li><a href="S-s21.html"><b>$FAE8</b>: chapter 21</a></li>
<li><a href="S-s22.html"><b>$FC00</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$FF00</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$FFA7</b>: chapter 24</a></li>
<li><a href="S-s25.html">appendix</a></li>
<li><a href="S-s26.html">index</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 15: OSBYTE and OSWORD' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">MOS 1.20</a></li><li><b>Chapter 15: OSBYTE and OSWORD</b></li></ul></div>
<p class="purpose">VDU 7; OSBYTE 0-14, 16, 18, 19, 117, 118, 124-126, 128-130, 136, 137, 144, 147, 149, 151, 154, 155, 160, 247; OSWORD 0-8; OSBYTE entry point; OSWORD entry point; *LINE; *CODE; Serial baud rate / sound buffer table; GSINIT; GSREAD; Keyboard handling routines - 1360 bytes (8.3%)</p>

<ul class="toc"><li><a href="S-s15.html#SP1">&#167;1. OSBYTE/OSWORD lookup table</a></li><li><a href="S-s15.html#SP2">&#167;2. OSBYTE 136 - Execute code via User Vector (*CODE)</a></li><li><a href="S-s15.html#SP3">&#167;3. Jumps to the User vector</a></li><li><a href="S-s15.html#SP4">&#167;4. OSBYTE 126 - Acknowledge detection of ESCAPE condition</a></li><li><a href="S-s15.html#SP5">&#167;5. OSBYTE 124 - Clear ESCAPE condition</a></li><li><a href="S-s15.html#SP6">&#167;6. OSBYTE 125 - Set ESCAPE condition</a></li><li><a href="S-s15.html#SP7">&#167;7. OSBYTE 137 - Turn on/off tape motor</a></li><li><a href="S-s15.html#SP8">&#167;8. OSBYTE 8 - Set RS-423 baud rate for transmitting data</a></li><li><a href="S-s15.html#SP9">&#167;9. OSBYTE 7 - Set RS-423 baud rate for receiving data</a></li><li><a href="S-s15.html#SP10">&#167;10. OSBYTE 9 - Duration of first colour</a></li><li><a href="S-s15.html#SP11">&#167;11. OSBYTE 10 - Duration of second colour</a></li><li><a href="S-s15.html#SP12">&#167;12. OSBYTE 2 - Select input stream</a></li><li><a href="S-s15.html#SP13">&#167;13. OSBYTE 13 - Disable events</a></li><li><a href="S-s15.html#SP14">&#167;14. OSBYTE 14 - Enable events</a></li><li><a href="S-s15.html#SP15">&#167;15. OSBYTE 16 - Select ADC channels</a></li><li><a href="S-s15.html#SP16">&#167;16. OSBYTE 129 - Read key within time limit</a></li><li><a href="S-s15.html#SP17">&#167;17. OSBYTE 130 - Read 'machine high order address'</a></li><li><a href="S-s15.html#SP18">&#167;18. Get free space from an input buffer, or used space from an output buffer</a></li><li><a href="S-s15.html#SP19">&#167;19. Get free bytes from RS-423 Input Buffer</a></li><li><a href="S-s15.html#SP20">&#167;20. OSBYTE 128 - Read ADC Channel, or get buffer status</a></li><li><a href="S-s15.html#SP21">&#167;21. OSBYTE - default entry point</a></li><li><a href="S-s15.html#SP22">&#167;22. osbyte166to255orOSWORD224to255</a></li><li><a href="S-s15.html#SP23">&#167;23. osbyte0to116</a></li><li><a href="S-s15.html#SP24">&#167;24. Unknown OSBYTE or OSWORD command</a></li><li><a href="S-s15.html#SP25">&#167;25. Check if it's ok to print a message</a></li><li><a href="S-s15.html#SP26">&#167;26. OSWORD - Default entry point</a></li><li><a href="S-s15.html#SP27">&#167;27. OSWORD 5 - Read a byte from I/O memory</a></li><li><a href="S-s15.html#SP28">&#167;28. OSWORD 6 - Write a byte to I/O memory</a></li><li><a href="S-s15.html#SP29">&#167;29. setUpDataBlock</a></li><li><a href="S-s15.html#SP30">&#167;30. OSBYTE 0 - Display version number</a></li><li><a href="S-s15.html#SP31">&#167;31. OSWORD 7 - Make a sound</a></li><li><a href="S-s15.html#SP32">&#167;32. OSBYTE 117 - Read VDU status</a></li><li><a href="S-s15.html#SP33">&#167;33. VDU 7 (.charBELL)</a></li><li><a href="S-s15.html#SP34">&#167;34. osword7Speech</a></li><li><a href="S-s15.html#SP35">&#167;35. addPitchAndDurationToSoundBuffer</a></li><li><a href="S-s15.html#SP36">&#167;36. OSWORD 8 - Define an envelope</a></li><li><a href="S-s15.html#SP37">&#167;37. getChannelNumberAndFlush</a></li><li><a href="S-s15.html#SP38">&#167;38. OSWORD 3 - Read interval timer</a></li><li><a href="S-s15.html#SP39">&#167;39. OSWORD 1 - Read system clock</a></li><li><a href="S-s15.html#SP40">&#167;40. OSWORD 4 - Write interval timer</a></li><li><a href="S-s15.html#SP41">&#167;41. OSWORD 2 - Write system clock</a></li><li><a href="S-s15.html#SP42">&#167;42. Write system clock or interval timer</a></li><li><a href="S-s15.html#SP43">&#167;43. OSWORD 0 - Read line from current input into memory</a></li><li><a href="S-s15.html#SP44">&#167;44. readLineInputBufferFull</a></li><li><a href="S-s15.html#SP45">&#167;45. readInputCharacter</a></li><li><a href="S-s15.html#SP46">&#167;46. OSBYTE 5 - Select printer type</a></li><li><a href="S-s15.html#SP47">&#167;47. OSBYTE 1 - Read/Write user flag; OSBYTE 6 - Set printer ignore character</a></li><li><a href="S-s15.html#SP48">&#167;48. OSBYTE 12 - Set keyboard autorepeat rate</a></li><li><a href="S-s15.html#SP49">&#167;49. OSBYTE 11 - Set keyboard autorepeat delay</a></li><li><a href="S-s15.html#SP50">&#167;50. OSBYTE 3 - Select output stream; OSBYTE 4 - Enable/disable cursor editing</a></li><li><a href="S-s15.html#SP51">&#167;51. OSBYTE 166 to 255 - read/write system variable</a></li><li><a href="S-s15.html#SP52">&#167;52. Table of buffer types and serial baud rates</a></li><li><a href="S-s15.html#SP53">&#167;53. OSBYTE 19 - Wait for vertical sync</a></li><li><a href="S-s15.html#SP54">&#167;54. OSBYTE 160 - Read VDU Variable</a></li><li><a href="S-s15.html#SP55">&#167;55. OSBYTE 18 - Reset soft keys</a></li><li><a href="S-s15.html#SP56">&#167;56. OSBYTE 118 - Set keyboard LEDs based on keyboard status</a></li><li><a href="S-s15.html#SP57">&#167;57. turnOnKeyboardLightsAndTestEscape</a></li><li><a href="S-s15.html#SP58">&#167;58. writeAToSystemVIARegisterB</a></li><li><a href="S-s15.html#SP59">&#167;59. OSBYTE 154 - Write to Video ULA's Video Control Register</a></li><li><a href="S-s15.html#SP60">&#167;60. OSBYTE 155 - Set palette value</a></li><li><a href="S-s15.html#SP61">&#167;61. gsinitForFilenameParsing</a></li><li><a href="S-s15.html#SP62">&#167;62. GSINIT - Initialise parsing of a string</a></li><li><a href="S-s15.html#SP63">&#167;63. GSREAD - Read one character by parsing the input string</a></li><li><a href="S-s15.html#SP64">&#167;64. brkBadString</a></li><li><a href="S-s15.html#SP65">&#167;65. Apply SHIFT to character in A</a></li><li><a href="S-s15.html#SP66">&#167;66. Modify character in A as if the CTRL key is being pressed</a></li><li><a href="S-s15.html#SP67">&#167;67. runBootString</a></li><li><a href="S-s15.html#SP68">&#167;68. OSBYTE 247 - Intercept BREAK</a></li><li><a href="S-s15.html#SP69">&#167;69. OSBYTE 144 - *TV</a></li><li><a href="S-s15.html#SP70">&#167;70. OSBYTE 147 - Write a byte to FRED</a></li><li><a href="S-s15.html#SP71">&#167;71. OSBYTE 149 - Write a byte to JIM</a></li><li><a href="S-s15.html#SP72">&#167;72. OSBYTE 151 - Write a byte to SHEILA</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. OSBYTE/OSWORD lookup table. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Valid OSBYTEs are in the arbitrary ranges 0-21, 117-160, 166-255. The range 166-255 reads</span>
<span class="ACME-plain-syntax"> and writes to a contiguous range of memory locations, and are implemented by a single</span>
<span class="ACME-plain-syntax"> routine. Otherwise the reasoning behind these ranges is unclear. Perhaps 0-21 were</span>
<span class="ACME-plain-syntax"> anticipated (erroneously or otherwise) to be the more commonly used OSBYTEs?</span>

<span class="ACME-plain-syntax"> Valid OSWORDs are in the range 0-13, and OSWORDs 224-255 are sent through USERV.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyteAndOSWORDRoutineTable</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyteAndOSWORDRoutineTable</span></span>:<br/><a href="S-s15.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e5b3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP30" class="function-link"><span class="ACME-function-syntax">osbyte0EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   0 - Display version number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP47" class="function-link"><span class="ACME-function-syntax">osbyte1EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   1 - Read/Write user flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP12" class="function-link"><span class="ACME-function-syntax">osbyte2EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   2 - select input stream</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP50" class="function-link"><span class="ACME-function-syntax">osbyte3EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   3 - Select output stream</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP50" class="function-link"><span class="ACME-function-syntax">osbyte4EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   4 - Enable / disable cursor editing</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP46" class="function-link"><span class="ACME-function-syntax">osbyte5EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   5 - Select printer type</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP47" class="function-link"><span class="ACME-function-syntax">osbyte6EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   6 - Set printer ignore character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">osbyte7EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   7 - Set RS-423 baud rate for receiving data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP8" class="function-link"><span class="ACME-function-syntax">osbyte8EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   8 - Set RS-423 baud rate for transmitting data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP10" class="function-link"><span class="ACME-function-syntax">osbyte9EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSBYTE   9 - Duration of first colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyte10EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  10 - Duration of second colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP49" class="function-link"><span class="ACME-function-syntax">osbyte11EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  11 - Set keyboard autorepeat delay</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP48" class="function-link"><span class="ACME-function-syntax">osbyte12EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  12 - Set keyboard autorepeat rate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP13" class="function-link"><span class="ACME-function-syntax">osbyte13EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  13 - Disable events</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP14" class="function-link"><span class="ACME-function-syntax">osbyte14EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  14 - Enable events</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP28" class="function-link"><span class="ACME-function-syntax">osbyte15EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  15 - Flush selected buffer class</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP15" class="function-link"><span class="ACME-function-syntax">osbyte16EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  16 - Select ADC channels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s11.html#SP21" class="function-link"><span class="ACME-function-syntax">osbyte17EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  17 - Start ADC conversions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP55" class="function-link"><span class="ACME-function-syntax">osbyte18EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  18 - Reset soft keys</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP53" class="function-link"><span class="ACME-function-syntax">osbyte19EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  19 - Wait for vertical sync</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP2" class="function-link"><span class="ACME-function-syntax">osbyte20EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  20 - 'Explode' soft character definitions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP29" class="function-link"><span class="ACME-function-syntax">osbyte21EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSBYTE  21 - Flush specific buffer</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP32" class="function-link"><span class="ACME-function-syntax">osbyte117EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 117 - Read VDU status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP56" class="function-link"><span class="ACME-function-syntax">osbyte118EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 118 - Set keyboard LEDs based on keyboard status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP6" class="function-link"><span class="ACME-function-syntax">osbyte119EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 119 - Close Spool / Exec files</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP15" class="function-link"><span class="ACME-function-syntax">osbyte120EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 120 - Write key pressed data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP33" class="function-link"><span class="ACME-function-syntax">osbyte121EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 121 - Keyboard scan from value in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP32" class="function-link"><span class="ACME-function-syntax">osbyte122EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 122 - Keyboard scan from 16 decimal</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP7" class="function-link"><span class="ACME-function-syntax">osbyte123EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 123 - Warn OS about printer going dormant</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte124EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 124 - Clear ESCAPE condition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP6" class="function-link"><span class="ACME-function-syntax">osbyte125EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 125 - Set ESCAPE condition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP4" class="function-link"><span class="ACME-function-syntax">osbyte126EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 126 - Acknowledge detection of ESCAPE condition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP15" class="function-link"><span class="ACME-function-syntax">osbyte127EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 127 - Check for EOF on open file</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP20" class="function-link"><span class="ACME-function-syntax">osbyte128EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 128 - Read ADC Channel / get buffer status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP16" class="function-link"><span class="ACME-function-syntax">osbyte129EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 129 - Read key within time limit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP17" class="function-link"><span class="ACME-function-syntax">osbyte130EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 130 - Read machine high order address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP24" class="function-link"><span class="ACME-function-syntax">osbyte131EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 131 - Read OSHWM (OS High Water Mark)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP10" class="function-link"><span class="ACME-function-syntax">osbyte132EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 132 - Read HIMEM (start of screen memory)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyte133EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 133 - Read start of screen memory for given MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP63" class="function-link"><span class="ACME-function-syntax">osbyte134EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 134 - Read text cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP1" class="function-link"><span class="ACME-function-syntax">osbyte135EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 135 - Read character at text cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP2" class="function-link"><span class="ACME-function-syntax">osbyte136EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 136 - Execute code via User Vector (*CODE)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP7" class="function-link"><span class="ACME-function-syntax">osbyte137EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 137 - Turn on tape motor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP27" class="function-link"><span class="ACME-function-syntax">osbyte138EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 138 - Put byte into buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP14" class="function-link"><span class="ACME-function-syntax">osbyte139EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 139 - Select file options (*OPT)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s18.html#SP2" class="function-link"><span class="ACME-function-syntax">osbyte140EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 140 - Select TAPE file system</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s18.html#SP2" class="function-link"><span class="ACME-function-syntax">osbyte141EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 141 - Select ROM file system</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP30" class="function-link"><span class="ACME-function-syntax">osbyte142EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 142 - Enter language ROM (at $8000)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s18.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte143EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 143 - Pass service commands to sideways ROMs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP69" class="function-link"><span class="ACME-function-syntax">osbyte144EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 144 - *TV</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP23" class="function-link"><span class="ACME-function-syntax">osbyte145EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 145 - Get byte from buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP2" class="function-link"><span class="ACME-function-syntax">osbyte146EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 146 - Read a byte from FRED</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP70" class="function-link"><span class="ACME-function-syntax">osbyte147EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 147 - Write a byte to FRED</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP3" class="function-link"><span class="ACME-function-syntax">osbyte148EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 148 - Read a byte from JIM</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP71" class="function-link"><span class="ACME-function-syntax">osbyte149EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 149 - Write a byte to JIM</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP4" class="function-link"><span class="ACME-function-syntax">osbyte150EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 150 - Read a byte from SHEILA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP72" class="function-link"><span class="ACME-function-syntax">osbyte151EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 151 - Write a byte to SHEILA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP22" class="function-link"><span class="ACME-function-syntax">osbyte152EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 152 - Examine buffer status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP31" class="function-link"><span class="ACME-function-syntax">osbyte153EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 153 - Put byte in input buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP59" class="function-link"><span class="ACME-function-syntax">osbyte154EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 154 - Write to Video ULA's Video Control Register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP60" class="function-link"><span class="ACME-function-syntax">osbyte155EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 155 - Set palette value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte156EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 156 - Update ACIA Control Register and OS Copy</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP1" class="function-link"><span class="ACME-function-syntax">osbyte157EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 157 - Fast Tube BPUT</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s16.html#SP22" class="function-link"><span class="ACME-function-syntax">osbyte158EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 158 - Read byte from speech processor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s16.html#SP24" class="function-link"><span class="ACME-function-syntax">osbyte159EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 159 - Write byte to speech processor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP54" class="function-link"><span class="ACME-function-syntax">osbyte160EntryPoint</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">OSBYTE 160 - Read VDU Variable</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP51" class="function-link"><span class="ACME-function-syntax">osbyte166to255EntryPoint</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">OSBYTE 166 to 255 - Implemented via table lookup</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP3" class="function-link"><span class="ACME-function-syntax">uservJumper</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">OSWORD 224-255 (unknown OSWORDs sent through USERV)</span>


<span class="ACME-comment-syntax">OSWORD lookup table - effectively a continuation of the same table as above</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP43" class="function-link"><span class="ACME-function-syntax">osword0EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   0 - Read line from current input into memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP39" class="function-link"><span class="ACME-function-syntax">osword1EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   1 - Read system clock</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP41" class="function-link"><span class="ACME-function-syntax">osword2EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   2 - Write system clock</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP38" class="function-link"><span class="ACME-function-syntax">osword3EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   3 - Read interval timer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP40" class="function-link"><span class="ACME-function-syntax">osword4EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   4 - Write interval timer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP27" class="function-link"><span class="ACME-function-syntax">osword5EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   5 - Read a byte from I/O memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP28" class="function-link"><span class="ACME-function-syntax">osword6EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   6 - Write a byte to I/O memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP31" class="function-link"><span class="ACME-function-syntax">osword7EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   7 - Make a sound</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP36" class="function-link"><span class="ACME-function-syntax">osword8EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   8 - Define an envelope</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP34" class="function-link"><span class="ACME-function-syntax">osword9EntryPoint</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">OSWORD   9 - Read a pixel</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP3" class="function-link"><span class="ACME-function-syntax">osword10EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSWORD  10 - Read character definition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">osword11EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSWORD  11 - Read palette</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP48" class="function-link"><span class="ACME-function-syntax">osword12EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSWORD  12 - Write Palette</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!word</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP59" class="function-link"><span class="ACME-function-syntax">osword13EntryPoint</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">OSWORD  13 - Read last two graphic cursor positions</span>
</pre>
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. OSBYTE 136 - Execute code via User Vector (*CODE). </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte136EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte136EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e657</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. Jumps to the User vector. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is called in response to *CODE, *LINE, or an OSWORD in the range 224-255. By default</span>
<span class="ACME-plain-syntax"> this does nothing, but user code can intercept the USERV vector to provide new functionality</span>
<span class="ACME-plain-syntax"> for these calls.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A=0         called from *CODE / *FX 136         .osbyteX / .osbyteY are parameters</span>
<span class="ACME-plain-syntax">       A=1         called from *LINE                   XY = address of string</span>
<span class="ACME-plain-syntax">       A=224-255   called from OSWORD 224-255          .oswordX / .oswordY are parameters</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">uservJumper</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">uservJumper</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a><br/>Chapter 12: Command Line Interpreter (star commands) - <a href="S-s12.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e659</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP13" class="function-link"><span class="ACME-function-syntax">vectorUSERV</span></a><span class="ACME-plain-syntax">)                                  </span><span class="ACME-comment-syntax">Jump via USERV</span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. OSBYTE 126 - Acknowledge detection of ESCAPE condition. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> If an ESCAPE condition has occurred, then this acknowledges (clears) it, informing the</span>
<span class="ACME-plain-syntax"> second processor of it via the Tube if present.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte126EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte126EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e65c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">escapeFlag</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">check for ESCAPE flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte124EntryPoint</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (no ESCAPE flag) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(just clear the ESCAPE condition)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">escapeEffects</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">get ESCAPE effects</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (escape effects is non-zero)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (no effects)</span>

<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">reset VDU paging counter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">close EXEC files</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">purge all buffers</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">Clear ESCAPE condition</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">allow interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">zero the number of lines printed</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">since last halt in paged mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s19.html#SP11" class="function-link"><span class="ACME-function-syntax">closeAndOptionallyOpenANewEXECFile</span></a><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">close any open EXEC file (A=0, Z=0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP28" class="function-link"><span class="ACME-function-syntax">flushAllBuffers</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">clear all buffers</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">X=$FF to indicate ESCAPE acknowledged</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. OSBYTE 124 - Clear ESCAPE condition. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte124EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte124EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a>, <a href="S-s15.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e673</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. OSBYTE 125 - Set ESCAPE condition. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       The regular OSBYTE entry sets carry (meaning set the ESCAPE condition).</span>
<span class="ACME-plain-syntax">       If falling through from OSBYTE 124 above then carry is clear (meaning clear the ESCAPE</span>
<span class="ACME-plain-syntax">       condition).</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte125EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte125EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a><br/>Chapter 14: Star commands - <a href="S-s14.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e674</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">escapeFlag</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">set/clear bit 7 of ESCAPE flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">tubePresentFlag</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">check if Tube is present</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Tube present) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP18" class="function-link"><span class="ACME-function-syntax">tubeCopyESCAPEFlagToSecondProcessor</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">Jumps into a Tube entry point</span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. OSBYTE 137 - Turn on/off tape motor. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = 0 to turn the motor off; otherwise turn the motor on</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte137EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte137EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e67f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">serialULARegisterCopy</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">get serial ULA control setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate left (shifts bit 7 into carry)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">if (X&gt;=1, i.e. turn on motor) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate carry back in serialULA copy</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(bit 7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">setSerialULADirectly</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. OSBYTE 8 - Set RS-423 baud rate for transmitting data. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = baud rate</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte8EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte8EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e689</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00111000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">Once it's EOR'd with the next</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">instruction,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">this value becomes %00000111 (set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">transmit baud rate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. OSBYTE 7 - Set RS-423 baud rate for receiving data. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = baud rate</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte7EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte7EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e68b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00111111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">converts 7 -&gt; $38 = %00111000 (set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">receive baud rate)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">converts $38 -&gt; 7 = %00000111 (set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">transmit baud rate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store result</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">serialULARegisterCopy</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">get serial ULA control register</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #9                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">putNewSettingYInXAndReturn</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">} is it 9 or more then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP52" class="function-link"><span class="ACME-function-syntax">bufferTypeAndSerialBaudRatesTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">and with byte from look up table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFB</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put Y in A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">set the transmit or receive baud</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">rate bits to 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">zero the transmit or receive baud</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">rate bits to 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFB</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">set baud rate from value read from</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">table lookup</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$40</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">set bit 6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">tapeRS423SelectionFlag</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">clear bit 6 if tape active (0=RS-423</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">or $40=TAPE)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setSerialULADirectly</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">setSerialULADirectly</span></span>:<br/><a href="S-s15.html#SP7">&#167;7</a><br/>Chapter 10: Resets - <a href="S-s10.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6a7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">serialULARegisterCopy</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">store serial ULA flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP7" class="function-link"><span class="ACME-function-syntax">serialULAControlRegister</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">and write to control register</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">putNewSettingYInXAndReturn</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">putNewSettingYInXAndReturn</span></span>:<br/><a href="S-s15.html#SP11">&#167;11</a>, <a href="S-s15.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6ad</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put Y in A to save old contents</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setXAndReturn</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">setXAndReturn</span></span>:<br/><a href="S-s15.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6ae</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">write new setting to X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. OSBYTE 9 - Duration of first colour. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">      Y = 0</span>
<span class="ACME-plain-syntax">      X = new value (in 1/50 of a second)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte9EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte9EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6b0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. OSBYTE 10 - Duration of second colour. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Y = 0 (or 1 if falling through from OSBYTE 9 call above)</span>
<span class="ACME-plain-syntax">       X = new value (in 1/50 of a second)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte10EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte10EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6b2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAFirstFlashingColourInterval</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">get mark period count</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get new count</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAFirstFlashingColourInterval</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back original value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put it in Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAFlashingColourIntervalCount</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">get value of flash counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAFlashingColourIntervalCount</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">restore old value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAVideoControlRegisterCopy</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">get current video ULA control</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">register setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate bit 0 into carry, carry into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate back carry into bit 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAVideoControlRegisterCopy</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">store it in RAM copy</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">videoULAControlRegister</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">and ULA control register</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">putNewSettingYInXAndReturn</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">ALWAYs branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. OSBYTE 2 - Select input stream. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X contains stream number</span>
<span class="ACME-plain-syntax">       X = 0 (keyboard selected, RS-423 disabled)</span>
<span class="ACME-plain-syntax">       X = 1 (RS-423 selected and enabled)</span>
<span class="ACME-plain-syntax">       X = 2 (keyboard selected, RS-423 enabled)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte2EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup15')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup15">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte2EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6d3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">blank out bits 1 - 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">rs423ControlRegisterCopy</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">and get current ACIA control setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Bit 7 into carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} if (X&gt;=1, i.e. RS-423 enabled)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} then set bit 7 of A, otherwise</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} clear it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">rs423ControlRegisterCopy</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">compare this with ACIA control</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">rs423ControlRegisterCopy</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">put A into ACIA control setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP5" class="function-link"><span class="ACME-function-syntax">acia6850ControlRegister</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">and write to control register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP4" class="function-link"><span class="ACME-function-syntax">setRS423Active</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">set up RS-423 buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back P</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (new setting different from old)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP6" class="function-link"><span class="ACME-function-syntax">acia6850DataRegister</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">set bit 6 and 7</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">currentInputBuffer</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get current input buffer number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">currentInputBuffer</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. OSBYTE 13 - Disable events. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> For information on Events, see .</span><a href="S-s14.html#SP25" class="internal">eventEntryPoint</a>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X contains event number 0-9 to disable</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte13EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup16')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup16">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte13EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6f9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=0; A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. OSBYTE 14 - Enable events. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> For information on Events, see .</span><a href="S-s14.html#SP25" class="internal">eventEntryPoint</a>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A contains zero for disabling the event, or non-zero to enable the event.</span>
<span class="ACME-plain-syntax">           This value is 14 if entry by OSBYTE 14 (which enables the event), or zero if</span>
<span class="ACME-plain-syntax">           falling through from OSBYTE 13 above (which disables the event).</span>
<span class="ACME-plain-syntax">       X contains event number 0-9 to enable</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       Y contains previous value</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte14EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup17')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup17">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte14EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e6fa</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #10                                             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">setXAndReturn</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">} if X&gt;9 then branch (set X from A</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} and return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">eventEnabledFlags</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">get old event enable flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">eventEnabledFlags</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">store new value in flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP9" class="function-link"><span class="ACME-function-syntax">putNewSettingYInXAndReturn</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">and exit</span>
</pre>
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. OSBYTE 16 - Select ADC channels. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Selects the range of channels for analogue to digital conversion (0-4)</span>
<span class="ACME-plain-syntax"> See .</span><a href="S-s11.html#SP21" class="internal">osbyte17EntryPoint</a>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X contains channel number (1-4) or 0 to disable conversions</span>
<span class="ACME-plain-syntax">       Y = 0</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte16EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup18')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup18">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte16EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e706</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X=0) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s11.html#SP21" class="function-link"><span class="ACME-function-syntax">osbyte17EntryPoint</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">start conversion</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">maximumADCChannelNumber</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get current maximum ADC channel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">maximumADCChannelNumber</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">store new value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put old value in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. OSBYTE 129 - Read key within time limit. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X and Y contains either:</span>
<span class="ACME-plain-syntax">           time limit in centi-seconds (Y=$7F max)</span>
<span class="ACME-plain-syntax">       or Y=$FF and X=-ve INKEY value for an instant read of a specific key</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte129EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup19')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup19">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte129EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e713</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP16" class="function-link"><span class="ACME-function-syntax">readNegativeKeyNumber</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (Y negative) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">allow interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s11.html#SP24" class="function-link"><span class="ACME-function-syntax">osbyte129Timed</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and go to timed routine</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">then X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readNegativeKeyNumber</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e721</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$7F</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">convert to keyboard input</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP20" class="function-link"><span class="ACME-function-syntax">keyJumper</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">then scan keyboard</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put bit 7 into carry</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setXYAndExit</span><button class="popup" onclick="togglePopup('usagePopup20')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup20">Usage of <span class="code-font"><span class="ACME-function-syntax">setXYAndExit</span></span>:<br/><a href="S-s15.html#SP20">&#167;20</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e729</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. OSBYTE 130 - Read 'machine high order address'. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Filing systems use 32 bit addresses, where $FF,$FF is used in the top two bytes to</span>
<span class="ACME-plain-syntax"> indicate the address is in the main (I/O processor) memory as opposed to the second</span>
<span class="ACME-plain-syntax"> processor memory. This routine returns the two values used for this purpose, namely $FF,$FF.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Carry set if entry is via OSBYTE 130</span>
<span class="ACME-plain-syntax">       Carry may be clear if falling through from routines above,</span>
<span class="ACME-plain-syntax">       either reading a key (.readNegativeKeyNumber) or doing an ADC conversion (.setXYAndExit).</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte130EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup21')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup21">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte130EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e729</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">X=$FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">Y=$FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry set, depends on entry</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. Get free space from an input buffer, or used space from an output buffer. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> For buffer numbers, see .</span><a href="S-s2.html#SP4" class="internal">bufferNumberKeyboard</a><span class="ACME-plain-syntax">.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X=255 - buffer number</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">countNegativeBuffer</span><button class="popup" onclick="togglePopup('usagePopup22')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup22">Usage of <span class="code-font"><span class="ACME-function-syntax">countNegativeBuffer</span></span>:<br/><a href="S-s15.html#SP20">&#167;20</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e732</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">buffer number in A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">invert it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">is X&gt;=2 (C set if output buffer, get</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bytes used)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">countBufferStartup</span><button class="popup" onclick="togglePopup('usagePopup23')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup23">Usage of <span class="code-font"><span class="ACME-function-syntax">countBufferStartup</span></span>:<br/><a href="S-s15.html#SP19">&#167;19</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e738</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLV</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear V flag (meaning count buffer)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP18" class="function-link"><span class="ACME-function-syntax">countOrPurgeBuffer</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">ALWAYS branch (count buffer)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">purgeBuffer</span><button class="popup" onclick="togglePopup('usagePopup24')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup24">Usage of <span class="code-font"><span class="ACME-function-syntax">purgeBuffer</span></span>:<br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e73b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP2" class="function-link"><span class="ACME-function-syntax">allBitsSet</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">set V flag (meaning purge buffer) (N</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">flag also set)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">countOrPurgeBuffer</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e73e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP13" class="function-link"><span class="ACME-function-syntax">vectorCNPV</span></a><span class="ACME-plain-syntax">)                                   </span><span class="ACME-comment-syntax">See .</span><a href="S-s13.html#SP11" class="internal">cnpEntryPoint</a><span class="ACME-comment-syntax"> for default</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">implementation</span>
</pre>
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. Get free bytes from RS-423 Input Buffer. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   carry set, all is OK</span>
<span class="ACME-plain-syntax">   carry clear, free space in buffer is low</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">getRS423InputBufferFreeBytes</span><button class="popup" onclick="togglePopup('usagePopup25')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup25">Usage of <span class="code-font"><span class="ACME-function-syntax">getRS423InputBufferFreeBytes</span></span>:<br/>Chapter 11: Interrupt processing - <a href="S-s11.html#SP4">&#167;4</a>, <a href="S-s11.html#SP5">&#167;5</a><br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e741</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">to check for free bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">X=1 to point to RS-423 input buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP18" class="function-link"><span class="ACME-function-syntax">countBufferStartup</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">and count it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">check the high byte of the length</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (one or more) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">rs423HandshakeExtent</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">compare with minimum buffer space</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">free</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP20" class="paragraph-anchor"></a><b>&#167;20. OSBYTE 128 - Read ADC Channel, or get buffer status. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:              On Exit:</span>
<span class="ACME-plain-syntax"> X=0                    Y contains number of last channel converted (1-4); X = fire buttons</span>
<span class="ACME-plain-syntax"> X=channel number (1-4) X,Y contain 16 bit value read from ADC channel (See .</span><a href="S-s11.html#SP21" class="internal">osbyte17EntryPoint</a><span class="ACME-plain-syntax">)</span>
<span class="ACME-plain-syntax"> X&lt;0 Y=$FF              X returns information about various buffers</span>
<span class="ACME-plain-syntax"> X=$FF (keyboard)       X = number of characters in buffer</span>
<span class="ACME-plain-syntax"> X=$FE (RS-423 input)   X = number of characters in buffer</span>
<span class="ACME-plain-syntax"> X=$FD (RS-423 output)  X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$FC (printer)        X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$FB (sound 0)        X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$FA (sound 1)        X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$F9 (sound 2)        X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$F8 (sound 3)        X = number of empty spaces in buffer</span>
<span class="ACME-plain-syntax"> X=$F7 (Speech)         X = number of empty spaces in buffer</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte128EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup26')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup26">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte128EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e74f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP18" class="function-link"><span class="ACME-function-syntax">countNegativeBuffer</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (X is -ve) then branch (count</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">space free/used)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP20" class="function-link"><span class="ACME-function-syntax">lastChannelConverted</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">if (X is zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #5                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP16" class="function-link"><span class="ACME-function-syntax">setXYAndExit</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">} if channel is not valid then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} branch (set X and Y to 255 and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">highByteLastByteFromADCChannel1</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">get last value read for channel of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">interest (high byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">lowByteLastByteFromADCChannel1</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">get last value read for channel of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">interest (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lastChannelConverted</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e75f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP10" class="function-link"><span class="ACME-function-syntax">systemVIARegisterB</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">read system VIA port B</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">move high nybble to low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">and invert it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">isolate the FIRE buttons</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">adcLastChannelRead</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">read last channel read</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">adcLastChannelRead</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store zero in last channel read</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X bits 0 and 1 indicate fire</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">buttons</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP21" class="paragraph-anchor"></a><b>&#167;21. OSBYTE - default entry point. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This entry point is executed for all OSBYTE calls. It routes the call through to one of the</span>
<span class="ACME-plain-syntax"> individual OSBYTE entry points by means of a table (see .</span><a href="S-s15.html#SP1" class="internal">osbyteAndOSWORDRoutineTable</a><span class="ACME-plain-syntax">).</span>

<span class="ACME-plain-syntax"> Note: OSBYTEs 0-127 only return a value in the X register, whereas OSBYTEs 128-255 can</span>
<span class="ACME-plain-syntax"> return values in X,Y and carry. This fact is used to speed up access via the Tube.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyteEntryPoint</span><button class="popup" onclick="togglePopup('usagePopup27')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup27">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyteEntryPoint</span></span>:<br/>Chapter 10: Resets - <a href="S-s10.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e772</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save Processor flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteA</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">} copy A,X,Y into zero page</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP7" class="function-link"><span class="ACME-function-syntax">romServiceCallUnrecognisedOSBYTE</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">set X so that (if necessary) we can</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">signal to ROMs that an unrecognised</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">osbyte is being attempted</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #117                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP23" class="function-link"><span class="ACME-function-syntax">osbyte0to116</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (A &lt; 117) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #161                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">osbyte117To160</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (A &lt; 161) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #166                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP24" class="function-link"><span class="ACME-function-syntax">unknownOSBYTEOrOSWORD</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (A &lt; 166) then branch (with carry</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">clear)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">at this point OSBYTE number in A &gt;= 166</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP22" class="paragraph-anchor"></a><b>&#167;22. osbyte166to255orOSWORD224to255. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte166to255orOSWORD224to255</span><button class="popup" onclick="togglePopup('usagePopup28')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup28">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte166to255orOSWORD224to255</span></span>:<br/><a href="S-s15.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e78a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">NOTE: Entry 161 and 162 in the table have special meanings, which are used here</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if entry is via OSBYTE, then carry is clear and we look up entry 161 in table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if entry is via OSWORD, then carry is  set  and we look up entry 162 in table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #161                                            </span><span class="ACME-comment-syntax">A = 161</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Add carry</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte117To160</span><button class="popup" onclick="togglePopup('usagePopup29')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup29">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte117To160</span></span>:<br/><a href="S-s15.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e78e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #95                                             </span><span class="ACME-comment-syntax">if OSBYTE, converts A into range</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(22-66); if OSWORD then A=67</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">indexToTable</span><button class="popup" onclick="togglePopup('usagePopup30')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup30">Usage of <span class="code-font"><span class="ACME-function-syntax">indexToTable</span></span>:<br/><a href="S-s15.html#SP23">&#167;23</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e791</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">double A to get offset into table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyteOrOSWORDTableLookup</span><button class="popup" onclick="togglePopup('usagePopup31')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup31">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyteOrOSWORDTableLookup</span></span>:<br/><a href="S-s15.html#SP26">&#167;26</a><br/>Chapter 2: Memory Layout and Constants - <a href="S-s2.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e793</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">store Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check for Econet intercept</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">[There's a quirk here:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> The following instruction sets V if bit 6 of .econetOSCallInterceptionFlag is</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> set. If bit 7 is clear as well, then we call whatever OSBYTE routine with V set,</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> which has some unexpected side effects. A few OSBYTE routines rely on V being clear,</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> So for example:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">      *FX 206,64      - sets the .econetOSCallInterceptionFlag to 64</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">      *FX 10,1        - set the flashing colour time</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> This unexpectedly turns on RS-423 output, meaning you can't type at the keyboard</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> any more!</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> However, practically speaking there's no real reason you would need to set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> .econetOSCallInterceptionFlag to anything other than either zero or something with</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax"> the top bit set so this probably never occurs in the wild.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">econetOSCallInterceptionFlag</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">check Econet intercept flag (bit 7)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">we expect bit 6 to be clear!</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">skipEconetCall</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (no Econet intercept required)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (skip Econet check)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLV</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">V=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP34" class="function-link"><span class="ACME-function-syntax">netvJumper</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">to JMP via ECONET vector</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">finishUpOSBYTEOrOSWORD</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (returned with V set) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(finish up and exit)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipEconetCall</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7a2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">read routine address from table and store in .tempStoreFA/B</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP1" class="function-link"><span class="ACME-function-syntax">osbyteAndOSWORDRoutineTable</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">get address from table (high byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFB</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store as high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP1" class="function-link"><span class="ACME-function-syntax">osbyteAndOSWORDRoutineTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get address from table (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store as low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteA</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">restore Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">setCarryXAndJumpOSBYTE</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (carry is set, i.e. an OSBYTE</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">call) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">OSWORD call. Set A to the value in the first byte of the parameter block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">read first byte from parameter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">address block (XY)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCarryXAndJumpOSBYTE</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7b6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">restore X</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Finally, call the OSBYTE / OSWORD routine address</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">For an OSBYTE call:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  A,X,Y are set to the three parameters sent to .OSBYTE. These are also stored in</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">        .osbyteA, .osbyteX and .osbyteY.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Carry is set.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Zero flag is set if X is zero.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Negative flag is set if X has it's top bit set.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  V is clear. (But see .</span><a href="S-s15.html#SP22" class="internal">osbyteOrOSWORDTableLookup</a><span class="ACME-comment-syntax"> above for a 'bug')</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">For an OSWORD call:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  .oswordA hold the OSWORD number.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  A is set to the first byte of the parameter block at the address held in</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.oswordX/.oswordY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  X is set to .oswordX, the lower byte of the address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Y is set to zero.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Carry is set.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Zero flag is set if X is zero.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  Negative flag is set if X has it's top bit set.</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP18" class="function-link"><span class="ACME-function-syntax">osbyteOrOSWORDJumper</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">call OSBYTE/OSWORD routine address</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">stored in (.tempStoreFA/B)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishUpOSBYTEOrOSWORD</span><button class="popup" onclick="togglePopup('usagePopup32')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup32">Usage of <span class="code-font"><span class="ACME-function-syntax">finishUpOSBYTEOrOSWORD</span></span>:<br/><a href="S-s15.html#SP24">&#167;24</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7bc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">C=bit 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">bit 0=Carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLV</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear V</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP23" class="paragraph-anchor"></a><b>&#167;23. osbyte0to116. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte0to116</span><button class="popup" onclick="togglePopup('usagePopup33')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup33">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte0to116</span></span>:<br/><a href="S-s15.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7c2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #22                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">indexToTable</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (A &lt; 22) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">OSBYTE 22 to 116: these are unknown OSBYTE calls</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through with carry set...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP24" class="paragraph-anchor"></a><b>&#167;24. Unknown OSBYTE or OSWORD command. </b>Pass it onto ROMs for servicing..
</p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">unknownOSBYTEOrOSWORD</span><button class="popup" onclick="togglePopup('usagePopup34')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup34">Usage of <span class="code-font"><span class="ACME-function-syntax">unknownOSBYTEOrOSWORD</span></span>:<br/><a href="S-s15.html#SP21">&#167;21</a>, <a href="S-s15.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7c8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">pullTwiceAndOfferCallToROMs</span><button class="popup" onclick="togglePopup('usagePopup35')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup35">Usage of <span class="code-font"><span class="ACME-function-syntax">pullTwiceAndOfferCallToROMs</span></span>:<br/><a href="S-s15.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7ca</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s18.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte143EntryPoint</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">offer paged ROMs service 7/8</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">unrecognised osbyte/word</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP24" class="function-link"><span class="ACME-function-syntax">romsDontRecogniseUnknownCommand</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (ROMs don't recognise it) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">restore X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">finishUpOSBYTEOrOSWORD</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">finish up</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">romsDontRecogniseUnknownCommand</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7d6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">and A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP2" class="function-link"><span class="ACME-function-syntax">allBitsSet</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">set N and V flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP25" class="paragraph-anchor"></a><b>&#167;25. Check if it's ok to print a message. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Checks if the cassette filing system is in a critical (busy) state</span>
<span class="ACME-plain-syntax"> Check the catalogue status (are we currently doing a *CAT or equivalent)</span>
<span class="ACME-plain-syntax"> Checks the bits that allow printing short or long messages</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       A = 0  (and therefore Z set)   means don't print messages</span>
<span class="ACME-plain-syntax">       A != 0 (and therefore Z clear) means messages can be printed</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">shouldPrintMessage</span><button class="popup" onclick="togglePopup('usagePopup36')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup36">Usage of <span class="code-font"><span class="ACME-function-syntax">shouldPrintMessage</span></span>:<br/>Chapter 20: Filing System Messaging and Error Reporting - <a href="S-s20.html#SP2">&#167;2</a>, <a href="S-s20.html#SP5">&#167;5</a>, <a href="S-s20.html#SP16">&#167;16</a><br/>Chapter 21: More Low Level Tape Operations - <a href="S-s21.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7dc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tapeCritical</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">read cassette critical flag bit 7 =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">busy</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP28" class="function-link"><span class="ACME-function-syntax">zeroAAndExit</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (tape critically busy) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check current catalogue status bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">fsStatusByte</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">check tape filing system status byte</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">has the catalogue status bit set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (catalogue bit set) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%10001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">A=%10001000 (these are the bits</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">set if a message is required)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tapeCurrentOptionsByte</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">AND with filing system options</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(short/long message bits)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP26" class="paragraph-anchor"></a><b>&#167;26. OSWORD - Default entry point. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This entry point is executed for all OSWORD calls. It routes the call through to one of</span>
<span class="ACME-plain-syntax"> the individual OSWORD entry points by means of a table (see .</span><a href="S-s15.html#SP1" class="internal">osbyteAndOSWORDRoutineTable</a><span class="ACME-plain-syntax">,</span>
<span class="ACME-plain-syntax"> at the end of which is the list of OSWORD entry points).</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">oswordEntryPoint</span><button class="popup" onclick="togglePopup('usagePopup37')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup37">Usage of <span class="code-font"><span class="ACME-function-syntax">oswordEntryPoint</span></span>:<br/>Chapter 10: Resets - <a href="S-s10.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e7eb</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Push A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordA</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">store A,X,Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">                                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordY</span></a><span class="ACME-plain-syntax">                                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP7" class="function-link"><span class="ACME-function-syntax">romServiceCallUnrecognisedOSWORD</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">set X so that if necessary, we can</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">signal to ROMs that an unrecognised</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">OSWORD is being attempted</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #224                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">osbyte166to255orOSWORD224to255</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">if (A &gt;= 224) then branch (OSWORDs</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">224-255 call USERV)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #14                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP24" class="function-link"><span class="ACME-function-syntax">unknownOSBYTEOrOSWORD</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (A &gt;= 14) then branch (unknown</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">OSWORD)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">OSWORD 0-13</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #68                                             </span><span class="ACME-comment-syntax">add 68 to form pointer to table (68</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to 81)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">double it to form low byte of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pointer ($88 to $A2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP22" class="function-link"><span class="ACME-function-syntax">osbyteOrOSWORDTableLookup</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP27" class="paragraph-anchor"></a><b>&#167;27. OSWORD 5 - Read a byte from I/O memory. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This allows the second processor to access main (first processor) memory across the Tube.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of the five bytes of parameters:</span>
<span class="ACME-plain-syntax">           byte 0-3: 32 bit address of byte</span>
<span class="ACME-plain-syntax">           byte 4  : on exit byte read</span>
<span class="ACME-plain-syntax">       A is the LSB of the 32 bit address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword5EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup38')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup38">Usage of <span class="code-font"><span class="ACME-function-syntax">osword5EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e803</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP29" class="function-link"><span class="ACME-function-syntax">setUpDataBlock</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">set up address of data block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">)                            </span><span class="ACME-comment-syntax">get byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP28" class="paragraph-anchor"></a><b>&#167;28. OSWORD 6 - Write a byte to I/O memory. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This allows the second processor to access main (first processor) memory across the Tube.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of the five bytes of parameters:</span>
<span class="ACME-plain-syntax">           byte 0-3: 32 bit address of byte</span>
<span class="ACME-plain-syntax">           byte 4  : byte to be written</span>
<span class="ACME-plain-syntax">       A is the LSB of the 32 bit address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword6EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup39')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup39">Usage of <span class="code-font"><span class="ACME-function-syntax">osword6EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e80b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP29" class="function-link"><span class="ACME-function-syntax">setUpDataBlock</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">set up address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte to write</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">)                            </span><span class="ACME-comment-syntax">write byte</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">zeroAAndExit</span><button class="popup" onclick="togglePopup('usagePopup40')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup40">Usage of <span class="code-font"><span class="ACME-function-syntax">zeroAAndExit</span></span>:<br/><a href="S-s15.html#SP25">&#167;25</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e812</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP29" class="paragraph-anchor"></a><b>&#167;29. setUpDataBlock. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setUpDataBlock</span><button class="popup" onclick="togglePopup('usagePopup41')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup41">Usage of <span class="code-font"><span class="ACME-function-syntax">setUpDataBlock</span></span>:<br/><a href="S-s15.html#SP27">&#167;27</a>, <a href="S-s15.html#SP28">&#167;28</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e815</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">.tempStoreFA=A=low byte of address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte from block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFB</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">.tempStoreFB=high byte of address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y=4</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exitWithX1</span><button class="popup" onclick="togglePopup('usagePopup42')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup42">Usage of <span class="code-font"><span class="ACME-function-syntax">exitWithX1</span></span>:<br/><a href="S-s15.html#SP30">&#167;30</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e81e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">X=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP30" class="paragraph-anchor"></a><b>&#167;30. OSBYTE 0 - Display version number. </b></p>

<p class="center-p"><img src="fx0.png" alt="fx0.png"></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Shows which version of the OS is installed. [Oddly this is implemented as an error message</span>
<span class="ACME-plain-syntax"> via the BRK mechanism. When running BASIC, BASIC's BRK handler is executed and so we have</span>
<span class="ACME-plain-syntax"> an extra newline and the last error number is set to 247. An alternative would have been</span>
<span class="ACME-plain-syntax"> to use the same printing method as used in *HELP (see .</span><a href="S-s17.html#SP30" class="internal">starHelp</a><span class="ACME-plain-syntax">). Indeed earlier versions</span>
<span class="ACME-plain-syntax"> of the OS did just that.]</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte0EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup43')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup43">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte0EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e821</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP29" class="function-link"><span class="ACME-function-syntax">exitWithX1</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">if (X is not zero) then branch (exit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">with X = 1 meaning OS 1.20)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BRK</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">print error message</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$F7</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"OS 1.20"</span><span class="ACME-plain-syntax">,0                                   </span><span class="ACME-comment-syntax">error string with zero terminator</span>
</pre>
<p class="commentary firstcommentary"><a id="SP31" class="paragraph-anchor"></a><b>&#167;31. OSWORD 7 - Make a sound. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of eight bytes of parameters:</span>
<span class="ACME-plain-syntax">           byte 0-1:  Channel ($HSFC as in the BASIC SOUND command)</span>
<span class="ACME-plain-syntax">           byte 2-3:  Amplitude</span>
<span class="ACME-plain-syntax">           byte 4-5:  Pitch</span>
<span class="ACME-plain-syntax">           byte 6-7:  Duration</span>

<span class="ACME-plain-syntax"> Channel</span>
<span class="ACME-plain-syntax"> -------</span>
<span class="ACME-plain-syntax"> H = hold bit (0-1) ensures that the existing sound currently playing on the given channel</span>
<span class="ACME-plain-syntax">     continues until the release phase of the envelope is totally finished before the next</span>
<span class="ACME-plain-syntax">     sound plays. Otherwise the sound is considered complete at the start of the release</span>
<span class="ACME-plain-syntax">     phase.</span>
<span class="ACME-plain-syntax">     The other sound parameters are then ignored.</span>
<span class="ACME-plain-syntax"> S = sync bits (0-2) is the number of future notes to be queued on other channels that are</span>
<span class="ACME-plain-syntax">     required before all the queued sounds start to play together at the same time.</span>
<span class="ACME-plain-syntax"> F = flush bit (0-1) stops any currently playing sound on the channel, forcing the new sound</span>
<span class="ACME-plain-syntax">     to play instead.</span>
<span class="ACME-plain-syntax"> C = channel (0-3). Channel 0 is the noise channel.</span>

<span class="ACME-plain-syntax"> If the high byte of the channel is $FF, then this is interpreted as a Speech command.</span>

<span class="ACME-plain-syntax"> Amplitude</span>
<span class="ACME-plain-syntax"> ---------</span>
<span class="ACME-plain-syntax"> The amplitude (loudness) is specified by a value in the range -15 (loudest) to 0 (silent).</span>
<span class="ACME-plain-syntax"> This is not a linear scale, with larger differences in volume between the louder sounds.</span>
<span class="ACME-plain-syntax"> Alternatively an envelope number can be specified (0-15).</span>

<span class="ACME-plain-syntax"> Pitch</span>
<span class="ACME-plain-syntax"> -----</span>
<span class="ACME-plain-syntax"> Given a pitch number in the range 0-255, the range of playable musical notes is from</span>
<span class="ACME-plain-syntax"> B2 to D8 in scientific notation (C4 being middle C). This is a range of 63 notes, over five</span>
<span class="ACME-plain-syntax"> octaves. See </span><a href="https://en.wikipedia.org/wiki/Scientific_pitch_notation." class="external">https://en.wikipedia.org/wiki/Scientific_pitch_notation.</a>

<span class="ACME-plain-syntax"> [Personally, I think one octave lower would have been nice. We basically only have one</span>
<span class="ACME-plain-syntax"> octave below middle C and over four octaves above. The range of notes is a little too</span>
<span class="ACME-plain-syntax"> much on the high end]</span>

<span class="ACME-plain-syntax"> The notes on the musical scale can be best approximated by the values in the following</span>
<span class="ACME-plain-syntax"> table. This table is similar to one in the original User Guide, but with more accurate</span>
<span class="ACME-plain-syntax"> values. Be aware that the pitch you hear also depends on the channel you play it on.</span>
<span class="ACME-plain-syntax"> See .</span><a href="S-s4.html#SP13" class="internal">soundPitchOffsetByChannelTable</a><span class="ACME-plain-syntax">. The table below gives the best pitch value to use to</span>
<span class="ACME-plain-syntax"> most accurately achieve the musical note, and for each channel</span>
<span class="ACME-plain-syntax"> (Channel 1 / Channel 2 / Channel 3) where they differ.</span>

<span class="ACME-plain-syntax">                                  Octave</span>
<span class="ACME-plain-syntax"> Note    2     3      4      5               6               7               8</span>
<span class="ACME-plain-syntax"> ---------------------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">  C      -     4      52     100             147/148/149     195/196/197     242/244/246</span>
<span class="ACME-plain-syntax">  C#     -     8      56     104             152/152/153     200/201/202     246/249/251</span>
<span class="ACME-plain-syntax">  D      -     12     60     108             155/156/157     203/204/206     249/251/254</span>
<span class="ACME-plain-syntax">  D#     -     16     64     112             160/160/161     207/209/210     -</span>
<span class="ACME-plain-syntax">  E      -     20     68     115/116/116     163/164/165     211/213/214     -</span>
<span class="ACME-plain-syntax">  F      -     24     72     120             168/168/169     214/216/217     -</span>
<span class="ACME-plain-syntax">  F#     -     28     76     124             172/172/173     219/221/222     -</span>
<span class="ACME-plain-syntax">  G      -     32     80     128             175/176/177     222/224/226     -</span>
<span class="ACME-plain-syntax">  G#     -     36     84     131/132/132     179/180/181     226/228/229     -</span>
<span class="ACME-plain-syntax">  A      -     40     88     135/136/136     183/184/185     229/231/233     -</span>
<span class="ACME-plain-syntax">  A#     -     44     92     139/140/140     187/188/189     233/235/237     -</span>
<span class="ACME-plain-syntax">  B      0     48     96     144/144/145     192/193/194     237/240/242     -</span>

<span class="ACME-plain-syntax"> Pitch is ultimately passed to the sound chip as a 10 bit integer (0-1023), so by directly</span>
<span class="ACME-plain-syntax"> accessing the sound chip more accurate pitch can be achieved. This is done by sending data</span>
<span class="ACME-plain-syntax"> to the System VIA. See NAUG Section 21.2 Page 375 for a detailed description of the format</span>
<span class="ACME-plain-syntax"> required by the sound chip, and example code. Then see .</span><a href="S-s16.html#SP14" class="internal">setPitchNotNoise</a><span class="ACME-plain-syntax"> and</span>
<span class="ACME-plain-syntax"> see .</span><a href="S-s16.html#SP3" class="internal">sendToSoundChip</a><span class="ACME-plain-syntax"> for code to send the pitch.</span>

<span class="ACME-plain-syntax"> See .</span><a href="S-s16.html#SP16" class="internal">pitchLookupTableLow</a><span class="ACME-plain-syntax"> for the relationship between the 10-bit pitch and frequency.</span>

<span class="ACME-plain-syntax"> The best chip values for each musical note are as below:</span>

<span class="ACME-plain-syntax">         10 bit</span>
<span class="ACME-plain-syntax">         Chip</span>
<span class="ACME-plain-syntax">         Value         Frequency           Note = Ideal Frequency       Error</span>
<span class="ACME-plain-syntax">         ----------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">           27          4629.63 Hz           D8  = 4698.64 Hz           69.01 Hz</span>
<span class="ACME-plain-syntax">           28          4464.29 Hz           C#8 = 4434.92 Hz           29.36 Hz</span>
<span class="ACME-plain-syntax">           30          4166.67 Hz           C8  = 4186.01 Hz           19.34 Hz</span>
<span class="ACME-plain-syntax">           32          3906.25 Hz           B7  = 3951.07 Hz           44.82 Hz</span>
<span class="ACME-plain-syntax">           34          3676.47 Hz           A#7 = 3729.31 Hz           52.84 Hz</span>
<span class="ACME-plain-syntax">           36          3472.22 Hz           A7  = 3520.00 Hz           47.78 Hz</span>
<span class="ACME-plain-syntax">           38          3289.47 Hz           G#7 = 3322.44 Hz           32.96 Hz</span>
<span class="ACME-plain-syntax">           40          3125.00 Hz           G7  = 3135.96 Hz           10.96 Hz</span>
<span class="ACME-plain-syntax">           42          2976.19 Hz           F#7 = 2959.96 Hz           16.24 Hz</span>
<span class="ACME-plain-syntax">           45          2777.78 Hz           F7  = 2793.83 Hz           16.05 Hz</span>
<span class="ACME-plain-syntax">           47          2659.57 Hz           E7  = 2637.02 Hz           22.55 Hz</span>
<span class="ACME-plain-syntax">           50          2500.00 Hz           D#7 = 2489.02 Hz           10.98 Hz</span>
<span class="ACME-plain-syntax">           53          2358.49 Hz           D7  = 2349.32 Hz            9.17 Hz</span>
<span class="ACME-plain-syntax">           56          2232.14 Hz           C#7 = 2217.46 Hz           14.68 Hz</span>
<span class="ACME-plain-syntax">           60          2083.33 Hz           C7  = 2093.00 Hz            9.67 Hz</span>
<span class="ACME-plain-syntax">           63          1984.13 Hz           B6  = 1975.53 Hz            8.59 Hz</span>
<span class="ACME-plain-syntax">           67          1865.67 Hz           A#6 = 1864.66 Hz            1.02 Hz</span>
<span class="ACME-plain-syntax">           71          1760.56 Hz           A6  = 1760.00 Hz            0.56 Hz</span>
<span class="ACME-plain-syntax">           75          1666.67 Hz           G#6 = 1661.22 Hz            5.45 Hz</span>
<span class="ACME-plain-syntax">           80          1562.50 Hz           G6  = 1567.98 Hz            5.48 Hz</span>
<span class="ACME-plain-syntax">           84          1488.10 Hz           F#6 = 1479.98 Hz            8.12 Hz</span>
<span class="ACME-plain-syntax">           89          1404.49 Hz           F6  = 1396.91 Hz            7.58 Hz</span>
<span class="ACME-plain-syntax">           95          1315.79 Hz           E6  = 1318.51 Hz            2.72 Hz</span>
<span class="ACME-plain-syntax">          100          1250.00 Hz           D#6 = 1244.51 Hz            5.49 Hz</span>
<span class="ACME-plain-syntax">          106          1179.25 Hz           D6  = 1174.66 Hz            4.59 Hz</span>
<span class="ACME-plain-syntax">          113          1106.19 Hz           C#6 = 1108.73 Hz            2.54 Hz</span>
<span class="ACME-plain-syntax">          119          1050.42 Hz           C6  = 1046.50 Hz            3.92 Hz</span>
<span class="ACME-plain-syntax">          127           984.25 Hz           B5  =  987.77 Hz            3.51 Hz</span>
<span class="ACME-plain-syntax">          134           932.84 Hz           A#5 =  932.33 Hz            0.51 Hz</span>
<span class="ACME-plain-syntax">          142           880.28 Hz           A5  =  880.00 Hz            0.28 Hz</span>
<span class="ACME-plain-syntax">          150           833.33 Hz           G#5 =  830.61 Hz            2.72 Hz</span>
<span class="ACME-plain-syntax">          159           786.16 Hz           G5  =  783.99 Hz            2.17 Hz</span>
<span class="ACME-plain-syntax">          169           739.64 Hz           F#5 =  739.99 Hz            0.34 Hz</span>
<span class="ACME-plain-syntax">          179           698.32 Hz           F5  =  698.46 Hz            0.13 Hz</span>
<span class="ACME-plain-syntax">          190           657.89 Hz           E5  =  659.26 Hz            1.36 Hz</span>
<span class="ACME-plain-syntax">          201           621.89 Hz           D#5 =  622.25 Hz            0.36 Hz</span>
<span class="ACME-plain-syntax">          213           586.85 Hz           D5  =  587.33 Hz            0.48 Hz</span>
<span class="ACME-plain-syntax">          225           555.56 Hz           C#5 =  554.37 Hz            1.19 Hz</span>
<span class="ACME-plain-syntax">          239           523.01 Hz           C5  =  523.25 Hz            0.24 Hz</span>
<span class="ACME-plain-syntax">          253           494.07 Hz           B4  =  493.88 Hz            0.19 Hz</span>
<span class="ACME-plain-syntax">          268           466.42 Hz           A#4 =  466.16 Hz            0.25 Hz</span>
<span class="ACME-plain-syntax">          284           440.14 Hz           A4  =  440.00 Hz            0.14 Hz</span>
<span class="ACME-plain-syntax">          301           415.28 Hz           G#4 =  415.30 Hz            0.02 Hz</span>
<span class="ACME-plain-syntax">          319           391.85 Hz           G4  =  392.00 Hz            0.15 Hz</span>
<span class="ACME-plain-syntax">          338           369.82 Hz           F#4 =  369.99 Hz            0.17 Hz</span>
<span class="ACME-plain-syntax">          358           349.16 Hz           F4  =  349.23 Hz            0.07 Hz</span>
<span class="ACME-plain-syntax">          379           329.82 Hz           E4  =  329.63 Hz            0.19 Hz</span>
<span class="ACME-plain-syntax">          402           310.95 Hz           D#4 =  311.13 Hz            0.18 Hz</span>
<span class="ACME-plain-syntax">          426           293.43 Hz           D4  =  293.66 Hz            0.24 Hz</span>
<span class="ACME-plain-syntax">          451           277.16 Hz           C#4 =  277.18 Hz            0.02 Hz</span>
<span class="ACME-plain-syntax">          478           261.51 Hz           C4  =  261.63 Hz            0.12 Hz</span>
<span class="ACME-plain-syntax">          506           247.04 Hz           B3  =  246.94 Hz            0.09 Hz</span>
<span class="ACME-plain-syntax">          536           233.21 Hz           A#3 =  233.08 Hz            0.13 Hz</span>
<span class="ACME-plain-syntax">          568           220.07 Hz           A3  =  220.00 Hz            0.07 Hz</span>
<span class="ACME-plain-syntax">          602           207.64 Hz           G#3 =  207.65 Hz            0.01 Hz</span>
<span class="ACME-plain-syntax">          638           195.92 Hz           G3  =  196.00 Hz            0.07 Hz</span>
<span class="ACME-plain-syntax">          676           184.91 Hz           F#3 =  185.00 Hz            0.09 Hz</span>
<span class="ACME-plain-syntax">          716           174.58 Hz           F3  =  174.61 Hz            0.03 Hz</span>
<span class="ACME-plain-syntax">          758           164.91 Hz           E3  =  164.81 Hz            0.09 Hz</span>
<span class="ACME-plain-syntax">          804           155.47 Hz           D#3 =  155.56 Hz            0.09 Hz</span>
<span class="ACME-plain-syntax">          851           146.89 Hz           D3  =  146.83 Hz            0.05 Hz</span>
<span class="ACME-plain-syntax">          902           138.58 Hz           C#3 =  138.59 Hz            0.01 Hz</span>
<span class="ACME-plain-syntax">          956           130.75 Hz           C3  =  130.81 Hz            0.06 Hz</span>
<span class="ACME-plain-syntax">         1012           123.52 Hz           B2  =  123.47 Hz            0.05 Hz</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword7EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup44')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup44">Usage of <span class="code-font"><span class="ACME-function-syntax">osword7EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e82d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to read byte 1 of block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">read channel high byte 'HS'</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">check if it's $FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP34" class="function-link"><span class="ACME-function-syntax">osword7Speech</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">if (high byte of channel is $FF)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (handle speech command)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$20</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">if (channel high byte is $20 or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">more) then set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP7" class="function-link"><span class="ACME-function-syntax">romServiceCallUnrecognisedOSWORD</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">X = paged ROM service request</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">'unrecognised OSWORD call'</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP24" class="function-link"><span class="ACME-function-syntax">pullTwiceAndOfferCallToROMs</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (channel &gt;= $2000) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(offer it to ROMs as unknown OSWORD)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">point at start of block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP37" class="function-link"><span class="ACME-function-syntax">getChannelNumberAndFlush</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">returns with carry set if flush is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">required, and A=channel number (0-3)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">convert channel number to buffer</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">number (4-7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = buffer number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry clear) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP10" class="function-link"><span class="ACME-function-syntax">flushSoundBufferX</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">flush buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">Y=1</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP37" class="function-link"><span class="ACME-function-syntax">getSyncNumberAndHold</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">get sync number (0-3) (carry set if</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">hold is required)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">.tempStoreFA = sync number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">} get duration (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">} get pitch (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">} get amplitude (low byte) in the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} range -15 to 0 (static volume) or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} 1 to 4 (envelope controlled)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point carry contains the 'hold' bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">and .tempStoreFA contains the two 'sync' bits</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">multiply amplitude by two, and add</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">carry into bit zero = hold bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">subtract 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} multiply by 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">add sync value (0-3)</span>

<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">To illustrate the changes made by the last six instructions, here is a table showing</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">the changes at each step. Each row is a different value for the amplitude (values &gt; 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">are the envelope number 1-4), and the columns show the result after each subsequent</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">instruction.</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Amplitude   Binary       ROL           SEC;SBC#2    ASL; ASL     ORA .tempStoreFA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                         h=hold bit                              ss=sync bits</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">---------------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">    4       %00000100    %0000100h     %0000011h    %00011h00    %00011hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">    3       %00000011    %0000011h     %0000010h    %00010h00    %00010hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">    2       %00000010    %0000010h     %0000001h    %00001h00    %00001hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">    1       %00000001    %0000001h     %0000000h    %00000h00    %00000hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">    0       %00000000    %0000000h     %1111111h    %11111h00    %11111hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -1       %11111111    %1111111h     %1111110h    %11110h00    %11110hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -2       %11111110    %1111110h     %1111101h    %11101h00    %11101hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -3       %11111101    %1111101h     %1111100h    %11100h00    %11100hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -4       %11111100    %1111100h     %1111011h    %11011h00    %11011hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -5       %11111011    %1111011h     %1111010h    %11010h00    %11010hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -6       %11111010    %1111010h     %1111001h    %11001h00    %11001hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -7       %11111001    %1111001h     %1111000h    %11000h00    %11000hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -8       %11111000    %1111000h     %1110111h    %10111h00    %10111hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   -9       %11110111    %1110111h     %1110110h    %10110h00    %10110hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -10       %11110110    %1110110h     %1110101h    %10101h00    %10101hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -11       %11110101    %1110101h     %1110100h    %10100h00    %10100hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -12       %11110100    %1110100h     %1110011h    %10011h00    %10011hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -13       %11110011    %1110011h     %1110010h    %10010h00    %10010hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -14       %11110010    %1110010h     %1110001h    %10001h00    %10001hss</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  -15       %11110001    %1110001h     %1110000h    %10000h00    %10000hss</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">bit 7     = 0 for an envelope number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">bits 3-6  = envelope number - 1 (0-3), or volume in range (15 to 0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">bit 2     = h, the hold bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">bits 0-1  = ss, the sync bits (0-3)</span>
<span class="ACME-plain-syntax">    </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP12" class="function-link"><span class="ACME-function-syntax">addByteToBuffer</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">transfer byte to the sound buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP33" class="function-link"><span class="ACME-function-syntax">markAsUsedAndSendToBuffer</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (C set on exit, i.e. succesful</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">transfer) then branch (send to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">buffer)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishUpSound</span><button class="popup" onclick="togglePopup('usagePopup45')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup45">Usage of <span class="code-font"><span class="ACME-function-syntax">finishUpSound</span></span>:<br/><a href="S-s15.html#SP34">&#167;34</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e869</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} failed to add to buffer, so pull</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} the values off and fall through to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} exit via OSBYTE 117</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP32" class="paragraph-anchor"></a><b>&#167;32. OSBYTE 117 - Read VDU status. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte117EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup46')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup46">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte117EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e86c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">get VDU status byte in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP33" class="paragraph-anchor"></a><b>&#167;33. VDU 7 (.charBELL). </b></p>

<p class="center-p"><audio controls>
<source src="beep.mp3" type="audio/mpeg">
Your browser does not support the audio element.
</audio>
</p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Generates a short tone.</span>

<span class="ACME-plain-syntax"> By default this plays a Treble C as a square wave for 0.3 seconds on channel 3. The</span>
<span class="ACME-plain-syntax"> frequency is as close as the sound chip can get to Treble C. It produces a 523.013Hz tone</span>
<span class="ACME-plain-syntax"> compared to the theoretical ideal 523.251Hz, and so is very close to the ideal pitch.</span>

<span class="ACME-plain-syntax"> The 523.013Hz figure for the frequency achieved takes into account that the OS changes the</span>
<span class="ACME-plain-syntax"> pitch slightly depending on the channel number (see .</span><a href="S-s4.html#SP13" class="internal">soundPitchOffsetByChannelTable</a><span class="ACME-plain-syntax">). If</span>
<span class="ACME-plain-syntax"> it were played on channel 1 or 2, the frequency would not be as close to Treble C.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu7EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup47')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup47">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu7EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a><br/>Chapter 14: Star commands - <a href="S-s14.html#SP33">&#167;33</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e86f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">soundBELLChannel</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">get bell channel number in A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">clear all except bits 0-2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000100</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">set bit 2 (=channel number + 4)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A=channel number+4=buffer number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">soundBELLAmplitudeEnvelope</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">get bell amplitude/envelope number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP27" class="function-link"><span class="ACME-function-syntax">insJumper</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">store it in buffer X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">soundBELLDuration</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">get bell duration</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">soundBELLPitch</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get bell pitch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">markAsUsedAndSendToBuffer</span><button class="popup" onclick="togglePopup('usagePopup48')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup48">Usage of <span class="code-font"><span class="ACME-function-syntax">markAsUsedAndSendToBuffer</span></span>:<br/><a href="S-s15.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e887</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP19" class="function-link"><span class="ACME-function-syntax">channel0Occupancy</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP4" class="function-link"><span class="ACME-function-syntax">bufferNumberSound0</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">and pass into bit 7 to indicate that</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">channel is active</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP35" class="function-link"><span class="ACME-function-syntax">addPitchAndDurationToSoundBuffer</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP34" class="paragraph-anchor"></a><b>&#167;34. osword7Speech. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword7Speech</span><button class="popup" onclick="togglePopup('usagePopup49')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup49">Usage of <span class="code-font"><span class="ACME-function-syntax">osword7Speech</span></span>:<br/><a href="S-s15.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e88d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte at offset 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte at offset 3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store it</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The stack now holds the two bytes of the SOUND command that normally specify amplitude</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">These are the last two of three bytes we are going to add to the buffer. The first</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">byte is byte 0 from the</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP4" class="function-link"><span class="ACME-function-syntax">bufferNumberSpeech</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">X=8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP12" class="function-link"><span class="ACME-function-syntax">addByteToBuffer</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">select speech buffer and pass A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP31" class="function-link"><span class="ACME-function-syntax">finishUpSound</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">if (carry set, i.e. failed to add to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">buffer) then branch (restore stack</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">speechBufferEmptyFlag</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">clear bit 7 of buffer empty flag to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">show buffer is not empty</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP35" class="paragraph-anchor"></a><b>&#167;35. addPitchAndDurationToSoundBuffer. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">addPitchAndDurationToSoundBuffer</span><button class="popup" onclick="togglePopup('usagePopup50')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup50">Usage of <span class="code-font"><span class="ACME-function-syntax">addPitchAndDurationToSoundBuffer</span></span>:<br/><a href="S-s15.html#SP33">&#167;33</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8a4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull pitch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP27" class="function-link"><span class="ACME-function-syntax">insJumper</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">enter it in buffer X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull duration</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP27" class="function-link"><span class="ACME-function-syntax">insJumper</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">enter it in buffer X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP36" class="paragraph-anchor"></a><b>&#167;36. OSWORD 8 - Define an envelope. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = envelope number</span>
<span class="ACME-plain-syntax">       Y = 0</span>

<span class="ACME-plain-syntax">   .oswordX/Y is the address of 14 bytes of parameters:</span>
<span class="ACME-plain-syntax">       byte 0:   envelope number (also in A)</span>
<span class="ACME-plain-syntax">       byte 1:   bits 0-6 length of each step in centi-seconds</span>
<span class="ACME-plain-syntax">                 bit 7 clear means auto repeat</span>
<span class="ACME-plain-syntax">       byte 2:   change of Pitch per step in section 1 (-128 to +127)</span>
<span class="ACME-plain-syntax">       byte 3:   change of Pitch per step in section 2 (-128 to +127)</span>
<span class="ACME-plain-syntax">       byte 4:   change of Pitch per step in section 3 (-128 to +127)</span>
<span class="ACME-plain-syntax">       byte 5:   number of steps in section 1 (0 to 255)</span>
<span class="ACME-plain-syntax">       byte 6:   number of steps in section 2 (0 to 255)</span>
<span class="ACME-plain-syntax">       byte 7:   number of steps in section 3 (0 to 255)</span>
<span class="ACME-plain-syntax">       byte 8:   change of amplitude per step during attack  phase (-127 to +127)</span>
<span class="ACME-plain-syntax">       byte 9:   change of amplitude per step during decay   phase (-127 to +127)</span>
<span class="ACME-plain-syntax">       byte 10:  change of amplitude per step during sustain phase (-127 to +127)</span>
<span class="ACME-plain-syntax">       byte 11:  change of amplitude per step during release phase (-127 to +127)</span>
<span class="ACME-plain-syntax">       byte 12:  target level at end of attack phase (0 to 126)</span>
<span class="ACME-plain-syntax">       byte 13:  target level at end of decay  phase (0 to 126)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword8EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup51')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup51">Usage of <span class="code-font"><span class="ACME-function-syntax">osword8EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8ae</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} set up appropriate displacement to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} storage area</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} A=(A-1)*16 OR 15</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A (destination offset)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0 (value to write)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #16                                             </span><span class="ACME-comment-syntax">Y = loop counter</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyEnvelopeLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8bb</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #14                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y &gt;= 14) then branch (don't read</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">from block, just store zero in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">envelope buffer)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte from parameter block</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP20" class="function-link"><span class="ACME-function-syntax">envelopeBuffer</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">and store it in appropriate area</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP36" class="function-link"><span class="ACME-function-syntax">copyEnvelopeLoop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (not zero) then branch (loop back</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and do it again)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Note that envelope number is NOT transferred. The envelope number is not needed in</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">the buffer since the address in the buffer determines the envelope number.</span>

</pre>
<p class="commentary firstcommentary"><a id="SP37" class="paragraph-anchor"></a><b>&#167;37. getChannelNumberAndFlush. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   When Y = 0:</span>
<span class="ACME-plain-syntax">       A = channel number (0-3)</span>
<span class="ACME-plain-syntax">       C set if channel low byte &gt; 15, i.e. if flush is required</span>

<span class="ACME-plain-syntax">   When Y = 1:</span>
<span class="ACME-plain-syntax">       A = Sync number (0-3)</span>
<span class="ACME-plain-syntax">       C set if channel low byte &gt; 15, i.e. if hold is required</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">getChannelNumberAndFlush</span><button class="popup" onclick="togglePopup('usagePopup52')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup52">Usage of <span class="code-font"><span class="ACME-function-syntax">getChannelNumberAndFlush</span></span>:<br/><a href="S-s15.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8c9</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">getSyncNumberAndHold</span><button class="popup" onclick="togglePopup('usagePopup53')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup53">Usage of <span class="code-font"><span class="ACME-function-syntax">getSyncNumberAndHold</span></span>:<br/><a href="S-s15.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8c9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get byte (channel parameter low byte</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">or sync parameter low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$10</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">is it greater than 15, if so set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">get hardware channel number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to point to byte 1 of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP38" class="paragraph-anchor"></a><b>&#167;38. OSWORD 3 - Read interval timer. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> The interval timer is centi-seconds and 5 bytes long.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address for the five byte result</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword3EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup54')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup54">Usage of <span class="code-font"><span class="ACME-function-syntax">osword3EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8d1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">countdownIntervalTimer</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">)    </span><span class="ACME-comment-syntax">X is the offset from (clockA-5) to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">countdown timer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP39" class="function-link"><span class="ACME-function-syntax">readFiveBytesIntoBlock</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP39" class="paragraph-anchor"></a><b>&#167;39. OSWORD 1 - Read system clock. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> The system clock counts in centi-seconds since boot and is 5 bytes long.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address for the five byte result</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword1EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup55')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup55">Usage of <span class="code-font"><span class="ACME-function-syntax">osword1EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8d5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockSwitch</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">X=current system clock store pointer</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readFiveBytesIntoBlock</span><button class="popup" onclick="togglePopup('usagePopup56')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup56">Usage of <span class="code-font"><span class="ACME-function-syntax">readFiveBytesIntoBlock</span></span>:<br/><a href="S-s15.html#SP38">&#167;38</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8d8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y = loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">read byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store it in parameter block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = X + 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = Y - 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y &gt;= 0) then branch (loop back</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and do it again)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit22</span><button class="popup" onclick="togglePopup('usagePopup57')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup57">Usage of <span class="code-font"><span class="ACME-function-syntax">exit22</span></span>:<br/><a href="S-s15.html#SP42">&#167;42</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8e3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP40" class="paragraph-anchor"></a><b>&#167;40. OSWORD 4 - Write interval timer. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of the five byte value to set</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword4EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup58')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup58">Usage of <span class="code-font"><span class="ACME-function-syntax">osword4EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8e4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">countdownIntervalTimer</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">)    </span><span class="ACME-comment-syntax">A=15 is the offset from clockA to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">countdown timer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP42" class="function-link"><span class="ACME-function-syntax">writeFiveBytesFromBlock</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP41" class="paragraph-anchor"></a><b>&#167;41. OSWORD 2 - Write system clock. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of the five byte value to set</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword2EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup59')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup59">Usage of <span class="code-font"><span class="ACME-function-syntax">osword2EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8e8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockSwitch</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">get current clock store pointer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #15                                             </span><span class="ACME-comment-syntax">and invert to get inactive clock</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(toggle between 5 and 10)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry (indicates write system</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">clock)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP42" class="paragraph-anchor"></a><b>&#167;42. Write system clock or interval timer. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       carry clear indicates write system clock</span>
<span class="ACME-plain-syntax">       carry set indicates write interval timer</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writeFiveBytesFromBlock</span><button class="popup" onclick="togglePopup('usagePopup60')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup60">Usage of <span class="code-font"><span class="ACME-function-syntax">writeFiveBytesFromBlock</span></span>:<br/><a href="S-s15.html#SP40">&#167;40</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8ee</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y=loop counter</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writeClockLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e8f2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">transfer 5 bytes from out parameter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">block</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">to the clock or timer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP42" class="function-link"><span class="ACME-function-syntax">writeClockLoop</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (Y &gt;= 0) then branch (loop)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP39" class="function-link"><span class="ACME-function-syntax">exit22</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (carry set, i.e. write to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">interval timer requested) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">timeClockSwitch</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">write back current clock (5 or 10)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">into switch variable</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP43" class="paragraph-anchor"></a><b>&#167;43. OSWORD 0 - Read line from current input into memory. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/.oswordY - address of parameter block:</span>
<span class="ACME-plain-syntax">           byte 0: address of input buffer for result (low)</span>
<span class="ACME-plain-syntax">           byte 1: address of input buffer for result (high)</span>
<span class="ACME-plain-syntax">           byte 2: maximum line length</span>
<span class="ACME-plain-syntax">           byte 3: minimum acceptable ASCII code</span>
<span class="ACME-plain-syntax">           byte 4: maximum acceptable ASCII code</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword0EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup61')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup61">Usage of <span class="code-font"><span class="ACME-function-syntax">osword0EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e902</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y=4</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">copy bytes 2,3,4 to absolute</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">addresses .osword0MaxLineLength,+1,+2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">osword0MaxLineLength</span></a><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">2,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">until Y=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get address of input buffer (high</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osword0BufferAddressHigh</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">store it in temporary buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">Y=0 store in print line counter for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">paged mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get address of input buffer (low</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osword0BufferAddressLow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">and store in temporary buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">allow interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">readInputCharacter</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP44" class="paragraph-anchor"></a><b>&#167;44. readLineInputBufferFull. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readLineInputBufferFull</span><button class="popup" onclick="togglePopup('usagePopup62')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup62">Usage of <span class="code-font"><span class="ACME-function-syntax">readLineInputBufferFull</span></span>:<br/><a href="S-s15.html#SP45">&#167;45</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e91d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charBELL</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">A=7</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">retryReadWithoutIncrementingPosition</span><button class="popup" onclick="togglePopup('usagePopup63')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup63">Usage of <span class="code-font"><span class="ACME-function-syntax">retryReadWithoutIncrementingPosition</span></span>:<br/><a href="S-s15.html#SP45">&#167;45</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e91f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">retryReadIncrementingPosition</span><button class="popup" onclick="togglePopup('usagePopup64')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup64">Usage of <span class="code-font"><span class="ACME-function-syntax">retryReadIncrementingPosition</span></span>:<br/><a href="S-s15.html#SP45">&#167;45</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e920</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">outputCharacterAndReadAgain</span><button class="popup" onclick="togglePopup('usagePopup65')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup65">Usage of <span class="code-font"><span class="ACME-function-syntax">outputCharacterAndReadAgain</span></span>:<br/><a href="S-s15.html#SP45">&#167;45</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e921</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP6" class="function-link"><span class="ACME-function-syntax">OSWRCH</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">and call OSWRCH</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP45" class="paragraph-anchor"></a><b>&#167;45. readInputCharacter. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readInputCharacter</span><button class="popup" onclick="togglePopup('usagePopup66')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup66">Usage of <span class="code-font"><span class="ACME-function-syntax">readInputCharacter</span></span>:<br/><a href="S-s15.html#SP43">&#167;43</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e924</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP6" class="function-link"><span class="ACME-function-syntax">OSRDCH</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">read character from input stream</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">exitWithNegativeAndCarryFlagsSet</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (error occurred) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">characterDestinationsAvailableFlags</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">get character destination status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate the status twice to make</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">carry reflect the 'disable VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">driver' bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore character read</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (vdu disabled) then branch (skip</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">forward)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">twosComplimentOfNumberOfBytesInVDUQueue</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">get number of items in VDU queue</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">outputCharacterAndReadAgain</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (not zero) then branch (output</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character and read again)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (character is not DELETE) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">readInputCharacter</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (Y is zero, i.e. first character)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (read next character)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y (position in buffer</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">decrements)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">outputCharacterAndReadAgain</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">ALWAYS branch back to otput the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">DELETE and read again</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDisableVDUOrDeleteLine</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">is it delete line (CTRL-U)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not CTRL-U) then branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">readInputCharacter</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (we are still reading first</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character) then branch back the read</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP6" class="function-link"><span class="ACME-function-syntax">OSWRCH</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} output DELETE until Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">readInputCharacter</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">ALWAYS branch (read character again)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osword0BufferAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">store character in designated buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charRETURN</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP45" class="function-link"><span class="ACME-function-syntax">outputNewlineAndExit</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">if (carriage return entered) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">osword0MaxLineLength</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">check the line length</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">readLineInputBufferFull</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">if (buffer full) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to ring bell)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">osword0MinASCIICharacter</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">check minimum character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">retryReadWithoutIncrementingPosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">if (less than minimum character)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (read at existing</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">osword0MaxASCIICharacter</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">check maximum character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">retryReadIncrementingPosition</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (equal to maximum character) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">accept the character and move on</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">retryReadIncrementingPosition</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (less than maximum character)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then accept the character and move on</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP44" class="function-link"><span class="ACME-function-syntax">retryReadWithoutIncrementingPosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">ALWAYS branch (reject character and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">continue)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">outputNewlineAndExit</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e96c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s24.html#SP6" class="function-link"><span class="ACME-function-syntax">OSNEWL</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">output CR/LF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s14.html#SP34" class="function-link"><span class="ACME-function-syntax">netvJumper</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">call Econet vector</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exitWithNegativeAndCarryFlagsSet</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e972</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">escapeFlag</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">A=ESCAPE FLAG</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put bit 7 into carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP46" class="paragraph-anchor"></a><b>&#167;46. OSBYTE 5 - Select printer type. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X=0       ignore printer output</span>
<span class="ACME-plain-syntax">       X=1       parallel output</span>
<span class="ACME-plain-syntax">       X=2       RS-423 output (will act as sink if RS-423 is enabled using OSBYTE with A=3)</span>
<span class="ACME-plain-syntax">       X=3       user printer</span>
<span class="ACME-plain-syntax">       X=4       Econet printer</span>
<span class="ACME-plain-syntax">       X=5-255   user printer</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte5EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup67')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup67">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte5EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e976</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">allow interrupts briefly</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">escapeFlag</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">check if ESCAPE is pending</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP51" class="function-link"><span class="ACME-function-syntax">exit23</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (ESCAPE is pending) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">printerBufferEmptyFlag</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">check bit 7 for printer buffer empty</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP46" class="function-link"><span class="ACME-function-syntax">osbyte5EntryPoint</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (bit 7=0, not empty) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back and try again (wait until</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">buffer is empty)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP9" class="function-link"><span class="ACME-function-syntax">selectPrinterType</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">check for user defined routine</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">F1=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP47" class="paragraph-anchor"></a><b>&#167;47. OSBYTE 1 - Read/Write user flag; OSBYTE 6 - Set printer ignore character. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       OSBYTE 1:</span>
<span class="ACME-plain-syntax">           To read the user flag:  Y=$00</span>
<span class="ACME-plain-syntax">           To write the user flag: X=value to write, Y=$FF</span>
<span class="ACME-plain-syntax">       OSBYTE 6:</span>
<span class="ACME-plain-syntax">           X = value to write</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       X contains the previous value</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte1EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup68')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup68">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte1EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e988</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte6EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup69')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup69">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte6EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e988</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$0280</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">mosVariablesMinus166</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">A set to read/write locations:</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point, A depends on the entry point. A is set up to affect a particular</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">system variable:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Entry via OSBYTE 1: $0281 (user flag)                - .mosVariablesMinus166</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Entry via OSBYTE 5: $0285 (printer destination)      - .mosVariablesMinus166</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Entry via OSBYTE 6: $0286 (printer ignore character) - .mosVariablesMinus166</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP50" class="function-link"><span class="ACME-function-syntax">readWriteSystemVariable</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP48" class="paragraph-anchor"></a><b>&#167;48. OSBYTE 12 - Set keyboard autorepeat rate. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte12EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup70')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup70">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte12EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e98c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP49" class="function-link"><span class="ACME-function-syntax">osbyte11EntryPoint</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (.osbyteX != 0; i.e. not</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">resetting to defaults) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #50                                             </span><span class="ACME-comment-syntax">reset default delay and rate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">keyboardAutoRepeatDelay</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">set keyboard autorepeat delay</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">set X=8 for default autorepeat rate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP49" class="paragraph-anchor"></a><b>&#167;49. OSBYTE 11 - Set keyboard autorepeat delay. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte11EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup71')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup71">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte11EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a>, <a href="S-s15.html#SP48">&#167;48</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e995</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$CF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=A+208 (carry set)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">So...</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=219 if entered from OSBYTE 11</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=220 if entered from OSBYTE 12</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP50" class="paragraph-anchor"></a><b>&#167;50. OSBYTE 3 - Select output stream; OSBYTE 4 - Enable/disable cursor editing. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte3EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup72')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup72">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte3EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e997</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte4EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup73')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup73">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte4EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e997</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$E9</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A = A + 233</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">So...</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=236 if entered from OSBYTE 3</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=237 if entered from OSBYTE 4</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=196 if entered from OSBYTE 11</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=197 if entered from OSBYTE 12</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readWriteSystemVariable</span><button class="popup" onclick="togglePopup('usagePopup74')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup74">Usage of <span class="code-font"><span class="ACME-function-syntax">readWriteSystemVariable</span></span>:<br/><a href="S-s15.html#SP47">&#167;47</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e99a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">store X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP51" class="paragraph-anchor"></a><b>&#167;51. OSBYTE 166 to 255 - read/write system variable. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Set newValue = (oldValue AND .osbyteY) EOR .osbyteX</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = offset from .mosVariablesMinus166 of variable to read/write</span>
<span class="ACME-plain-syntax">       .osbyteX = X parameter from entry to OSBYTE</span>
<span class="ACME-plain-syntax">       .osbyteY = Y parameter from entry to OSBYTE</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       X = oldValue</span>
<span class="ACME-plain-syntax">       Y = value of next system variable</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte166to255EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup75')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup75">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte166to255EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e99c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">mosVariablesMinus166</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">read current value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">preserve this in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteY</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">osbyteX</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">} new value = (old value AND Y) EOR X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">mosVariablesMinus166</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">mosVariablesMinus166</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get value of next byte into A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit23</span><button class="popup" onclick="togglePopup('usagePopup76')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup76">Usage of <span class="code-font"><span class="ACME-function-syntax">exit23</span></span>:<br/><a href="S-s15.html#SP46">&#167;46</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9ac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP52" class="paragraph-anchor"></a><b>&#167;52. Table of buffer types and serial baud rates. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This table has dual use. It is used to set the serial baud rate (using bits 0-5), and</span>
<span class="ACME-plain-syntax"> also to identify a buffer as being a sound buffer (bit 7):</span>

<span class="ACME-plain-syntax">   - bit 7 is set if buffer X is a sound buffer</span>
<span class="ACME-plain-syntax">   - bit 6 is not used (always set)</span>
<span class="ACME-plain-syntax">   - bits 3,4,5 indicate the serial receive baud rate</span>
<span class="ACME-plain-syntax">   - bits 0,1,2 indicate the serial transmit baud rate</span>

<span class="ACME-plain-syntax">       111 =    75 baud</span>
<span class="ACME-plain-syntax">       011 =   150 baud</span>
<span class="ACME-plain-syntax">       101 =   300 baud</span>
<span class="ACME-plain-syntax">       001 =  1200 baud</span>
<span class="ACME-plain-syntax">       110 =  2400 baud</span>
<span class="ACME-plain-syntax">       010 =  4800 baud</span>
<span class="ACME-plain-syntax">       100 =  9600 baud</span>
<span class="ACME-plain-syntax">       000 = 19200 baud</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">bufferTypeAndSerialBaudRatesTable</span><button class="popup" onclick="togglePopup('usagePopup77')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup77">Usage of <span class="code-font"><span class="ACME-function-syntax">bufferTypeAndSerialBaudRatesTable</span></span>:<br/><a href="S-s15.html#SP9">&#167;9</a><br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9ad</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%01100100</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">Keyboard           9600 baud</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(default)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%01111111</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">RS-423 Input         75 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%01011011</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">RS-423 output       150 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%01101101</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">serial printer      300 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%11001001</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">sound0             1200 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%11110110</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">sound1             2400 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%11010010</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">sound2             4800 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%11100100</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">sound3             9600 baud</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%01000000</span><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">speech            19200 baud</span>
</pre>
<p class="commentary firstcommentary"><a id="SP53" class="paragraph-anchor"></a><b>&#167;53. OSBYTE 19 - Wait for vertical sync. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte19EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup78')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup78">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte19EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9b6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">verticalSyncCounter</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">Read vertical sync counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">allow interrupts briefly</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">verticalSyncCounter</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">has the vertical sync counter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">changed yet?</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (the values are the same) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP54" class="paragraph-anchor"></a><b>&#167;54. OSBYTE 160 - Read VDU Variable. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte160EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup79')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup79">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte160EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9c0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get VDU variable (often the high</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">get VDU variable (often the low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP55" class="paragraph-anchor"></a><b>&#167;55. OSBYTE 18 - Reset soft keys. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte18EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup80')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup80">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte18EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a><br/>Chapter 10: Resets - <a href="S-s10.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9c8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$10</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">set consistency flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">softKeyConsistencyFlag</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X=0</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP22" class="function-link"><span class="ACME-function-syntax">softKeyPage</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">and wipe clean</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">soft key buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">until X=0 again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">softKeyConsistencyFlag</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">zero consistency flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP56" class="paragraph-anchor"></a><b>&#167;56. OSBYTE 118 - Set keyboard LEDs based on keyboard status. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       carry is set if CTRL pressed</span>
<span class="ACME-plain-syntax">       N is set if SHIFT is pressed</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte118EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup81')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup81">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte118EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP69">&#167;69</a><br/>Chapter 10: Resets - <a href="S-s10.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9d9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remember flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$40</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">switch on CAPS and SHIFT LOCK lights</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP57" class="function-link"><span class="ACME-function-syntax">turnOnKeyboardLightsAndTestEscape</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">via subroutine</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP56" class="function-link"><span class="ACME-function-syntax">popRollAndExit</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (negative, i.e. ESCAPE condition</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">exists) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear V and C</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLV</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">calling main keyboard routine to</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s17.html#SP20" class="function-link"><span class="ACME-function-syntax">keyJumper</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">switch on lights as required</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">popRollAndExit</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9e7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">and rotate carry into bit 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP57" class="paragraph-anchor"></a><b>&#167;57. turnOnKeyboardLightsAndTestEscape. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">turnOnKeyboardLightsAndTestEscape</span><button class="popup" onclick="togglePopup('usagePopup82')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup82">Usage of <span class="code-font"><span class="ACME-function-syntax">turnOnKeyboardLightsAndTestEscape</span></span>:<br/><a href="S-s15.html#SP56">&#167;56</a><br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP12">&#167;12</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9ea</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP57" class="function-link"><span class="ACME-function-syntax">skipKeyboardLights</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (carry clear) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">switch on SHIFT LOCK light</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP10" class="function-link"><span class="ACME-function-syntax">systemVIARegisterB</span></a><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP10" class="function-link"><span class="ACME-function-syntax">systemVIARegisterB</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">switch on CAPS LOCK light</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipKeyboardLights</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9f5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">escapeFlag</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">check bit 7 of escape flag indicating</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">that ESCAPE condition exists</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP58" class="paragraph-anchor"></a><b>&#167;58. writeAToSystemVIARegisterB. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writeAToSystemVIARegisterB</span><button class="popup" onclick="togglePopup('usagePopup83')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup83">Usage of <span class="code-font"><span class="ACME-function-syntax">writeAToSystemVIARegisterB</span></span>:<br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9f8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP10" class="function-link"><span class="ACME-function-syntax">systemVIARegisterB</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">write register B from Accumulator</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP59" class="paragraph-anchor"></a><b>&#167;59. OSBYTE 154 - Write to Video ULA's Video Control Register. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> bit</span>
<span class="ACME-plain-syntax">   0 - Flash colour select (which of the flashing colours is displayed)</span>
<span class="ACME-plain-syntax">   1 - Teletext select</span>
<span class="ACME-plain-syntax">   2 - } These two bits determine the number of characters per row</span>
<span class="ACME-plain-syntax">   3 - } from this table:</span>
<span class="ACME-plain-syntax">        00 = 10 characters per row</span>
<span class="ACME-plain-syntax">        01 = 20 characters per row</span>
<span class="ACME-plain-syntax">        10 = 40 characters per row</span>
<span class="ACME-plain-syntax">        11 = 80 characters per row</span>
<span class="ACME-plain-syntax">   4 - CRTC clock rate select:</span>
<span class="ACME-plain-syntax">         0 = low frequency clock for MODEs 4-7</span>
<span class="ACME-plain-syntax">         1 = high frequency clock for MODEs 0-3</span>
<span class="ACME-plain-syntax">   5 - } These two bits determine the width of cursor in bytes</span>
<span class="ACME-plain-syntax">   6 - } from this table:</span>
<span class="ACME-plain-syntax">        00 = 1 (MODEs 0,3,4,6)</span>
<span class="ACME-plain-syntax">        01 = - undefined</span>
<span class="ACME-plain-syntax">        10 = 2 (MODEs 1,5,7)</span>
<span class="ACME-plain-syntax">        11 = 4 (MODE 2)</span>
<span class="ACME-plain-syntax">   7 - Master cursor width. If set, causes a larger cursor to be displayed</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte154EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup84')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup84">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte154EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $e9ff</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setVideoULA</span><button class="popup" onclick="togglePopup('usagePopup85')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup85">Usage of <span class="code-font"><span class="ACME-function-syntax">setVideoULA</span></span>:<br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a><br/>Chapter 11: Interrupt processing - <a href="S-s11.html#SP13">&#167;13</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea00</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAVideoControlRegisterCopy</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">save RAM copy of new parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP8" class="function-link"><span class="ACME-function-syntax">videoULAControlRegister</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">write to control register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULASecondFlashingColourInterval</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">get second flashing colour interval</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAFlashingColourIntervalCount</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">set flash counter to this value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back status</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP60" class="paragraph-anchor"></a><b>&#167;60. OSBYTE 155 - Set palette value. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X contains value to write</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte155EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup86')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup86">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte155EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea10</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = X</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte155Internal</span><button class="popup" onclick="togglePopup('usagePopup87')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup87">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte155Internal</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP47">&#167;47</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea11</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">convert to palette format required</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">for video ULA register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remember flags (including interrupt</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">disable flag)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">prevent interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">videoULAPaletteValue</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">store as current palette setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP9" class="function-link"><span class="ACME-function-syntax">videoULAPaletteRegister</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">store actual colour in register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore flags (including interrupt</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">disable flag)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP61" class="paragraph-anchor"></a><b>&#167;61. gsinitForFilenameParsing. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">gsinitForFilenameParsing</span><button class="popup" onclick="togglePopup('usagePopup88')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup88">Usage of <span class="code-font"><span class="ACME-function-syntax">gsinitForFilenameParsing</span></span>:<br/>Chapter 14: Star commands - <a href="S-s14.html#SP4">&#167;4</a><br/>Chapter 18: Tape and ROM Filing systems - <a href="S-s18.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea1d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP62" class="paragraph-anchor"></a><b>&#167;62. GSINIT - Initialise parsing of a string. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Initialises the parsing of a given string (the 'input' string). Usually the string is part</span>
<span class="ACME-plain-syntax"> of an OSCLI command line where a string is expected (e.g. the filename in a *LOAD or the</span>
<span class="ACME-plain-syntax"> definition of a function key in *KEY).</span>

<span class="ACME-plain-syntax"> Leading spaces are ignored. The input string can be surrounded by double quotation marks.</span>
<span class="ACME-plain-syntax"> The string is terminated by a carriage return, or the second double quotation mark, or</span>
<span class="ACME-plain-syntax"> (optionally) a space character (useful for filename parsing).</span>

<span class="ACME-plain-syntax"> Once initialised, the parsing occurs using multiple calls to GSREAD. Each call produces one</span>
<span class="ACME-plain-syntax"> character result based on the input string.</span>

<span class="ACME-plain-syntax"> Control codes are disallowed in the input string. However the bar character '|' can be</span>
<span class="ACME-plain-syntax"> used to introduce control codes into the parsed output of GSREAD, and the '|!' combination</span>
<span class="ACME-plain-syntax"> is used to introduce top bit set characters.</span>

<span class="ACME-plain-syntax"> '|' followed by a character (see exceptions below) gives the ASCII value minus 64.</span>
<span class="ACME-plain-syntax">       e.g. |G = control code 7  (bell)</span>
<span class="ACME-plain-syntax">            |M = control code 13 (carriage return)</span>
<span class="ACME-plain-syntax"> '|!' adds 128 to the following character.</span>
<span class="ACME-plain-syntax"> '||' is parsed as a single bar character.</span>
<span class="ACME-plain-syntax"> '|"' is parsed as double quotes.</span>
<span class="ACME-plain-syntax"> '|?' is parsed as the DELETE character (character 127).</span>

<span class="ACME-plain-syntax"> These can be combined, e.g. '|!|A' results in character 129 being parsed.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Address for string stored at .stringInputBufferAddressLow/High</span>
<span class="ACME-plain-syntax">       Y = offset into string</span>
<span class="ACME-plain-syntax">       C = 0: string is terminated by a space (used for filename parsing)</span>
<span class="ACME-plain-syntax">       C = 1: otherwise (used e.g. for defining a soft key with *KEY)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .stringInputOptions bit 7 = double-quote character found at start</span>
<span class="ACME-plain-syntax">                           bit 6 = don't stop on space character</span>
<span class="ACME-plain-syntax">       Y = offset of the first non-blank character</span>
<span class="ACME-plain-syntax">       A = first non-blank character</span>
<span class="ACME-plain-syntax">       Z is set if string is empty</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">gsinitEntryPoint</span><button class="popup" onclick="togglePopup('usagePopup89')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup89">Usage of <span class="code-font"><span class="ACME-function-syntax">gsinitEntryPoint</span></span>:<br/>Chapter 2: Memory Layout and Constants - <a href="S-s2.html#SP11">&#167;11</a><br/>Chapter 14: Star commands - <a href="S-s14.html#SP15">&#167;15</a><br/>Chapter 24: OS entry points; Tube; FRED; JIM; SHEILA - <a href="S-s24.html#SP6">&#167;6</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea1e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputOptions</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">Move carry into top bit of options</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP16" class="function-link"><span class="ACME-function-syntax">skipSpacesAndCheckForCRInStringInput</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">get character from text</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to point at next</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDOUBLEQUOTE</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">check for double quotes (") character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (double quotes) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputOptions</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">bit 7 = double quote character found</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 6 = space is not a terminator</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #13                                             </span><span class="ACME-comment-syntax">set Z flag if CR found</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP63" class="paragraph-anchor"></a><b>&#167;63. GSREAD - Read one character by parsing the input string. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Parses a character from the input string previously set up by GSINIT.</span>
<span class="ACME-plain-syntax"> See .</span><a href="S-s15.html#SP62" class="internal">gsinitEntryPoint</a>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Address for string stored at .stringInputBufferAddressLow/High</span>
<span class="ACME-plain-syntax">       Y = offset into string</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       A = character read</span>
<span class="ACME-plain-syntax">       X is preserved</span>
<span class="ACME-plain-syntax">       Y = index of next character to be read</span>
<span class="ACME-plain-syntax">       Carry is set if end of string reached</span>
<span class="ACME-plain-syntax">       Overflow (V flag) is set if the character read was interpreted as a control code</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">gsreadEntryPoint</span><button class="popup" onclick="togglePopup('usagePopup90')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup90">Usage of <span class="code-font"><span class="ACME-function-syntax">gsreadEntryPoint</span></span>:<br/>Chapter 14: Star commands - <a href="S-s14.html#SP4">&#167;4</a>, <a href="S-s14.html#SP15">&#167;15</a><br/>Chapter 18: Tape and ROM Filing systems - <a href="S-s18.html#SP15">&#167;15</a><br/>Chapter 24: OS entry points; Tube; FRED; JIM; SHEILA - <a href="S-s24.html#SP6">&#167;6</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea2f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">gsreadInternal</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea31</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputPlingFlag</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">store A ($80 if previous character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is '!', zero otherwise)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputBufferAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">read first character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charRETURN</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">check for CR</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">notRETURN</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (not CR) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with RETURN character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputOptions</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">check options</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP64" class="function-link"><span class="ACME-function-syntax">brkBadString</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (second quotation mark needed)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch ('Bad string' message)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishedString</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">ALWAYS branch (string ok, finished)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">notRETURN</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea3f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">check for SPACE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP64" class="function-link"><span class="ACME-function-syntax">brkBadString</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (less then space, i.e. a control</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character) then branch ('Bad string'</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">message)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">notSPACE</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (it's not a space) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Deal with ' ' SPACE character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputOptions</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">check bit 6 and 7 of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.stringInputOptions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (double-quote character found)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishedString</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (space character is a terminator)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (finished string)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">notSPACE</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea4b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDOUBLEQUOTE</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">check for DOUBLE QUOTE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">notDOUBLEQUOTE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (not double quote) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Deal with '"' DOUBLE QUOTE character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputOptions</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">check options</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (string didn't start with a</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">double quote) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">We have found a string surrounded by double quotes.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Check the next character isn't also a double quote, as that's an error.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">point at next character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputBufferAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDOUBLEQUOTE</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">check for double quotes (") character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (third double quote character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">found) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishedString</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea5a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s12.html#SP16" class="function-link"><span class="ACME-function-syntax">skipSpacesAndCheckForCRInStringInput</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">skip past any final SPACEs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">carry set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">notDOUBLEQUOTE</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea5f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charBAR</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">check for bar '|' character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (not bar) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with '|' vertical BAR character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increase Y to point to next character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputBufferAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get next character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charBAR</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">check for '|' again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (bar found) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDOUBLEQUOTE</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">check for double quotes (") character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadClearV</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (double quotes) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charEXCLAMATIONMARK</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">check for '!' character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not '!') then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with '|!' characters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to next character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$80</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">set bit 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">gsreadInternal</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">loop back (sets bit 7 in next</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with remaining possible characters after the '|' BAR character</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">check for ' '</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP64" class="function-link"><span class="ACME-function-syntax">brkBadString</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (less than space, i.e. a control</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">code) then branch ('Bad string'</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">message)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charQUESTIONMARK</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">check for '|?'</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if ('|?') then branch (set delete</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Remaining '|' followed by a character is treated as a control code</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP66" class="function-link"><span class="ACME-function-syntax">implementCTRLCodes</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">modify code as if CTRL pressed</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s10.html#SP2" class="function-link"><span class="ACME-function-syntax">allBitsSet</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">Set V flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP63" class="function-link"><span class="ACME-function-syntax">finishUpReadX</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">ALWAYS branch (finish up with V set)</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">delete character</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishUpReadClearV</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea89</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLV</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear V</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishUpReadX</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea8a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">stringInputPlingFlag</span></a><span class="ACME-plain-syntax">                           </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP64" class="paragraph-anchor"></a><b>&#167;64. brkBadString. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">brkBadString</span><button class="popup" onclick="togglePopup('usagePopup91')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup91">Usage of <span class="code-font"><span class="ACME-function-syntax">brkBadString</span></span>:<br/><a href="S-s15.html#SP63">&#167;63</a><br/>Chapter 18: Tape and ROM Filing systems - <a href="S-s18.html#SP15">&#167;15</a>, <a href="S-s18.html#SP30">&#167;30</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea8f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BRK</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!byte</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">$FD</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">error number</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"Bad string"</span><span class="ACME-plain-syntax">,0                                </span><span class="ACME-comment-syntax">message (with zero terminator)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP65" class="paragraph-anchor"></a><b>&#167;65. Apply SHIFT to character in A. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Modify character in A as if the SHIFT key is being pressed</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">implementSHIFT</span><button class="popup" onclick="togglePopup('usagePopup92')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup92">Usage of <span class="code-font"><span class="ACME-function-syntax">implementSHIFT</span></span>:<br/>Chapter 17: Keyboard processing - <a href="S-s17.html#SP9">&#167;9</a>, <a href="S-s17.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ea9c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charZERO</span></a><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">exit24</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if ('0' character found) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return) (SHIFT '0' = '0')</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charAT</span></a><span class="ACME-plain-syntax">                                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">exit24</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if ('@' character found) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return) (SHIFT '@' = '@')</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">flipBitFourIfNotCtrlCharacter</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (A &lt; '@') then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the branch converts characters</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">      !"#$%&amp;`()*+,-./ 123456789:;&lt;=&gt;?</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">into  123456789:;&lt;=&gt;? !"#$%&amp;`()*+,-./</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">exit24</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (DELETE character found) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return) (SHIFT DELETE =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">DELETE)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">flipBitFourOnly</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">if (greater than $7F) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(toggle bit 4 and exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point A&gt;64 and A&lt;127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The following code converts the following characters:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">       ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_£ abcdefghijklmnopqrstuvwxyz{|}~</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">into   abcdefghijklmnopqrstuvwxyz{|}~£_ ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">flipBitsForShift</span><button class="popup" onclick="togglePopup('usagePopup93')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup93">Usage of <span class="code-font"><span class="ACME-function-syntax">flipBitsForShift</span></span>:<br/><a href="S-s15.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eaac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00110000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">flip bits 4 and 5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #(.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charUNDERSCORE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-reserved-syntax">XOR</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%00110000</span><span class="ACME-plain-syntax">)                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} if (it was originally underscore</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} '_') then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #(.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charPOUND</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-reserved-syntax">XOR</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">%00110000</span><span class="ACME-plain-syntax">)                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">flipBitFourIfNotCtrlCharacter</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">} if (it was NOT originally pound</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} '£') then branch</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$1F</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">EOR for converting pound symbol</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(which will become</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">underscore when the EOR at</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.flipBitFourOnly is done)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">flipBitFourIfNotCtrlCharacter</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eab8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">exit24</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">} if (control code) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} (return)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">flipBitFourOnly</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eabc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00010000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">flip bit 4</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit24</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eabe</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP66" class="paragraph-anchor"></a><b>&#167;66. Modify character in A as if the CTRL key is being pressed. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is used both when the CTRL key is being pressed, and for parsing strings using</span>
<span class="ACME-plain-syntax"> GSINIT / GSREAD. See .</span><a href="S-s15.html#SP62" class="internal">gsinitEntryPoint</a><span class="ACME-plain-syntax">.</span>

<span class="ACME-plain-syntax">     Input     Output      Notes</span>
<span class="ACME-plain-syntax">     ASCII      CTRL</span>
<span class="ACME-plain-syntax">     Code       Code</span>
<span class="ACME-plain-syntax">     ----------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">     32-63     32-63       VDU 32-63 (unchanged)</span>
<span class="ACME-plain-syntax">     '@'         0         VDU 0</span>
<span class="ACME-plain-syntax">     'A'         1         VDU 1</span>
<span class="ACME-plain-syntax">           ...</span>
<span class="ACME-plain-syntax">     'Z'        26         VDU 26</span>
<span class="ACME-plain-syntax">     '['        27         VDU 27</span>
<span class="ACME-plain-syntax">     '\'        28         VDU 28</span>
<span class="ACME-plain-syntax">     ']'        29         VDU 29</span>
<span class="ACME-plain-syntax">     '^'        30         VDU 30</span>
<span class="ACME-plain-syntax">     '_'        31         VDU 31</span>
<span class="ACME-plain-syntax">     '£'        31         VDU 31 this is treated as a special case.</span>
<span class="ACME-plain-syntax">                                  it would otherwise result in VDU 0 [why the special case?]</span>
<span class="ACME-plain-syntax">     'a'         1         VDU 1</span>
<span class="ACME-plain-syntax">           ...</span>
<span class="ACME-plain-syntax">     'z'        26         VDU 26</span>
<span class="ACME-plain-syntax">     '{'        27         VDU 27</span>
<span class="ACME-plain-syntax">     '|'        28         VDU 28</span>
<span class="ACME-plain-syntax">     '}'        29         VDU 29</span>
<span class="ACME-plain-syntax">     '~'        30         VDU 30</span>
<span class="ACME-plain-syntax">     127       127         DELETE</span>
<span class="ACME-plain-syntax">     128-255   flip bit 5  flip bit 5 [it's not clear why this is useful?]</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">implementCTRLCodes</span><button class="popup" onclick="togglePopup('usagePopup94')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup94">Usage of <span class="code-font"><span class="ACME-function-syntax">implementCTRLCodes</span></span>:<br/><a href="S-s15.html#SP63">&#167;63</a><br/>Chapter 17: Keyboard processing - <a href="S-s17.html#SP9">&#167;9</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eabf</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">check for DELETE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">++</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">if (DELETE found) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP65" class="function-link"><span class="ACME-function-syntax">flipBitsForShift</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (greater than $7F) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(process top bit characters)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charPOUND</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} if (A is not '£') then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charUNDERSCORE</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">A='_'</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charAT</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">++</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">} if (A &lt; '@') then branch (return</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} unchanged)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00011111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">at this point     A is between 64 to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">126 inclusive</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">zero bits 5 to 7  A is between  0 to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> 31 inclusive</span>
<span class="ACME-identifier-syntax">++</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP67" class="paragraph-anchor"></a><b>&#167;67. runBootString. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">runBootString</span><button class="popup" onclick="togglePopup('usagePopup95')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup95">Usage of <span class="code-font"><span class="ACME-function-syntax">runBootString</span></span>:<br/>Chapter 10: Resets - <a href="S-s10.html#SP24">&#167;24</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ead2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-element-syntax">!text</span><span class="ACME-plain-syntax"> </span><span class="ACME-string-syntax">"/!BOOT"</span><span class="ACME-plain-syntax">,13</span>
</pre>
<p class="commentary firstcommentary"><a id="SP68" class="paragraph-anchor"></a><b>&#167;68. OSBYTE 247 - Intercept BREAK. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">           Z clear if no user BREAK intercept code</span>
<span class="ACME-plain-syntax"> otherwise Z is set or cleared by user BREAK code</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte247EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup96')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup96">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte247EntryPoint</span></span>:<br/>Chapter 10: Resets - <a href="S-s10.html#SP17">&#167;17</a>, <a href="S-s10.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ead9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">breakInterceptJMPInstruction</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get first byte of user BREAK code</span>
<span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">(looking for 'JMP address')</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$4C</span><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">produces 0 if JMP absolute</span>
<span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">instruction is present</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">if (not zero) then branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">breakInterceptJMPInstruction</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">jump to user BREAK code</span>
</pre>
<p class="commentary firstcommentary"><a id="SP69" class="paragraph-anchor"></a><b>&#167;69. OSBYTE 144 - *TV. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X=vertical shift of display</span>
<span class="ACME-plain-syntax">       Y=interlace disable flag</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       X=old vertical shift of display</span>
<span class="ACME-plain-syntax">       Y=old interlace disable flag</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte144EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup97')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup97">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte144EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eae3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduVerticalAdjust</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">VDU vertical adjustment</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduVerticalAdjust</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">store new value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put old value in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put interlace flag in A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">maximum value =1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduInterlaceValue</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">get old value into Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduInterlaceValue</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">put new value into A</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP70" class="paragraph-anchor"></a><b>&#167;70. OSBYTE 147 - Write a byte to FRED. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> X is offset within page</span>
<span class="ACME-plain-syntax"> Y is byte to write;</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte147EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup98')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup98">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte147EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eaf4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP2" class="function-link"><span class="ACME-function-syntax">fredPage</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP71" class="paragraph-anchor"></a><b>&#167;71. OSBYTE 149 - Write a byte to JIM. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> X is offset within page</span>
<span class="ACME-plain-syntax"> Y is byte to write</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte149EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup99')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup99">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte149EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eaf9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP3" class="function-link"><span class="ACME-function-syntax">jimPage</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP72" class="paragraph-anchor"></a><b>&#167;72. OSBYTE 151 - Write a byte to SHEILA. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> X is offset within page</span>
<span class="ACME-plain-syntax"> Y is byte to write</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte151EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup100')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup100">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte151EntryPoint</span></span>:<br/><a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $eafe</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">sheilaPage</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s14.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresssection"><a href="S-s5.html">5</a></li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresssection"><a href="S-s7.html">7</a></li><li class="progresssection"><a href="S-s8.html">8</a></li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresscurrent">15</li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresssection"><a href="S-s21.html">21</a></li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progresssection"><a href="S-s26.html">26</a></li><li class="progressnext"><a href="S-s16.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

