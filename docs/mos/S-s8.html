<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 8: PLOT</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Downloads.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*CAT</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory-mapped i/o</a></li>
<li><a href="S-s4.html"><b>$C000</b>: chapter 4</a></li>
<li><a href="S-s5.html"><b>$C4C0</b>: chapter 5</a></li>
<li><a href="S-s6.html"><b>$CB1D</b>: chapter 6</a></li>
<li><a href="S-s7.html"><b>$CCF8</b>: chapter 7</a></li>
<li><span class="unlink"><b>$D060</b>: chapter 8</span></li>
<li><a href="S-s9.html"><b>$D7C2</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$D940</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$DC1C</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$DEC5</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$E0A4</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$E20E</b>: chapter 14</a></li>
<li><a href="S-s15.html"><b>$E5B3</b>: chapter 15</a></li>
<li><a href="S-s16.html"><b>$EB03</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$EEDA</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$F135</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$F588</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$F8A9</b>: chapter 20</a></li>
<li><a href="S-s21.html"><b>$FAE8</b>: chapter 21</a></li>
<li><a href="S-s22.html"><b>$FC00</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$FF00</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$FFA7</b>: chapter 24</a></li>
<li><a href="S-s25.html">appendix</a></li>
<li><a href="S-s26.html">index</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 8: PLOT' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">MOS 1.20</a></li><li><b>Chapter 8: PLOT</b></li></ul></div>
<p class="purpose">OSBYTE 134; OSWORD 13; PLOT routine; Checking graphics cursor bounds; Coordinate conversion; PLOT line; Move graphics cursor; Copy VDU variables; PLOT lateral fill; PLOT fill triangle - 1890 bytes (11.5%)</p>

<ul class="toc"><li><a href="S-s8.html#SP1">&#167;1. Plot routine</a></li><li><a href="S-s8.html#SP2">&#167;2. Plot with graphics character</a></li><li><a href="S-s8.html#SP3">&#167;3. plotFillTriangleLocal</a></li><li><a href="S-s8.html#SP4">&#167;4. plotExtensionLocal</a></li><li><a href="S-s8.html#SP5">&#167;5. storeAndLateralFillLeftRight</a></li><li><a href="S-s8.html#SP6">&#167;6. Set graphics colour and GCOL mode bytes</a></li><li><a href="S-s8.html#SP7">&#167;7. plotType0to63</a></li><li><a href="S-s8.html#SP8">&#167;8. plotPointAndMove</a></li><li><a href="S-s8.html#SP9">&#167;9. plotMoveGraphicsCursorInAbsolutePixels</a></li><li><a href="S-s8.html#SP10">&#167;10. copyPlotParametersToGraphicsCursorPixelPosition</a></li><li><a href="S-s8.html#SP11">&#167;11. copyParameterPointToDestinationY</a></li><li><a href="S-s8.html#SP12">&#167;12. Plot one pixel of a character</a></li><li><a href="S-s8.html#SP13">&#167;13. Plots a single point</a></li><li><a href="S-s8.html#SP14">&#167;14. Plots a filled whole byte (as part of a lateral fill)</a></li><li><a href="S-s8.html#SP15">&#167;15. Check that the graphics cursor is within the graphics window</a></li><li><a href="S-s8.html#SP16">&#167;16. Check coordinate of a point is in the window bounds (horizontal or vertical)</a></li><li><a href="S-s8.html#SP17">&#167;17. Convert external absolute coordinates to pixels</a></li><li><a href="S-s8.html#SP18">&#167;18. Convert external relative coordinates to pixels</a></li><li><a href="S-s8.html#SP19">&#167;19. Converts the vdu queue parameter to absolute coordinates and divides by two</a></li><li><a href="S-s8.html#SP20">&#167;20. Divides the signed 16 bit coordinate value by two</a></li><li><a href="S-s8.html#SP21">&#167;21. Convert pixel coordinates to external absolute coordinates</a></li><li><a href="S-s8.html#SP22">&#167;22. Plot a line or a dotted line</a></li><li><a href="S-s8.html#SP23">&#167;23. Move up one pixel (in the non-dominant axis)</a></li><li><a href="S-s8.html#SP24">&#167;24. Move down one pixel (in the non-dominant axis)</a></li><li><a href="S-s8.html#SP25">&#167;25. Move right one pixel (in the non-dominant axis)</a></li><li><a href="S-s8.html#SP26">&#167;26. Move left one pixel (in the non-dominant axis)</a></li><li><a href="S-s8.html#SP27">&#167;27. Move up one pixel (in the dominant axis)</a></li><li><a href="S-s8.html#SP28">&#167;28. Move right one pixel (in the dominant axis)</a></li><li><a href="S-s8.html#SP29">&#167;29. plotLineCheckForTermination</a></li><li><a href="S-s8.html#SP30">&#167;30. moveGraphicsCursorAddressUpOneCharacterCell</a></li><li><a href="S-s8.html#SP31">&#167;31. Update the mask value, and move graphics cursor address on to next cell to the right</a></li><li><a href="S-s8.html#SP32">&#167;32. Update the mask value, and move graphics cursor address on to previous cell to the left</a></li><li><a href="S-s8.html#SP33">&#167;33. Initialise delta values to (current cursor - params position)</a></li><li><a href="S-s8.html#SP34">&#167;34. Coordinate subtraction</a></li><li><a href="S-s8.html#SP35">&#167;35. Initialise line drawing variables</a></li><li><a href="S-s8.html#SP36">&#167;36. Line Initialisation</a></li><li><a href="S-s8.html#SP37">&#167;37. Absolute value</a></li><li><a href="S-s8.html#SP38">&#167;38. Copy eight bytes (four coordinates) of VDU variables</a></li><li><a href="S-s8.html#SP39">&#167;39. copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue</a></li><li><a href="S-s8.html#SP40">&#167;40. Copy two bytes (one coordinate) of VDU variables</a></li><li><a href="S-s8.html#SP41">&#167;41. copyGraphicsCursorPixelPositionToWorkspaceABCD</a></li><li><a href="S-s8.html#SP42">&#167;42. copyGraphicsCursorPixelPosition</a></li><li><a href="S-s8.html#SP43">&#167;43. Copy four bytes (e.g</a></li><li><a href="S-s8.html#SP44">&#167;44. Copy a number of bytes in VDU variables</a></li><li><a href="S-s8.html#SP45">&#167;45. Negate the sixteen bit value in A and Y</a></li><li><a href="S-s8.html#SP46">&#167;46. checkPixelIsBackgroundColour</a></li><li><a href="S-s8.html#SP47">&#167;47. outsideBoundaries</a></li><li><a href="S-s8.html#SP48">&#167;48. Lateral fill left and right</a></li><li><a href="S-s8.html#SP49">&#167;49. lateralFillLeftNearlyDone</a></li><li><a href="S-s8.html#SP50">&#167;50. lateralFillRightNearlyDone</a></li><li><a href="S-s8.html#SP51">&#167;51. setNextPixelPosition</a></li><li><a href="S-s8.html#SP52">&#167;52. lateralFillRightPartialByte</a></li><li><a href="S-s8.html#SP53">&#167;53. lateralFillRightGetMaskLoop</a></li><li><a href="S-s8.html#SP54">&#167;54. lateralFillRightGetMask</a></li><li><a href="S-s8.html#SP55">&#167;55. lateralFillLeftPartialByte</a></li><li><a href="S-s8.html#SP56">&#167;56. lateralFillLeftGetMaskLoop</a></li><li><a href="S-s8.html#SP57">&#167;57. Get width of parameter point to graphics window edge</a></li><li><a href="S-s8.html#SP58">&#167;58. Set parameter X coordinate to the given distance from the left/right edge of the window</a></li><li><a href="S-s8.html#SP59">&#167;59. OSWORD 13 - Read last two graphic cursor positions</a></li><li><a href="S-s8.html#SP60">&#167;60. Fill triangle</a></li><li><a href="S-s8.html#SP61">&#167;61. Sort the parameter point and the old graphics cursor point, sorting by Y coordinate</a></li><li><a href="S-s8.html#SP62">&#167;62. Sort one point with another, sorting by Y coordinate</a></li><li><a href="S-s8.html#SP63">&#167;63. OSBYTE 134 - Read text cursor position</a></li><li><a href="S-s8.html#SP64">&#167;64. Fill half a triangle</a></li><li><a href="S-s8.html#SP65">&#167;65. Fill a single horizontal row</a></li><li><a href="S-s8.html#SP66">&#167;66. Calculate leftmost byte</a></li><li><a href="S-s8.html#SP67">&#167;67. Update one edge when filling a triangle</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. Plot routine. </b></p>

<p class="center-p"><img src="plot.png" alt="plot.png"></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> The plot routine is a multi-purpose tool for drawing graphics. It renders points,</span>
<span class="ACME-plain-syntax"> lines, dotted lines, filled triangles, and single horizontal line fills. It can also just</span>
<span class="ACME-plain-syntax"> move the current graphics cursor position. The lower three bits of the plot type hold plot</span>
<span class="ACME-plain-syntax"> options:</span>

<span class="ACME-plain-syntax"> Plot Options:</span>
<span class="ACME-plain-syntax">   0         Move relative to last point</span>
<span class="ACME-plain-syntax">   1         Draw relative to last point in foreground colour</span>
<span class="ACME-plain-syntax">   2         Draw relative to last point in inverse colour</span>
<span class="ACME-plain-syntax">   3         Draw relative to last point in background colour</span>
<span class="ACME-plain-syntax">   4         Move absolute</span>
<span class="ACME-plain-syntax">   5         Draw absolute in foreground colour</span>
<span class="ACME-plain-syntax">   6         Draw absolute in inverse colour</span>
<span class="ACME-plain-syntax">   7         Draw absolute in background colour</span>

<span class="ACME-plain-syntax"> ---------------------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax"> PLOT TYPE   RANGE IN BINARY      BITS3-6    DESCRIPTION</span>
<span class="ACME-plain-syntax"> RANGE       abcdefgh-abcdefgh    bcde</span>
<span class="ACME-plain-syntax"> ---------------------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax"> 0-7         00000000-00000111    0000       Move/Draw line with standard options 0-7</span>
<span class="ACME-plain-syntax"> 8-15        00001000-00001111    0001       As 0-7 but with the last point in a line omitted</span>
<span class="ACME-plain-syntax">                                             when plotting with GCOL mode 3 (EOR) or 4</span>
<span class="ACME-plain-syntax">                                             (INVERT)</span>
<span class="ACME-plain-syntax"> 16-23       00010000-00010111    0010       As 0-7 but with a dotted line</span>
<span class="ACME-plain-syntax"> 24-31       00011000-00011111    0011       As 0-7 but with a dotted line and the last point</span>
<span class="ACME-plain-syntax">                                             in a line omitted when plotting with GCOL mode 3</span>
<span class="ACME-plain-syntax">                                             (EOR) or 4 (INVERT)</span>
<span class="ACME-plain-syntax"> 32-39       00100000-00100111    0100       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 40-47       00101000-00101111    0101       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 48-55       00110000-00110111    0110       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 56-63       00111000-00111111    0111       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 64-71       01000000-01000111    1000       As 0-7 but only a single point is plotted</span>
<span class="ACME-plain-syntax"> 72-79       01001000-01001111    1001       As 0-7 but fill one line horizontally left and</span>
<span class="ACME-plain-syntax">                                             right</span>
<span class="ACME-plain-syntax"> 80-87       01010000-01010111    1010       As 0-7 but fill a triangle</span>
<span class="ACME-plain-syntax"> 88-95       01011000-01011111    1011       As 0-7 but fill one line horizontally right</span>
<span class="ACME-plain-syntax"> 96-103      01100000-01100111    1100       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 104-111     01101000-01101111    1101       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 112-119     01110000-01110111    1110       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 120-127     01111000-01111111    1111       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> 128-255     10000000-11111111    xxxx       RESERVED for future expansion</span>
<span class="ACME-plain-syntax"> ---------------------------------------------------------------------------------------</span>

<span class="ACME-plain-syntax"> Coordinate Systems</span>

<span class="ACME-plain-syntax"> The standard graphics coordinate system ranges from (0,0) at the bottom left of the screen</span>
<span class="ACME-plain-syntax"> to (1280 x 1024) at the top right. This coordinate range represents the entire screen</span>
<span class="ACME-plain-syntax"> regardless of the actual number of pixels available on screen.</span>

<span class="ACME-plain-syntax"> The graphics window origin can be changed to specify where a pixel drawn at (0,0) actually</span>
<span class="ACME-plain-syntax"> appears on the screen. This is a translation of the coordinate system.</span>

<span class="ACME-plain-syntax"> These resolution independent coordinates are called 'external' coordinates in this document.</span>

<span class="ACME-plain-syntax"> When calling the OS, external coordinates can optionally be specified 'relative' to the last</span>
<span class="ACME-plain-syntax"> point plotted. Coordinates are also always specified relative to the current graphics window</span>
<span class="ACME-plain-syntax"> origin. When translated into full screen coordinates these are known here as 'absolute'</span>
<span class="ACME-plain-syntax"> coordinates.</span>

<span class="ACME-plain-syntax"> Within OS routines absolute coordinates are scaled down to a pixel based scale. These are</span>
<span class="ACME-plain-syntax"> called 'pixel' coordinates. Pixel coordinates are never 'relative' coordinates in the sense</span>
<span class="ACME-plain-syntax"> above, but that doesn't stop OS routines temporarily storing the difference between two</span>
<span class="ACME-plain-syntax"> pixel based coordinates as part of its calculations of course.</span>

<span class="ACME-plain-syntax"> Conversions between the coordinate systems are done via:</span>

<span class="ACME-plain-syntax">       .plotConvertExternalAbsoluteCoordinatesToPixels</span>
<span class="ACME-plain-syntax">       .plotConvertExternalRelativeCoordinatesToPixels</span>
<span class="ACME-plain-syntax">       .convertPixelGraphicsCoordinatesToExternal</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25ParameterPlotType</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25ParameterPlotType</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a>, <a href="S-s8.html#SP18">&#167;18</a>, <a href="S-s8.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25ParameterXLow</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25ParameterXLow</span></span>:<br/><a href="S-s8.html#SP11">&#167;11</a>, <a href="S-s8.html#SP22">&#167;22</a>, <a href="S-s8.html#SP33">&#167;33</a>, <a href="S-s8.html#SP49">&#167;49</a>, <a href="S-s8.html#SP57">&#167;57</a>, <a href="S-s8.html#SP58">&#167;58</a>, <a href="S-s8.html#SP60">&#167;60</a>, <a href="S-s8.html#SP61">&#167;61</a>, <a href="S-s8.html#SP64">&#167;64</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax">     = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25ParameterXHigh</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25ParameterXHigh</span></span>:<br/><a href="S-s8.html#SP57">&#167;57</a>, <a href="S-s8.html#SP58">&#167;58</a></span></button><span class="ACME-plain-syntax">    = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25ParameterYLow</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25ParameterYLow</span></span>:<br/><a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax">     = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25ParameterYHigh</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25ParameterYHigh</span></span>:<br/><a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax">    = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25Plot</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25Plot</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP55">&#167;55</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d060</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">X is offset to X Coordinate (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP18" class="function-link"><span class="ACME-function-syntax">plotConvertExternalRelativeCoordinatesToPixels</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">translate coordinates</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterPlotType</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get plot type</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">check for plot type four (move</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">absolute)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP9" class="function-link"><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">if (plot type is four) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(move absolute)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #5                                              </span><span class="ACME-comment-syntax">Y=5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">mask only bits 0 and 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (result is 0) then branch (it's a</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">move operation)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">check bit zero</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP2" class="function-link"><span class="ACME-function-syntax">plotWithGraphicsColour</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (plot option needs foreground or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background graphics colour) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=4 ('inverse' plot option)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">ALWAYS branch. The logic inverse</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour must be wanted</span>
</pre>
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. Plot with graphics character. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A=0 it's a foreground colour</span>
<span class="ACME-plain-syntax">       A=1 it's a background colour</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotWithGraphicsColour</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">plotWithGraphicsColour</span></span>:<br/><a href="S-s8.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d078</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGCOLMode</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get foreground or background</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics PLOT mode (into Y)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGraphicsColour</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} get foreground or background</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} graphics colour (into X)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP6" class="function-link"><span class="ACME-function-syntax">setGraphicsColourMaskXY</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">set up colour masks in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduGraphicsColourByteOR/EOR</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterPlotType</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get plot type</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP4" class="function-link"><span class="ACME-function-syntax">plotExtensionLocal</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (128-255) then branch (it's</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">RESERVED for future expansion)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 0-127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">bcdefgh0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP7" class="function-link"><span class="ACME-function-syntax">plotType0to63</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">if (bit 7 is now 0, i.e. plot type</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is 0-63) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 64-127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%11110000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">bcde0000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">cde00000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP8" class="function-link"><span class="ACME-function-syntax">plotPointAndMove</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (zero) then branch (plot type</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">64-71 was called, single point plot)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 72-127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01000000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">cDe00000 (inverted bit d)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP3" class="function-link"><span class="ACME-function-syntax">plotFillTriangleLocal</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (bit 'D' clear; i.e. bit 'd' set)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (plot type 80-87, fill</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">triangle)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 72-79 or 88-127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push cDe00000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP10" class="function-link"><span class="ACME-function-syntax">copyPlotParametersToGraphicsCursorPixelPosition</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">copy parameters, setting XY in</span>
<span class="ACME-plain-syntax">                                                         </span><span class="ACME-comment-syntax">current graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back cDe00000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">cdE00000 (invert bit D back to d,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and invert bit e)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP5" class="function-link"><span class="ACME-function-syntax">storeAndLateralFillLeftRight</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">if (cdE00000 == 00000000) (ie.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cde == 001) then branch (type</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is 72-79, it's a lateral fill</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">left/right)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 88-127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01000000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (cdE00000 == 01000000) (ie.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cde == 011) then type is 88-95</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(it's a lateral fill right)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP4" class="function-link"><span class="ACME-function-syntax">plotExtensionLocal</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">otherwise branch (RESERVED for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">future expansion)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with plot 88-95</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLateralFillRight</span><span class="ACME-plain-syntax">                                   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">A=2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDC = 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillRight</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">lateral fill right</span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. plotFillTriangleLocal. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotFillTriangleLocal</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">plotFillTriangleLocal</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0a8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP60" class="function-link"><span class="ACME-function-syntax">plotFillTriangle</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">to fill triangle routine</span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. plotExtensionLocal. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotExtensionLocal</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">plotExtensionLocal</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a>, <a href="S-s8.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0ab</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP51" class="function-link"><span class="ACME-function-syntax">vduPlotExtension</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">VDU extension access entry</span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. storeAndLateralFillLeftRight. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">storeAndLateralFillLeftRight</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">storeAndLateralFillLeftRight</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0ae</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDC = 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP48" class="function-link"><span class="ACME-function-syntax">lateralFillLeftRight</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">lateral fill left and right</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. Set graphics colour and GCOL mode bytes. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> When writing graphics pixels to the screen, two bytes are used to adjust the byte to write</span>
<span class="ACME-plain-syntax"> based on the current colour and GCOL mode.</span>
<span class="ACME-plain-syntax"> This routine sets these two bytes .vduGraphicsColourByteOR and .vduGraphicsColourByteEOR</span>

<span class="ACME-plain-syntax"> GCOL Mode</span>
<span class="ACME-plain-syntax"> ---------</span>
<span class="ACME-plain-syntax"> 0 = Normal Mode: Sets the pixel to the current colour</span>
<span class="ACME-plain-syntax"> 1 =     OR Mode: Sets the pixel to the current colour  OR-ed with the colour on screen</span>
<span class="ACME-plain-syntax"> 2 =    AND Mode: Sets the pixel to the current colour AND-ed with the colour on screen</span>
<span class="ACME-plain-syntax"> 3 =    EOR Mode: Sets the pixel to the current colour EOR-ed with the colour on screen</span>
<span class="ACME-plain-syntax"> 4 = Invert Mode: Inverts the colour already on screen</span>

<span class="ACME-plain-syntax"> Suppose 'C' is the byte that when written to the screen sets each pixel of the byte to</span>
<span class="ACME-plain-syntax"> the current graphics colour.</span>

<span class="ACME-plain-syntax"> Then the two bytes are set as follows:</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">       0=Normal Mode  | .vduGraphicsColourByteOR  = (C OR $FF) EOR $00 = $FF</span>
<span class="ACME-plain-syntax">                      | .vduGraphicsColourByteEOR = (C OR $00) EOR $FF = C EOR $FF</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">       1=OR Mode      | .vduGraphicsColourByteOR  = (C OR $00) EOR $00 = C</span>
<span class="ACME-plain-syntax">                      | .vduGraphicsColourByteEOR = (C OR $FF) EOR $FF = 0</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">       2=AND Mode     | .vduGraphicsColourByteOR  = (C OR $00) EOR $FF = C EOR $FF</span>
<span class="ACME-plain-syntax">                      | .vduGraphicsColourByteEOR = (C OR $00) EOR $FF = C EOR $FF</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">       3=EOR Mode     | .vduGraphicsColourByteOR  = (C OR $FF) EOR $FF = 0</span>
<span class="ACME-plain-syntax">                      | .vduGraphicsColourByteEOR = (C OR $00) EOR $00 = C</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>
<span class="ACME-plain-syntax">       4=Invert Mode  | .vduGraphicsColourByteOR  = (C OR $FF) EOR $FF = 0</span>
<span class="ACME-plain-syntax">                      | .vduGraphicsColourByteEOR = (C OR $FF) EOR $00 = $FF</span>
<span class="ACME-plain-syntax">       ------------------------------------------------------------------------</span>

<span class="ACME-plain-syntax"> When writing a pixel, start with a byte 'B', just the bits required to set one pixel to</span>
<span class="ACME-plain-syntax"> white. Then the pixel is written like so:</span>

<span class="ACME-plain-syntax">            temp = (B AND .vduGraphicsColourByteOR) OR (current screen byte)</span>
<span class="ACME-plain-syntax"> new screen byte = (.vduGraphicsColourByteEOR AND B) EOR temp</span>

<span class="ACME-plain-syntax"> [A quirk: This routine is called with Y=5 for a relative move PLOT operation, but as</span>
<span class="ACME-plain-syntax">           there's nothing to draw, the results are unused in this case.]</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = colour byte to set</span>
<span class="ACME-plain-syntax">       Y = GCOL Mode (0=Normal, 1=OR, 2=AND, 3=EOR, 4=Invert)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .vduGraphicsColourByteOR / EOR hold the appropriate mask values</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setGraphicsColourMaskXY</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">setGraphicsColourMaskXY</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP41">&#167;41</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0b3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP12" class="function-link"><span class="ACME-function-syntax">gcolPlotOptionsTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">OR with GCOL plot options table byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP12" class="function-link"><span class="ACME-function-syntax">gcolPlotOptionsTable</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">EOR with following byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteOR</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">and store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP12" class="function-link"><span class="ACME-function-syntax">gcolPlotOptionsTable</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP12" class="function-link"><span class="ACME-function-syntax">gcolPlotOptionsTable</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteEOR</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">masks are stored in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduGraphicsColourByteOR/EOR</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. plotType0to63. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Continue processing of a PLOT command, where the plot type is in the range 0-63</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotType0to63</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">plotType0to63</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0c6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">cdefgh00</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP4" class="function-link"><span class="ACME-function-syntax">plotExtensionLocal</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (options are in range 32-63) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (not implemented)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">defgh000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">efgh0000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (still +ve; type is 0-7 or 16-23)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (skips plot point)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPoint</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">type is 8-15 or 24-31. We want to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">omit the last point when drawing</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">in invert mode, so we do this by</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">displaying a point, which will get</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">inverted (erased) again in the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">normal course of drawing the line.</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">plotLine</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">draw a line or dotted line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP9" class="function-link"><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">move the graphics cursor</span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. plotPointAndMove. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Plot a single point and move the graphics cursor position</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotPointAndMove</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">plotPointAndMove</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0d6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPoint</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">display a point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. plotMoveGraphicsCursorInAbsolutePixels. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Move the current graphics cursor position, to new absolute pixel coordinates given by</span>
<span class="ACME-plain-syntax"> the vdu25Parameters.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span></span>:<br/><a href="S-s8.html#SP1">&#167;1</a>, <a href="S-s8.html#SP7">&#167;7</a>, <a href="S-s8.html#SP51">&#167;51</a>, <a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0d9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP11" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">swap current and last graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position. The current position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">becomes the previous position.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. copyPlotParametersToGraphicsCursorPixelPosition. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyPlotParametersToGraphicsCursorPixelPosition</span><button class="popup" onclick="togglePopup('usagePopup15')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup15">Usage of <span class="code-font"><span class="ACME-function-syntax">copyPlotParametersToGraphicsCursorPixelPosition</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0dc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">destination is the graphics</span>
<span class="ACME-plain-syntax">                                                           </span><span class="ACME-comment-syntax">cursor position in pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. copyParameterPointToDestinationY. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyParameterPointToDestinationY</span><button class="popup" onclick="togglePopup('usagePopup16')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup16">Usage of <span class="code-font"><span class="ACME-function-syntax">copyParameterPointToDestinationY</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a>, <a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0de</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">source is the position coordinate on</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the VDU queue</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">copy four bytes</span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. Plot one pixel of a character. </b></p>

<p class="center-p"><img src="Characters.png" alt="Characters.png"></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> When drawing a character at the graphics cursor, this draws an individual pixel</span>
<span class="ACME-plain-syntax"> of that character. It uses the current graphics cursor position as the position to plot.</span>

<span class="ACME-plain-syntax"> Each pixel is tested to see if it's within the bounds of the current graphics window,</span>
<span class="ACME-plain-syntax"> so characters can be partially drawn.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotAPixelInACharacter</span><button class="popup" onclick="togglePopup('usagePopup17')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup17">Usage of <span class="code-font"><span class="ACME-function-syntax">plotAPixelInACharacter</span></span>:<br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0e3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP6" class="function-link"><span class="ACME-function-syntax">checkPointXInBoundsAndSetScreenAddresses</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">calculate position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPointWithinBounds</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (within bounds) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. Plots a single point. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This checks the point against the graphics window, gets the screen address details, then</span>
<span class="ACME-plain-syntax"> renders the pixel by writing to the screen address, applying the colour masks and plot type.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X holds the offset into the VDU variables for four bytes holding the position to plot</span>
<span class="ACME-plain-syntax">       at.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotPoint</span><button class="popup" onclick="togglePopup('usagePopup18')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup18">Usage of <span class="code-font"><span class="ACME-function-syntax">plotPoint</span></span>:<br/><a href="S-s8.html#SP7">&#167;7</a>, <a href="S-s8.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0eb</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP5" class="function-link"><span class="ACME-function-syntax">checkParameterInBoundsAndSetScreenAddresses</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check in bounds and set up screen</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">addresses</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (A is not zero) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotPointWithinBounds</span><button class="popup" onclick="togglePopup('usagePopup19')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup19">Usage of <span class="code-font"><span class="ACME-function-syntax">plotPointWithinBounds</span></span>:<br/><a href="S-s8.html#SP12">&#167;12</a>, <a href="S-s8.html#SP54">&#167;54</a>, <a href="S-s8.html#SP65">&#167;65</a>, <a href="S-s8.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0f0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">get current graphics scan line</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotPointWithinBoundsAtY</span><button class="popup" onclick="togglePopup('usagePopup20')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup20">Usage of <span class="code-font"><span class="ACME-function-syntax">plotPointWithinBoundsAtY</span></span>:<br/><a href="S-s8.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d0f3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteOR</span></a><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteEOR</span></a><span class="ACME-plain-syntax">                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">put it back again</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. Plots a filled whole byte (as part of a lateral fill). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Y is the vertical offset within a character cell (0-7)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotByte</span><button class="popup" onclick="togglePopup('usagePopup21')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup21">Usage of <span class="code-font"><span class="ACME-function-syntax">plotByte</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a>, <a href="S-s8.html#SP49">&#167;49</a>, <a href="S-s8.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d104</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteOR</span></a><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteEOR</span></a><span class="ACME-plain-syntax">                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. Check that the graphics cursor is within the graphics window. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   .vduTempStoreDA is zero if the point is within the graphics window, or the four low bits</span>
<span class="ACME-plain-syntax">                indicate which regions failed:</span>

<span class="ACME-plain-syntax">       %0000   success (point is within window)</span>
<span class="ACME-plain-syntax">       %0001   graphics cursor X is left of  the left   edge of the graphics window</span>
<span class="ACME-plain-syntax">       %0010   graphics cursor X is right of the right  edge of the graphics window</span>
<span class="ACME-plain-syntax">       %0100   graphics cursor Y is below    the bottom edge of the graphics window</span>
<span class="ACME-plain-syntax">       %1000   graphics cursor Y is above    the top    edge of the graphics window</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span><button class="popup" onclick="togglePopup('usagePopup22')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup22">Usage of <span class="code-font"><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP23">&#167;23</a>, <a href="S-s5.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d10d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">X is the offset to check the</span>
<span class="ACME-plain-syntax">                                                           </span><span class="ACME-comment-syntax">graphics cursor</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span><button class="popup" onclick="togglePopup('usagePopup23')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup23">Usage of <span class="code-font"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a>, <a href="S-s8.html#SP65">&#167;65</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP6">&#167;6</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d10f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDA is initialised to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">zero (stores the error code)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">Y is the index to check the vertical</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bounds of the graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP16" class="function-link"><span class="ACME-function-syntax">checkPointIsWithinWindowHorizontalOrVertical</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">check graphics cursor is within</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window vertically</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} Shift up error results two bits to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} make room for the next horizontal</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} test results</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">reduce index by two to check the X</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y is the index to check the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">horizontal bounds of the graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP16" class="function-link"><span class="ACME-function-syntax">checkPointIsWithinWindowHorizontalOrVertical</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">check graphics cursor is within</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window horizontally</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} Restore X to initial value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A = error code (0,1,2,4,5,6,8,9,10)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">depending on which bounds are</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">exceeded</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. Check coordinate of a point is in the window bounds (horizontal or vertical). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X is the offset to the coordinate to check minus two bytes</span>
<span class="ACME-plain-syntax">       Y is the offset to the second variable to check (0 for horizontal or 2 for vertical)</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .vduTempStoreDA is the error code (0 = no error, 1 = first check failed, 2 = second check</span>
<span class="ACME-plain-syntax">       failed)</span>
<span class="ACME-plain-syntax">       Zero flag set if no error</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkPointIsWithinWindowHorizontalOrVertical</span><button class="popup" onclick="togglePopup('usagePopup24')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup24">Usage of <span class="code-font"><span class="ACME-function-syntax">checkPointIsWithinWindowHorizontalOrVertical</span></span>:<br/><a href="S-s8.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d128</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} Subtract two sixteen bit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} variables, compare the results.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">0</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} if var[X+2,X+3] &lt; var[Y,Y+1] then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} error</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP16" class="function-link"><span class="ACME-function-syntax">oneError</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">branch if error</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} Subtract two sixteen bit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} variables, compare the results.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} if var[Y+4,Y+5] &lt; var[X+2,X+3]</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} then error</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (no violation) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">increment error code</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">oneError</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d146</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">increment error code</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. Convert external absolute coordinates to pixels. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Convert external, absolute coordinates to pixels (horizontal and vertical)</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X is the offset in vdu variables to the coordinate to convert</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotConvertExternalAbsoluteCoordinatesToPixels</span><button class="popup" onclick="togglePopup('usagePopup25')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup25">Usage of <span class="code-font"><span class="ACME-function-syntax">plotConvertExternalAbsoluteCoordinatesToPixels</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP61">&#167;61</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d149</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$FF to ensure absolute coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. Convert external relative coordinates to pixels. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Convert pair of external coordinates to pixels (horizontal and vertical)</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X is the offset in vdu variables to the coordinate to convert</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotConvertExternalRelativeCoordinatesToPixels</span><button class="popup" onclick="togglePopup('usagePopup26')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup26">Usage of <span class="code-font"><span class="ACME-function-syntax">plotConvertExternalRelativeCoordinatesToPixels</span></span>:<br/><a href="S-s8.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d14d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterPlotType</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">get first parameter in</span>
<span class="ACME-plain-syntax">                                                                    </span><span class="ACME-comment-syntax">plot</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                             </span><span class="ACME-comment-syntax">store in .vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                                          </span><span class="ACME-comment-syntax">Y=2 (for vertical</span>
<span class="ACME-plain-syntax">                                                                    </span><span class="ACME-comment-syntax">coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP19" class="function-link"><span class="ACME-function-syntax">convertExternalRelativeCoordinateToAbsoluteAndDivideByTwo</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">convert</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP20" class="function-link"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">divide by 2 again to</span>
<span class="ACME-plain-syntax">                                                                    </span><span class="ACME-comment-syntax">convert 1023 to 0-255</span>
<span class="ACME-plain-syntax">                                                                    </span><span class="ACME-comment-syntax">for pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                                          </span><span class="ACME-comment-syntax">Y=0 (for horizontal</span>
<span class="ACME-plain-syntax">                                                                    </span><span class="ACME-comment-syntax">coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                             </span><span class="ACME-comment-syntax">X-=2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP19" class="function-link"><span class="ACME-function-syntax">convertExternalRelativeCoordinateToAbsoluteAndDivideByTwo</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">convert</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get number of pixels per byte (-1)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    7 for MODE 0</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    3 for MODE 1</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    1 for MODE 2</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    0 for MODE 3</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    7 for MODE 4</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    3 for MODE 5</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    0 for MODE 6</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    0 for MODE 7</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #3                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (MODE 1 or 5) then branch (divide</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">by 2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP18" class="function-link"><span class="ACME-function-syntax">doneDividing</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (MODE 0 or 4) then branch (no</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">division needed)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP20" class="function-link"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (MODE 2,3,6 or 7) then divide by 4</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">                  (divide by two</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">twice)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP20" class="function-link"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">doneDividing</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d170</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODEGroup</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">MODE group</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP20" class="function-link"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (MODEs 3-7) then branch (divide</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">by 2 again)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. Converts the vdu queue parameter to absolute coordinates and divides by two. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X               is the offset to the vdu queue parameter coordinate to convert</span>
<span class="ACME-plain-syntax">       Y               is 0 or 2 for the horizontal or vertical cursor coordinates</span>
<span class="ACME-plain-syntax">       .vduTempStoreDA is the plot type (to check for relative coordinate conversion)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">convertExternalRelativeCoordinateToAbsoluteAndDivideByTwo</span><button class="popup" onclick="togglePopup('usagePopup27')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup27">Usage of <span class="code-font"><span class="ACME-function-syntax">convertExternalRelativeCoordinateToAbsoluteAndDivideByTwo</span></span>:<br/><a href="S-s8.html#SP18">&#167;18</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d176</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get .vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP19" class="function-link"><span class="ACME-function-syntax">addPreviousCoordinate</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} if (relative coordinates) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} branch (add previous coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">get coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP19" class="function-link"><span class="ACME-function-syntax">addGraphicsOrigin</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">ALWAYS branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">addPreviousCoordinate</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d186</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">get coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">add cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">add cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">addGraphicsOrigin</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d194</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">save new cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowOriginXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">add graphics origin</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">save it in new cursor low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowOriginXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">add to graphics orgin</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP20" class="function-link"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (carry clear) then branch (skip</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">over next statement)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">increment high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP20" class="paragraph-anchor"></a><b>&#167;20. Divides the signed 16 bit coordinate value by two. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X is the offset to the coordinate from .vduGraphicsWindowPixelsBottomLow</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span><button class="popup" onclick="togglePopup('usagePopup28')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup28">Usage of <span class="code-font"><span class="ACME-function-syntax">signedDivideCoordinateByTwo</span></span>:<br/><a href="S-s8.html#SP18">&#167;18</a>, <a href="S-s8.html#SP19">&#167;19</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d1ad</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">get high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP21" class="paragraph-anchor"></a><b>&#167;21. Convert pixel coordinates to external absolute coordinates. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span><button class="popup" onclick="togglePopup('usagePopup29')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup29">Usage of <span class="code-font"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></span>:<br/><a href="S-s8.html#SP51">&#167;51</a>, <a href="S-s8.html#SP59">&#167;59</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP23">&#167;23</a>, <a href="S-s5.html#SP31">&#167;31</a>, <a href="S-s5.html#SP64">&#167;64</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP24">&#167;24</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d1b8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">destination: graphics cursor in</span>
<span class="ACME-plain-syntax">                                                             </span><span class="ACME-comment-syntax">external coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP42" class="function-link"><span class="ACME-function-syntax">copyGraphicsCursorPixelPosition</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">source is graphics cursor in pixel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">copy pixel coordinates to external</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">X=2 (offset to update the vertical</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">Y=2 (shift twice to multiply by four)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">multiply .vduGraphicsCursorPositionY</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">by 4 and subtract graphics origin</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">this is the external Y coordinate.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X=0 (offset to update the horizontal</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y=4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get number of pixels/byte</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (result not 0) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Pixels                                     Number of</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">per byte   Screen     Y       MODE       multiplication</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">minus one   MODE     Now      group      steps (#shifts)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">--------------------------------------------------------</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   7       MODE 0     1         0              1  (x1)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   3       MODE 1     2         0              2  (x2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   1       MODE 2     3         0              3  (x4)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   0       MODE 3     -         1              -</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   7       MODE 4     1         2              2  (x2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   3       MODE 5     2         2              3  (x4)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   0       MODE 6     -         3              -</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">   0       MODE 7     -         4              -</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">--------------------------------------------------------</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODEGroup</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">MODE group</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y holds the number of multiplication</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">steps (1, 2 or 3)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">} multiply coordinate by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y-Y-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y != 0) then branch (do it again)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">do one coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment X</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get current graphics position in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">external coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowOriginXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">subtract origin</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">store in graphics cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP22" class="paragraph-anchor"></a><b>&#167;22. Plot a line or a dotted line. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Bresenham's line drawing algorithm is used.</span>
<span class="ACME-plain-syntax"> See </span><a href="https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm" class="external">https://en.wikipedia.org/wiki/Bresenham%27s_line_algorithm</a>

<span class="ACME-plain-syntax"> In the enclosed BASIC program, we sketch out the ideas behind the assembly that follows.</span>
<span class="ACME-plain-syntax"> The code plots a bunch of random lines on the screen using standard OS line drawing, then</span>
<span class="ACME-plain-syntax"> undraws the same set of lines using a BASIC routine that mimics the OS code. The process</span>
<span class="ACME-plain-syntax"> is slow (it's written in unoptimised BASIC) but it unplots the exact same pixels</span>
<span class="ACME-plain-syntax"> as the OS routine. See:</span>
</pre>
<div class="download-container">
	<p>
		<a href="lines.ssd" download>
			<button class="download-button">
				<img src="../docs-assets/download.png" alt="download icon" height=16 width=16>
				Download <b>lines.ssd</b> (BBC Micro disc image, 5kB)
			</button>
		</a>
	</p>
</div>


<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLine</span><button class="popup" onclick="togglePopup('usagePopup30')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup30">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLine</span></span>:<br/><a href="S-s8.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d1ed</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP33" class="function-link"><span class="ACME-function-syntax">plotLineInitialiseDeltaValues</span></a><span class="ACME-plain-syntax">                  </span>

<span class="ACME-comment-syntax">Now we have set the delta values:</span>

<span class="ACME-comment-syntax">  Set .vduPlotLineDeltaX = graphics cursorX - parameterX  (lets call this dX)</span>
<span class="ACME-comment-syntax">  Set .vduPlotLineDeltaY = graphics cursorY - parameterY  (lets call this dY)</span>

<span class="ACME-comment-syntax">At this point, the values in .vduPlotLineDeltaX/Y are the delta in pixels for the line.</span>
<span class="ACME-comment-syntax">The values are 16 bit signed integers. Positive values are to the left and down on screen,</span>
<span class="ACME-comment-syntax">like so:</span>

<span class="ACME-comment-syntax">                                        |</span>
<span class="ACME-comment-syntax">                                        |</span>
<span class="ACME-comment-syntax">                                        |</span>
<span class="ACME-comment-syntax">                      dX /______________|_____________</span>
<span class="ACME-comment-syntax">                         \           ###|&lt;-(current graphics</span>
<span class="ACME-comment-syntax">                                  ###   |   cursor position)</span>
<span class="ACME-comment-syntax">                               ###      |</span>
<span class="ACME-comment-syntax">                            ###         |</span>
<span class="ACME-comment-syntax">       (new parameter -&gt; ###           \|/</span>
<span class="ACME-comment-syntax">          coordinates)                 dY</span>


<span class="ACME-comment-syntax">Now calculate the dominant axis, i.e. which of dx and dy has the largest magnitude.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYHigh</span></a><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">check high bytes for different sign</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit in dX/dY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">sectionB</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (result -ve; then deltas are</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">different in sign) then branch later</span>

<span class="ACME-comment-syntax">-------------SECTION A-------------</span>
<span class="ACME-comment-syntax">dX and dY have the same sign</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYLow</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXLow</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">} if (dY &gt;= dX) then A = dY - dX</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}               else A = dY - dX - 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} Result: A is positive if dY &gt; dX,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} A is negative if dY &lt; dX,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} otherwise A = 0.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">}    i.e. A is SIGN(dY - dX), C =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} carry of difference (^)</span>
<span class="ACME-comment-syntax">----------SECTION A ENDS-----------</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">plotLineGotDeltas</span></a><span class="ACME-plain-syntax">                              </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sectionB</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d207</span>
<span class="ACME-comment-syntax">-------------SECTION B-------------</span>
<span class="ACME-comment-syntax">dX and dY have different signs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXLow</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">} A = (dX + dY) (high byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} (where deltas are different in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} sign, so really a subtraction)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYLow</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} Result: A is positive if (dX &gt;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} -dY), A is negative if dX &lt; -dY,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} otherwise A = 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}    i.e. A is SIGN(dX - dY), C =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} carry of difference</span>
<span class="ACME-comment-syntax">----------SECTION B ENDS-----------</span>


<span class="ACME-comment-syntax">Table of examples (Part 1)</span>
<span class="ACME-comment-syntax">        A=   B=  C=  D=           --------SECTION A---------- ----------SECTION B----------</span>
<span class="ACME-comment-syntax">        dX   dX  dY  dY   signs   Carry= Result                Carry=   Result</span>
<span class="ACME-comment-syntax"> dX dY  Low  Hi Low  Hi  differ?  (C&gt;=A) D-B-(1-Carry)       (A+C)&gt;255  (B+D+Carry)</span>
<span class="ACME-comment-syntax">-------------------------------------------------------------------------------------------</span>
<span class="ACME-comment-syntax"> 3   1  $03 $00 $01 $00     no      0    $FF (Result Carry=0)     -     -</span>
<span class="ACME-comment-syntax"> 1   3  $01 $00 $03 $00     no      1    $00 (Result Carry=1)     -     -</span>
<span class="ACME-comment-syntax">-3   1  $FD $FF $01 $00     yes     -     -                       0     $FF (Result Carry=0)</span>
<span class="ACME-comment-syntax">-1   3  $FF $FF $03 $00     yes     -     -                       1     $00 (Result Carry=1)</span>
<span class="ACME-comment-syntax"> 3  -1  $03 $00 $FF $FF     yes     -     -                       1     $00 (Result Carry=1)</span>
<span class="ACME-comment-syntax"> 1  -3  $01 $00 $FD $FF     yes     -     -                       0     $FF (Result Carry=0)</span>
<span class="ACME-comment-syntax">-3  -1  $FD $FF $FF $FF     no      1    $00 (Result Carry=1)     -     -</span>
<span class="ACME-comment-syntax">-1  -3  $FF $FF $FD $FF     no      0    $FF (Result Carry=0)     -     -</span>
<span class="ACME-comment-syntax">--------------------------------------------------------------------------------------------</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineGotDeltas</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d214</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">based on the calculations just done, we work out the dominant axis, X=0 for the X-axis</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">being dominant (dX being at least as large in magnitude as dY), X=2 for the Y-axis</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">(dY being larger).</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">make top bit of A = 'result carry'</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">from above</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X = 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">check if carry from result above has</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">same sign as workspaceD</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (dY has same sign as A) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (with X=0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">X=2</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store X: 0 means dx is the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">dominant axis, at least as large</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">in magnitude as dy; 2 means dy is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">dominant</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineRoutineAddresses</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">} set up the address of one of two</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">} line drawing routines into</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineRoutineAddresses</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">} .vduJumpVectorLow/High (based on</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorHigh</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">} X=0 or 2)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">choose which side of the line</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">dY = -dX to draw on. (values $00</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">or $FF)</span>

<span class="ACME-comment-syntax">Table of examples (Part 2)</span>
<span class="ACME-comment-syntax">           carry flag</span>
<span class="ACME-comment-syntax"> dX dY   EOR top bit of D   .vduTempStoreDE  .vduPlotLineDeltaXHigh,X</span>
<span class="ACME-comment-syntax">-------------------------------------------------------------</span>
<span class="ACME-comment-syntax"> 3   1    0 EOR 0 = 0       0                $00</span>
<span class="ACME-comment-syntax"> 1   3    1 EOR 0 = 1       2 (Y dominant)   $00</span>
<span class="ACME-comment-syntax">-3   1    0 EOR 0 = 0       0                $FF (dy &lt; -dx)</span>
<span class="ACME-comment-syntax">-1   3    1 EOR 0 = 1       2 (Y dominant)   $00</span>
<span class="ACME-comment-syntax"> 3  -1    1 EOR 1 = 0       0                $00</span>
<span class="ACME-comment-syntax"> 1  -3    0 EOR 1 = 1       2 (Y dominant)   $FF (dy &lt; -dx)</span>
<span class="ACME-comment-syntax">-3  -1    1 EOR 1 = 0       0                $FF (dy &lt; -dx)</span>
<span class="ACME-comment-syntax">-1  -3    0 EOR 1 = 1       2 (Y dominant)   $FF (dy &lt; -dx)</span>
<span class="ACME-comment-syntax">-------------------------------------------------------------</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                   </span><span class="ACME-comment-syntax">if (dY &gt;=-dX) then branch</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">(start drawing from the new</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">parameter position)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">source: current graphics cursor</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">  (start drawing from current</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">cursor position)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">parametersSet</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">ALWAYS branch</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">source: vdu queue parameters (start</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">drawing from new cursor position)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">parametersSet</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d237</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The line's start point is the point furthest left (when X is the dominant axis) or</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">nearest the bottom (when Y is the dominant axis). The X register now holds the offset</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">to the vdu variable for the start point of the line.</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">source: (offset to vdu variable for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the start point, store in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduTempStoreDF)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">destination: current point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">copy the start point to the current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get offset to vdu variable for the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">start point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">switch X to point at whichever of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(vdu queue parameters / current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics cursor) wasn't chosen</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">before,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">i.e. the end of the line to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDD = offset to vdu</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">variable for the end of the line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">OR with 0 or 2 (if Y is the dominant</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">axis we offset by 2 to copy the Y</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate of the end point;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">otherwise copy the X coordinate). We</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">will use this later to check for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">termination on plotting the line.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP39" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">copy final coordinate to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">termination value. We use this later</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to check for termination on plotting</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the line.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterPlotType</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get plot type</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00010000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check bit 4 (dotted line)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">move to bit 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store whether we want a dotted line</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">($80) or not ($00)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">check if current point is out of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store error code (which directions</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">we are out of bounds)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (none) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01000000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} Set bit 6 of .vduTempStoreDB to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} indicate out of bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} (Bit 7 is still set for a dotted</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} line.)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">check other end of line for out of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">BIT test (AND) together the bits of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the two out of bounds calculations</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">this checks if the two ends of the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">line are out of bounds in the same</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">direction</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(e.g. both to the right of the right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">edge)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">worthPlottingLine</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (result is zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">the line is all off screen, so return</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">worthPlottingLine</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d26d</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">now we work out if the end point of the line is beyond the graphics window boundary.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if so then we set the termination value to the edge of the graphics window.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDE holds the dominant</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">axis value (0 or 2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X=0) then branch (skip the next</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit. Bits 0 and 1 of A are the error</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">code results for the X axis)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} here the Y axis is dominant.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} shift the error code down twice so</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} that the 'out of bounds' results</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} for the Y axis are in bits 0 and 1</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">clear all but bit 1</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">NOTE: bit 1 is set if the end point</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is either:</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">                to the right of the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics window (when X axis is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">dominant)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">            or above the top of the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics window (when Y axis is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">dominant)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (bit 2 clear) then branch (end</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point is ok, NOT off to the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">right/above the graphics window)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} The end point is beyond the right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} or top of the graphics window, so</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} we set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">} the termination variable</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} (.vduPlotLineTerminationValue) to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} the edge of the screen.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} Set bit 3 of X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} (now X is the offset to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduGraphicsWindowPixelsRightLow</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} or .vduGraphicsWindowPixelsTopLow)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP39" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">copy final X or Y</span>
<span class="ACME-plain-syntax">                                                                  </span><span class="ACME-comment-syntax">coordinate to the</span>
<span class="ACME-plain-syntax">                                                                  </span><span class="ACME-comment-syntax">termination value</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP35" class="function-link"><span class="ACME-function-syntax">plotLineInitializeVariables</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">initialise variables (error term and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">absolute coordinates)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">work out which of four plot routines we want to use (calculate X = 0 to 3)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get the dominant axis (0 or 2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">EOR it with 2 to get the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">non-dominant axis (2 or 0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} compare high bytes of dX and dY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYHigh</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (signs are the same) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X+1 (X is 3 or 1)</span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">remember the address of which routine to call</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP15" class="function-link"><span class="ACME-function-syntax">vduRoutineBranchVectorAddressesLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">get address and store at</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduPlotLineRoutineLow/High</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineRoutineLow</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">routine 0 is for a dominant Y axis,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and same signs of dX/dY</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.plotLineDominantYAxisSameSign)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP15" class="function-link"><span class="ACME-function-syntax">vduRoutineBranchVectorAddressesHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">routine 1 is for a dominant Y axis,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and different signs of dX/dY</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.plotLineDominantYAxisDifferentSign)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineRoutineHigh</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">routine 2 is for a dominant X axis,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and same signs of dX/dY</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.plotLineDominantXAxisSameSign)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">routine 3 is for a dominant X axis,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and different signs of dX/dY</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.plotLineDominantXAxisDifferentSign)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #127                                            </span><span class="ACME-comment-syntax">} set dotted line flag.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLinePlotDottedPixelFlag</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} 127 = draw a dot; 128 is skip.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">check bit 6 to see if current point</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is out of bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">currentPointIsOutOfBounds</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (out of bounds) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">get absolute distance to the graphics window edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP13" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowBoundariesTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">get offset to graphics window</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">boundary</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=offset to VDU variable for edge</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">of graphics window</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">0</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">} Y = non-dominant axis</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} get distance to edge:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} graphics window boundary - current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} XY = distance to window edge</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if(distance is positive) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP45" class="function-link"><span class="ACME-function-syntax">negateAY</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">negate AY: Make sure distance to edge</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is positive (note A=X from above)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} XY = ABS(distance to window edge)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">add one to distance in XY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} Increment XY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = high byte</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (A=0) then branch (not out of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bounds)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDF = low byte of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">distance,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">or zero if high byte is non-zero.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">In other words: if this value is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">one, then it's the last pixel.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">ALWAYs branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">currentPointIsOutOfBounds</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d2ce</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = X (quadrant 0-3)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">carry = signs differ</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">$80 = signs differ, $00 otherwise</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">set bit one</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">flip bit one of .vduTempStoreDE</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(dominant axis)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and flip bit 7 if signs differ</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and store</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Now .vduTempStoreDE stores:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  bit 7 = set if signs differ</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">  bit 1 = set if X axis dominant</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">this is used later in .plotLineContinuesOutOfBounds</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">} set screen address variables</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP6" class="function-link"><span class="ACME-function-syntax">setScreenAddress</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">} based on current point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} Decrement DC/DD</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} (we will store X later)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineLoop</span><button class="popup" onclick="togglePopup('usagePopup31')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup31">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineLoop</span></span>:<br/><a href="S-s8.html#SP29">&#167;29</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d2e3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">bit 7 set if dotted line; bit 6 set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">if out of bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">writePointToScreen</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (solid line in bounds) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (write to screen)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">plotLineCheckNowInBounds</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">if (solid line, but not in bounds)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with dotted line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLinePlotDottedPixelFlag</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">check top bit: 127 for a dot; 128</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">for a gap</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (dot should be drawn) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLinePlotDottedPixelFlag</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">decrement to 127</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">postWritePointToScreen</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">ALWAYs branch</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLinePlotDottedPixelFlag</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">increment to 128</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push bit 6 (out of bounds flag) into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">writePointToScreen</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (not out of bounds) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineCheckNowInBounds</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d2f9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store/remember X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP6" class="function-link"><span class="ACME-function-syntax">checkPointXInBoundsAndSetScreenAddresses</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">check in bounds (and if so calculate</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">screen addresses)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">recall X</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">recall flags for A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">postWritePointToScreen</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (not in bounds) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At last, we get to actually draw a point</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writePointToScreen</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d306</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">byte mask for current graphics point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteOR</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">and with graphics colour OR byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">or  with curent graphics cell line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store result</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduGraphicsColourByteEOR</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">same again with colour EOR byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">then store it in current graphics row</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">postWritePointToScreen</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d316</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermLow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineAbsNonDominantAxisDeltaLow</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermLow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} error_term = error_term -</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} non-dominant axis delta</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermHigh</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineAbsNonDominantAxisDeltaHigh</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (error_term &gt;= 0, i.e. error</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">still ok) then branch (forwards)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermLow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineAbsDominantAxisDeltaLow</span></a><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermLow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} error_term = error_term + dominant</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} axis delta</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineAbsDominantAxisDeltaHigh</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermHigh</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store flags (carry clear if we will</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">move in both axes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP23" class="function-link"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">if (error term still ok) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(indirectly</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> to .plotLineMoveToNextColumnRight</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> or .plotLineMoveToNextRowUp</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> which moves along the dominant axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> right or up one pixel)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineRoutineLow</span></a><span class="ACME-plain-syntax">)                        </span><span class="ACME-comment-syntax">jump to one of the next four line</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">routines below, which move the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">sub-dominant axis one pixel in the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">appropriate direction, and then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">updates in the dominant axis: move</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">up or right one pixel.</span>
</pre>
<p class="commentary firstcommentary"><a id="SP23" class="paragraph-anchor"></a><b>&#167;23. Move up one pixel (in the non-dominant axis). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is moving in the non-dominant axis. Then jump to update the dominant axis.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineDominantXAxisSameSign</span><button class="popup" onclick="togglePopup('usagePopup32')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup32">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineDominantXAxisSameSign</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1 (moving one row up the screen)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP23" class="function-link"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">if (still in same character cell)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP30" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressUpOneCharacterCell</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">call subroutine to advance cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">address to the next cell up</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span><button class="popup" onclick="togglePopup('usagePopup33')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup33">Usage of <span class="code-font"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a>, <a href="S-s8.html#SP24">&#167;24</a>, <a href="S-s8.html#SP25">&#167;25</a>, <a href="S-s8.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d348</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">)                             </span><span class="ACME-comment-syntax">jump to update dominant axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">moving up or right one pixel</span>
</pre>
<p class="commentary firstcommentary"><a id="SP24" class="paragraph-anchor"></a><b>&#167;24. Move down one pixel (in the non-dominant axis). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is moving in the non-dominant axis. Then jump to update the dominant axis.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineDominantXAxisDifferentSign</span><button class="popup" onclick="togglePopup('usagePopup34')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup34">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineDominantXAxisDifferentSign</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax">                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+1 (moving down one row in the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character cell)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP23" class="function-link"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">} if (still in the same character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} cell) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">} add a row onto the graphic cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (result +ve) then branch (we are</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">within screen RAM)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">we are above screen RAM</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">subtract screen memory size high</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">store it (this wraps around point to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">screen RAM)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">)                             </span><span class="ACME-comment-syntax">jump to update dominant axis</span>
</pre>
<p class="commentary firstcommentary"><a id="SP25" class="paragraph-anchor"></a><b>&#167;25. Move right one pixel (in the non-dominant axis). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is moving in the non-dominant axis. Then jump to update the dominant axis.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineDominantYAxisSameSign</span><button class="popup" onclick="togglePopup('usagePopup35')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup35">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineDominantYAxisSameSign</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d36a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">shift byte mask right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP23" class="function-link"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (still in the same byte) then</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP31" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheRightAndUpdateMask</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">update address and mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">)                                 </span><span class="ACME-comment-syntax">jump to update dominant axis</span>
</pre>
<p class="commentary firstcommentary"><a id="SP26" class="paragraph-anchor"></a><b>&#167;26. Move left one pixel (in the non-dominant axis). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is moving in the non-dominant axis. Then jump to update the dominant axis.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineDominantYAxisDifferentSign</span><button class="popup" onclick="togglePopup('usagePopup36')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup36">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineDominantYAxisDifferentSign</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d374</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">shift byte mask left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP23" class="function-link"><span class="ACME-function-syntax">jumpVectorMoveOnePixelInDominantAxis</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (still in the same byte) then</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP32" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheLeftAndUpdateMask</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">move graphics cursor address</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">left and update mask value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">)                                 </span><span class="ACME-comment-syntax">jump to update dominant axis</span>
</pre>
<p class="commentary firstcommentary"><a id="SP27" class="paragraph-anchor"></a><b>&#167;27. Move up one pixel (in the dominant axis). </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineMoveToNextRowUp</span><button class="popup" onclick="togglePopup('usagePopup37')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup37">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineMoveToNextRowUp</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d37e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement row within character cell</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineCheckForTermination</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (still in cell) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP30" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressUpOneCharacterCell</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">move up one cell</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineCheckForTermination</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP28" class="paragraph-anchor"></a><b>&#167;28. Move right one pixel (in the dominant axis). </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineMoveToNextColumnRight</span><button class="popup" onclick="togglePopup('usagePopup38')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup38">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineMoveToNextColumnRight</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP15">&#167;15</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d386</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">shift byte mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineCheckForTermination</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">if (still in the same byte)</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP31" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheRightAndUpdateMask</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">update address and mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP29" class="paragraph-anchor"></a><b>&#167;29. plotLineCheckForTermination. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineCheckForTermination</span><button class="popup" onclick="togglePopup('usagePopup39')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup39">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineCheckForTermination</span></span>:<br/><a href="S-s8.html#SP27">&#167;27</a>, <a href="S-s8.html#SP28">&#167;28</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d38d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags (carry clear if we moved</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">in both axes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X (also in .vduTempStoreDC) holds the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">low byte of the loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X &gt; 0) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDD holds the high byte</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">of the loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineFinished</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (loop counter is zero) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (finished)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">top bit set if dotted line,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 6 set if out of bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineContinuesOutOfBounds</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">if (out of bounds) then branch (line</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is not on screen yet)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineLoopLocal</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (only moved in dominant axis)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (keep going)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">set to one only if it's the last</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pixel at the graphics window edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP29" class="function-link"><span class="ACME-function-syntax">plotLineLoopLocal</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (not at edge of window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (keep going)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineFinished</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d39f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineContinuesOutOfBounds</span><button class="popup" onclick="togglePopup('usagePopup40')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup40">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineContinuesOutOfBounds</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d3a0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">increment the actual pixel coordinate along then loop back</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A=.vduTempStoreDE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">Remember X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">clear all but bit 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=2 if X axis is dominant; 0</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">otherwise</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">++</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">if (moved in dominant axis only)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">check bit 7 of .vduTempStoreDE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (signs of dx,dy differ) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (decrement value)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">++</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">} Increment</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointX (Y axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}        or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointY (X axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">++</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">} ALWAYs branch</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">} Decrement</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointX (Y axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}        or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointY (X axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">++</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">} invert bit 2 of X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} X=0 if X axis dominant; 2 if Y</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} axis dominant</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} increment</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointX (X axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}        or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointY (Y axis</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} dominant)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">Restore X</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineLoopLocal</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d3d0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP22" class="function-link"><span class="ACME-function-syntax">plotLineLoop</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">jump back to continue plotting the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">line</span>

</pre>
<p class="commentary firstcommentary"><a id="SP30" class="paragraph-anchor"></a><b>&#167;30. moveGraphicsCursorAddressUpOneCharacterCell. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorAddressUpOneCharacterCell</span><button class="popup" onclick="togglePopup('usagePopup41')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup41">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorAddressUpOneCharacterCell</span></span>:<br/><a href="S-s8.html#SP23">&#167;23</a>, <a href="S-s8.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d3d3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">} subtract number of bytes per line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">} from address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduStartScreenAddressHighByte</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">compare with bottom of screen memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (inside screen RAM) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">add screen memory size to wrap it</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">around</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">store in current address of graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cell top line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">Y=7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP31" class="paragraph-anchor"></a><b>&#167;31. Update the mask value, and move graphics cursor address on to next cell to the right. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Carry always SET</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheRightAndUpdateMask</span><button class="popup" onclick="togglePopup('usagePopup42')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup42">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheRightAndUpdateMask</span></span>:<br/><a href="S-s8.html#SP25">&#167;25</a>, <a href="S-s8.html#SP28">&#167;28</a>, <a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d3ed</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduColourMaskLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">get current left colour mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">} get current graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">} address and add 8 to move to</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} next cell to the right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP32" class="paragraph-anchor"></a><b>&#167;32. Update the mask value, and move graphics cursor address on to previous cell to the left. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Carry always SET</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheLeftAndUpdateMask</span><button class="popup" onclick="togglePopup('usagePopup43')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup43">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheLeftAndUpdateMask</span></span>:<br/><a href="S-s8.html#SP26">&#167;26</a>, <a href="S-s8.html#SP48">&#167;48</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d3fd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduColourMaskRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get right colour mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">A=top line graphics cell low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">decrement high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">subtract 8 (carry is always SET)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">and store in low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP33" class="paragraph-anchor"></a><b>&#167;33. Initialise delta values to (current cursor - params position). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Called at the start of the line drawing, this function takes the current graphics cursor</span>
<span class="ACME-plain-syntax"> position, subtracts the desired graphics cursor position (two 16 bit values on the VDU</span>
<span class="ACME-plain-syntax"> queue), and stores the result in workspace A/B/C/D.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineInitialiseDeltaValues</span><button class="popup" onclick="togglePopup('usagePopup44')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup44">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineInitialiseDeltaValues</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d40d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">destination: .vduPlotLineDeltaX/Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">source: four parameters on the VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">queue</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and the graphics cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP34" class="paragraph-anchor"></a><b>&#167;34. Coordinate subtraction. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source offset into vdu variables      (we read offsets 0-7)</span>
<span class="ACME-plain-syntax">       Y = destination offset into vdu variables (we write offsets 0-3)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">   Stores 16 bit width and height based on the difference of four</span>
<span class="ACME-plain-syntax">   16 bit source coordinates (left, bottom, right, top)</span>
<span class="ACME-plain-syntax">       width  = right - left</span>
<span class="ACME-plain-syntax">       height = top - bottom</span>
<span class="ACME-plain-syntax">   i.e.</span>
<span class="ACME-plain-syntax">       let src  = .vduVariablesStart + X</span>
<span class="ACME-plain-syntax">       let dest = .vduVariablesStart + Y</span>
<span class="ACME-plain-syntax">       dest[0,1] = src[4,5] - src[0,1] = width</span>
<span class="ACME-plain-syntax">       dest[2,3] = src[6,7] - src[2,3] = height</span>

<span class="ACME-plain-syntax">   A = height (high byte)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">coordinateSubtraction</span><button class="popup" onclick="togglePopup('usagePopup45')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup45">Usage of <span class="code-font"><span class="ACME-function-syntax">coordinateSubtraction</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a>, <a href="S-s8.html#SP64">&#167;64</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP61">&#167;61</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d411</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">first calculate width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} add 2 to X and Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} i.e. move offsets on for Y values</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">finally calculate height</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">subtract coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">0</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">0</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP35" class="paragraph-anchor"></a><b>&#167;35. Initialise line drawing variables. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Swaps the delta coordinates to make the non-dominant axis first. Stores absolute values of</span>
<span class="ACME-plain-syntax"> the deltas in .vduPlotLineAbsNonDominantAxisDeltaLow/High</span>
<span class="ACME-plain-syntax">        and in .vduPlotLineAbsDominantAxisDeltaLow/High</span>
<span class="ACME-plain-syntax"> Initialises the loop counter (-ve of the number of pixels to draw along the dominant axis)</span>
<span class="ACME-plain-syntax"> Initialises the error term.</span>

<span class="ACME-plain-syntax"> In steps:</span>
<span class="ACME-plain-syntax">   1. Make sure the dominant axis is stored second, by swapping coordinates if needed.</span>
<span class="ACME-plain-syntax">   2. Both coordinates are then made positive and stored in:</span>
<span class="ACME-plain-syntax">           .vduPlotLineAbsNonDominantAxisDeltaLow/High</span>
<span class="ACME-plain-syntax">           .vduPlotLineAbsDominantAxisDeltaLow/High</span>
<span class="ACME-plain-syntax">   3. .vduTempStoreDC/DD stores the negative of the number of steps to take along the dominant axis.</span>
<span class="ACME-plain-syntax">   4. .vduPlotLineErrorTermLow/High stores half .vduPlotLineAbsDominantAxisDelta. This is the error variable.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       The original signed (dX, dY) delta values are stored at:</span>
<span class="ACME-plain-syntax">           (.vduPlotLineDeltaXLow/High, .vduPlotLineDeltaYLow/High)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .vduPlotLineAbsNonDominantAxisDeltaLow/High initialised</span>
<span class="ACME-plain-syntax">       .vduPlotLineAbsDominantAxisDeltaLow/High initialised</span>
<span class="ACME-plain-syntax">       .vduPlotLineErrorTermLow/High initialised</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotLineInitializeVariables</span><button class="popup" onclick="togglePopup('usagePopup46')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup46">Usage of <span class="code-font"><span class="ACME-function-syntax">plotLineInitializeVariables</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d42c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get the dominant axis (0 or 2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y axis is dominant) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">X is workspace A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaYLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">Y is workspace C</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP10" class="function-link"><span class="ACME-function-syntax">exchangeTwoVDUBytes</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">exchange the X and Y variables.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">So the dominant axis is now the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">first coordinate.</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineDeltaXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">source: .workspaceABCD (the start</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineAbsNonDominantAxisDeltaLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">destination: absolute</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">deltas in X and Y with the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">non-dominant axis first</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">copy four bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get the dominant axis (0 or 2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineTerminationValueLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">}     AY =</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineTerminationValue -</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .vduPlotLineCurrentPointX or Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} ie. AY = finalPoint - start point</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} (in dominant axis)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineTerminationValueHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineCurrentPointXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (startPoint &gt; finalPoint) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP45" class="function-link"><span class="ACME-function-syntax">negateAY</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">negate value stored in A and Y</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store high byte of negative value</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> } this is the -ve of the number of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">steps we</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store low byte of negative value</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> } need to take when plotting the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">line.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineErrorTermLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span>

<span class="ACME-comment-syntax">fall through to do:</span>
<span class="ACME-comment-syntax">  .vduPlotLineAbsDominantAxisDelta    = ABS(.vduPlotLineAbsDominantAxisDelta)</span>
<span class="ACME-comment-syntax">  .vduPlotLineAbsNonDominantAxisDelta = ABS(.vduPlotLineAbsNonDominantAxisDelta)</span>
<span class="ACME-comment-syntax">  .vduPlotLineErrorTerm               = .vduPlotLineAbsDominantAxisDelta / 2</span>

<span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP36" class="paragraph-anchor"></a><b>&#167;36. Line Initialisation. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is used in both line drawing and triangle filling to initialise the variables needed</span>
<span class="ACME-plain-syntax"> to track along the edge. Sets the deltas to absolute values, and initialises an error</span>
<span class="ACME-plain-syntax"> term to half the absolute delta in Y.</span>

<span class="ACME-plain-syntax">   Let src  = .vduVariablesStart + X</span>
<span class="ACME-plain-syntax">   src[4,5] = ABS(src[4,5])</span>
<span class="ACME-plain-syntax">   src[2,3] = ABS(src[2,3])</span>
<span class="ACME-plain-syntax">   src[0,1] = src[4,5] / 2</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       AY = absolute value of src[2,3]</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lineInitialisation</span><button class="popup" onclick="togglePopup('usagePopup47')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup47">Usage of <span class="code-font"><span class="ACME-function-syntax">lineInitialisation</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a>, <a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d459</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP37" class="function-link"><span class="ACME-function-syntax">absoluteValue</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">make src[4,5] positive</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} src[0,1] = src[4,5] / 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">point to src[0,1]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">and fall through to make src[2,3]</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">positive</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP37" class="paragraph-anchor"></a><b>&#167;37. Absolute value. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Make sure that the 16 bit coordinate at (vduVariablesStart + 4 + X)</span>
<span class="ACME-plain-syntax"> is not negative, by negating it if necessary.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X is offset to vdu variable i.e.:</span>
<span class="ACME-plain-syntax">       (vduVariablesStart + 4 + X) has the low byte of the coordinate</span>
<span class="ACME-plain-syntax">       (vduVariablesStart + 5 + X) has the high byte of the coordinate</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       A is the high byte of the result (also stored in .vduVariablesStart + 5 + X)</span>
<span class="ACME-plain-syntax">       Y is the low byte of the result  (also stored in .vduVariablesStart + 4 + X)</span>
<span class="ACME-plain-syntax">       X is preserved</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">absoluteValue</span><button class="popup" onclick="togglePopup('usagePopup48')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup48">Usage of <span class="code-font"><span class="ACME-function-syntax">absoluteValue</span></span>:<br/><a href="S-s8.html#SP36">&#167;36</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d467</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (A is +ve) then branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP45" class="function-link"><span class="ACME-function-syntax">negateAY</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">negate AY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">store back again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP38" class="paragraph-anchor"></a><b>&#167;38. Copy eight bytes (four coordinates) of VDU variables. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>
<span class="ACME-plain-syntax">       Y = destination (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span><button class="popup" onclick="togglePopup('usagePopup49')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup49">Usage of <span class="code-font"><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP41">&#167;41</a>, <a href="S-s5.html#SP61">&#167;61</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d47c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">A = 8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP44" class="function-link"><span class="ACME-function-syntax">copyABytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">ALWAYS branch - copy 8 bytes</span>
</pre>
<p class="commentary firstcommentary"><a id="SP39" class="paragraph-anchor"></a><b>&#167;39. copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue</span><button class="popup" onclick="togglePopup('usagePopup50')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup50">Usage of <span class="code-font"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariablesToPlotLineTerminationValue</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d480</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotLineTerminationValueLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">Y = destination offset from</span>
<span class="ACME-plain-syntax">                                                              </span><span class="ACME-comment-syntax">.vduVariablesStart</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP40" class="paragraph-anchor"></a><b>&#167;40. Copy two bytes (one coordinate) of VDU variables. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>
<span class="ACME-plain-syntax">       Y = destination (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span><button class="popup" onclick="togglePopup('usagePopup51')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup51">Usage of <span class="code-font"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></span>:<br/><a href="S-s8.html#SP65">&#167;65</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP22">&#167;22</a>, <a href="S-s7.html#SP23">&#167;23</a>, <a href="S-s7.html#SP24">&#167;24</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d482</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">A = 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP44" class="function-link"><span class="ACME-function-syntax">copyABytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">ALWAYS branch - copy 2 bytes</span>
</pre>
<p class="commentary firstcommentary"><a id="SP41" class="paragraph-anchor"></a><b>&#167;41. copyGraphicsCursorPixelPositionToWorkspaceABCD. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyGraphicsCursorPixelPositionToWorkspaceABCD</span><button class="popup" onclick="togglePopup('usagePopup52')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup52">Usage of <span class="code-font"><span class="ACME-function-syntax">copyGraphicsCursorPixelPositionToWorkspaceABCD</span></span>:<br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d486</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">destination = offset to workspaceA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP42" class="paragraph-anchor"></a><b>&#167;42. copyGraphicsCursorPixelPosition. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Y = destination (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyGraphicsCursorPixelPosition</span><button class="popup" onclick="togglePopup('usagePopup53')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup53">Usage of <span class="code-font"><span class="ACME-function-syntax">copyGraphicsCursorPixelPosition</span></span>:<br/><a href="S-s8.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d488</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">source = offset to graphics</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP43" class="paragraph-anchor"></a><b>&#167;43. Copy four bytes (e.g. </b>one pair of coordinates) of VDU variables.
</p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>
<span class="ACME-plain-syntax">       Y = destination (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span><button class="popup" onclick="togglePopup('usagePopup54')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup54">Usage of <span class="code-font"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></span>:<br/><a href="S-s8.html#SP11">&#167;11</a>, <a href="S-s8.html#SP22">&#167;22</a>, <a href="S-s8.html#SP35">&#167;35</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP64">&#167;64</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP22">&#167;22</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d48a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">number of bytes to copy</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP44" class="paragraph-anchor"></a><b>&#167;44. Copy a number of bytes in VDU variables. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = number of bytes to copy</span>
<span class="ACME-plain-syntax">       X = source (offset from .vduVariablesStart)</span>
<span class="ACME-plain-syntax">       Y = destination (offset from .vduVariablesStart)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyABytesWithinVDUVariables</span><button class="popup" onclick="togglePopup('usagePopup55')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup55">Usage of <span class="code-font"><span class="ACME-function-syntax">copyABytesWithinVDUVariables</span></span>:<br/><a href="S-s8.html#SP38">&#167;38</a>, <a href="S-s8.html#SP40">&#167;40</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d48c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store A as a loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">load value from source address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">store value in destination address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">move index forwards</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">move index forwards</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">loop back until done</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP45" class="paragraph-anchor"></a><b>&#167;45. Negate the sixteen bit value in A and Y. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = high byte</span>
<span class="ACME-plain-syntax">       Y = low byte</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       A = high byte of negated value</span>
<span class="ACME-plain-syntax">       Y = low byte of negated value</span>
<span class="ACME-plain-syntax">       Preserves X</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">negateAY</span><button class="popup" onclick="togglePopup('usagePopup56')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup56">Usage of <span class="code-font"><span class="ACME-function-syntax">negateAY</span></span>:<br/><a href="S-s8.html#SP22">&#167;22</a>, <a href="S-s8.html#SP35">&#167;35</a>, <a href="S-s8.html#SP37">&#167;37</a>, <a href="S-s8.html#SP57">&#167;57</a>, <a href="S-s8.html#SP58">&#167;58</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d49b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=255 - Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=255 - A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+1 (effectively making Y = 256 -</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">initialY)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y != 0) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">A+=1</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP46" class="paragraph-anchor"></a><b>&#167;46. checkPixelIsBackgroundColour. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkPixelIsBackgroundColour</span><button class="popup" onclick="togglePopup('usagePopup57')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup57">Usage of <span class="code-font"><span class="ACME-function-syntax">checkPixelIsBackgroundColour</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a>, <a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4aa</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP5" class="function-link"><span class="ACME-function-syntax">checkParameterInBoundsAndSetScreenAddresses</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check window boundaries and set up</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">screen addresses</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP47" class="function-link"><span class="ACME-function-syntax">outsideBoundaries</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (outside) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">get byte from current graphics cell</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">compare with current background</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP47" class="paragraph-anchor"></a><b>&#167;47. outsideBoundaries. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">outsideBoundaries</span><button class="popup" onclick="togglePopup('usagePopup58')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup58">Usage of <span class="code-font"><span class="ACME-function-syntax">outsideBoundaries</span></span>:<br/><a href="S-s8.html#SP46">&#167;46</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4b7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remove one return address from the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">stack to early out of the lateral</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">fill</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">increment current graphics cursor y</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pixel position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP51" class="function-link"><span class="ACME-function-syntax">setNextPixelPosition</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">exit having pushed the cursor up one</span>
</pre>
<p class="commentary firstcommentary"><a id="SP48" class="paragraph-anchor"></a><b>&#167;48. Lateral fill left and right. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Fill to the left and right of the current parameter coordinate until a non-background</span>
<span class="ACME-plain-syntax"> colour is found. Fills in the foreground colour using the current GCOL mask settings.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftRight</span><button class="popup" onclick="togglePopup('usagePopup59')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup59">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillLeftRight</span></span>:<br/><a href="S-s8.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4bf</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP46" class="function-link"><span class="ACME-function-syntax">checkPixelIsBackgroundColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">check pixel is background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">check just the bits for the current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pixel</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (non-background pixel found) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fill left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X=0 (check width in pixels to the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">left)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP57" class="function-link"><span class="ACME-function-syntax">lateralFillGetWidthToWindowEdge</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">Find distance to edge of window:</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">On exit, X and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduTempStoreDB=negated</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">distance to edge of window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillLeftDone</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (zero width) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">Y = row within character cell</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">shift mask for next pixel left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP48" class="function-link"><span class="ACME-function-syntax">lateralFillLeftLoop</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (next character cell left</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">reached) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP55" class="function-link"><span class="ACME-function-syntax">lateralFillLeftPartialByte</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">fill the partial first byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillLeftDone</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (finished) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4d9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP32" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheLeftAndUpdateMask</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">move cursor left and reset mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">get byte from screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">EOR with background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and store</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillLeftNearlyDone</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (not background colour) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">found byte with background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X=negated distance to edge of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">add pixels/byte (including carry)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry clear) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">increment high byte of distance to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">left edge of window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillLeftNearlyDone</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (reached edge of window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A=negated distance to edge of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window (low byte)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">plot a byte in the foreground colour using GCOL options</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP14" class="function-link"><span class="ACME-function-syntax">plotByte</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">plot a byte</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">loop back</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP48" class="function-link"><span class="ACME-function-syntax">lateralFillLeftLoop</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">ALWAYS branch (loop back)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP49" class="paragraph-anchor"></a><b>&#167;49. lateralFillLeftNearlyDone. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftNearlyDone</span><button class="popup" onclick="togglePopup('usagePopup60')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup60">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillLeftNearlyDone</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4f7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP55" class="function-link"><span class="ACME-function-syntax">lateralFillLeftPartialByte</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">fill the final pixels in the last</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(leftmost byte) of the row</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftDone</span><button class="popup" onclick="togglePopup('usagePopup61')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup61">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillLeftDone</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d4fa</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP58" class="function-link"><span class="ACME-function-syntax">lateralFillSetParamAtGivenDistanceFromEdge</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">Restore original position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">   }</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">} swap parameter with graphics</span>
<span class="ACME-plain-syntax">                                                           </span><span class="ACME-comment-syntax">} cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP12" class="function-link"><span class="ACME-function-syntax">exchangeFourBytes</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">   }</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fill right</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRight</span><button class="popup" onclick="togglePopup('usagePopup62')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup62">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRight</span></span>:<br/><a href="S-s8.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d506</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP46" class="function-link"><span class="ACME-function-syntax">checkPixelIsBackgroundColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">check screen pixel</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">X=4 (right hand edge of graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP57" class="function-link"><span class="ACME-function-syntax">lateralFillGetWidthToWindowEdge</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get distance to right hand edge of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} subtract one from distance to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} right edge</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightFirstByteLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d514</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP52" class="function-link"><span class="ACME-function-syntax">lateralFillRightPartialByte</span></a><span class="ACME-plain-syntax">                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP50" class="function-link"><span class="ACME-function-syntax">lateralFillRightDone</span></a><span class="ACME-plain-syntax">                           </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d519</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP31" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorAddressTotheRightAndUpdateMask</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">get byte from graphics line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">EOR with background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillRightFirstByteLoop</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (A is not zero) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A=.vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP50" class="function-link"><span class="ACME-function-syntax">lateralFillRightNearlyDone</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">if (A is not zero) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">found byte with background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} (X, .vduTempStoreDB) +=</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} pixels per byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP50" class="function-link"><span class="ACME-function-syntax">lateralFillRightNearlyDone</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">plot a byte in the foreground colour using GCOL options</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP14" class="function-link"><span class="ACME-function-syntax">plotByte</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">plot a byte</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP49" class="function-link"><span class="ACME-function-syntax">lateralFillRightLoop</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">ALWAYS branch (loop back)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP50" class="paragraph-anchor"></a><b>&#167;50. lateralFillRightNearlyDone. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightNearlyDone</span><button class="popup" onclick="togglePopup('usagePopup63')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup63">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRightNearlyDone</span></span>:<br/><a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d53d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP52" class="function-link"><span class="ACME-function-syntax">lateralFillRightPartialByte</span></a><span class="ACME-plain-syntax">                    </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightDone</span><button class="popup" onclick="togglePopup('usagePopup64')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup64">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRightDone</span></span>:<br/><a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d540</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP58" class="function-link"><span class="ACME-function-syntax">lateralFillSetParamAtGivenDistanceFromEdge</span></a><span class="ACME-plain-syntax">     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP51" class="paragraph-anchor"></a><b>&#167;51. setNextPixelPosition. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setNextPixelPosition</span><button class="popup" onclick="togglePopup('usagePopup65')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup65">Usage of <span class="code-font"><span class="ACME-function-syntax">setNextPixelPosition</span></span>:<br/><a href="S-s8.html#SP47">&#167;47</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d545</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP9" class="function-link"><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">set graphics cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">scale positions</span>
</pre>
<p class="commentary firstcommentary"><a id="SP52" class="paragraph-anchor"></a><b>&#167;52. lateralFillRightPartialByte. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightPartialByte</span><button class="popup" onclick="togglePopup('usagePopup66')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup66">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRightPartialByte</span></span>:<br/><a href="S-s8.html#SP49">&#167;49</a>, <a href="S-s8.html#SP50">&#167;50</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d54b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get byte mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillRightGetMask</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP53" class="paragraph-anchor"></a><b>&#167;53. lateralFillRightGetMaskLoop. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightGetMaskLoop</span><button class="popup" onclick="togglePopup('usagePopup67')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup67">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRightGetMaskLoop</span></span>:<br/><a href="S-s8.html#SP54">&#167;54</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d551</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (+ve) then branch</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">shift mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (carry set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">OR with mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save result</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP54" class="paragraph-anchor"></a><b>&#167;54. lateralFillRightGetMask. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillRightGetMask</span><button class="popup" onclick="togglePopup('usagePopup68')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup68">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillRightGetMask</span></span>:<br/><a href="S-s8.html#SP52">&#167;52</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d560</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">A=.vduCurrentPlotByteMask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">test bits of .vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} flags = flags EOR .vduTempStoreDC</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP53" class="function-link"><span class="ACME-function-syntax">lateralFillRightGetMaskLoop</span></a><span class="ACME-plain-syntax">                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">A=A EOR .vduCurrentPlotByteMask</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(byte mask)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span><button class="popup" onclick="togglePopup('usagePopup69')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup69">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></span>:<br/><a href="S-s8.html#SP53">&#167;53</a>, <a href="S-s8.html#SP56">&#167;56</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d56f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPointWithinBounds</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">and display a pixel</span>
</pre>
<p class="commentary firstcommentary"><a id="SP55" class="paragraph-anchor"></a><b>&#167;55. lateralFillLeftPartialByte. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftPartialByte</span><button class="popup" onclick="togglePopup('usagePopup70')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup70">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillLeftPartialByte</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a>, <a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d574</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP56" class="function-link"><span class="ACME-function-syntax">lateralFillLeftGetMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP56" class="paragraph-anchor"></a><b>&#167;56. lateralFillLeftGetMaskLoop. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftGetMaskLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d579</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X is not zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">inc .vduTempStoreDB</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (+ve) then branch</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A*2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP56" class="function-link"><span class="ACME-function-syntax">lateralFillLeftGotMaskNowPlotPoint</span></a><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">if (C set) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftGetMask</span><button class="popup" onclick="togglePopup('usagePopup71')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup71">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillLeftGetMask</span></span>:<br/><a href="S-s8.html#SP55">&#167;55</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d583</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">A=A OR (.vduCurrentPlotByteMask)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP56" class="function-link"><span class="ACME-function-syntax">lateralFillLeftGetMaskLoop</span></a><span class="ACME-plain-syntax">                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">A=A EOR .vduCurrentPlotByteMask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (carry clear) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillLeftGotMaskNowPlotPoint</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d58e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A/2 (final step to get mask)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP54" class="function-link"><span class="ACME-function-syntax">lateralFillSaveMaskAndPlotPoint</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP57" class="paragraph-anchor"></a><b>&#167;57. Get width of parameter point to graphics window edge. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = 0 (left edge) or 4 (right edge)</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .vduTempStoreDB is the negation of the width (high byte)</span>
<span class="ACME-plain-syntax">       X = Y =         the negation of the width (low byte)</span>
<span class="ACME-plain-syntax">       A = 0 (and Z=0) if there is zero width</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillGetWidthToWindowEdge</span><button class="popup" onclick="togglePopup('usagePopup72')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup72">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillGetWidthToWindowEdge</span></span>:<br/><a href="S-s8.html#SP48">&#167;48</a>, <a href="S-s8.html#SP49">&#167;49</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d592</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} AY = window left/right - paramX</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXHigh</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP45" class="function-link"><span class="ACME-function-syntax">negateAY</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">} make sure AY is negative</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store A (high coordinate)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = low coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = low coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A = low OR high coordinate (checking</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">for zero width?)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP58" class="paragraph-anchor"></a><b>&#167;58. Set parameter X coordinate to the given distance from the left/right edge of the window. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X, .vduTempStoreDB is negated distance to left/right edge of window</span>
<span class="ACME-plain-syntax">       Y is 0 (left edge of graphics window)</span>
<span class="ACME-plain-syntax">         or 4 (right edge of graphics window)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">lateralFillSetParamAtGivenDistanceFromEdge</span><button class="popup" onclick="togglePopup('usagePopup73')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup73">Usage of <span class="code-font"><span class="ACME-function-syntax">lateralFillSetParamAtGivenDistanceFromEdge</span></span>:<br/><a href="S-s8.html#SP49">&#167;49</a>, <a href="S-s8.html#SP50">&#167;50</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d5ac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">Y=.vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A=.vduTempStoreDB</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (-ve) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">at this point AY = width to add to edge of window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">but if we are looking at the left edge, then negate AY first</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">X=.vduTempStoreDA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X is not zero) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP45" class="function-link"><span class="ACME-function-syntax">negateAY</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">negate</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">} paramX = AY + window left/right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXHigh</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP59" class="paragraph-anchor"></a><b>&#167;59. OSWORD 13 - Read last two graphic cursor positions. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordX/Y is the address of the eight bytes of parameters for the result</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       The eight bytes at .oswordX/Y hold the result:</span>
<span class="ACME-plain-syntax">           byte 0: Previous X (low byte)</span>
<span class="ACME-plain-syntax">           byte 1: Previous X (high byte)</span>
<span class="ACME-plain-syntax">           byte 2: Previous Y (low byte)</span>
<span class="ACME-plain-syntax">           byte 3: Previous Y (high byte)</span>
<span class="ACME-plain-syntax">           byte 4: Current X (low byte)</span>
<span class="ACME-plain-syntax">           byte 5: Current X (high byte)</span>
<span class="ACME-plain-syntax">           byte 6: Current Y (low byte)</span>
<span class="ACME-plain-syntax">           byte 7: Current Y (high byte)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword13EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup74')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup74">Usage of <span class="code-font"><span class="ACME-function-syntax">osword13EntryPoint</span></span>:<br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d5ce</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">A=3 (offset into oswordX block)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">A=7 (offset into oswordX block)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP11" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">exchange old graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position with current</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">convert to external coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">X=3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get graphics coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store it in OS buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement Y and X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (+ve) then branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP60" class="paragraph-anchor"></a><b>&#167;60. Fill triangle. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> A filled triangle is drawn. It is drawn in rows from the bottom of the triangle to the top.</span>

<span class="ACME-plain-syntax"> Here we define the 'main line' as the edge of the triangle from the bottommost vertex</span>
<span class="ACME-plain-syntax"> to the topmost vertex. The other two edges are the lower and upper 'minor lines'.</span>

<span class="ACME-plain-syntax"> The triangle is drawn in two 'halves'. The first 'half' is for the rows of lower minor line,</span>
<span class="ACME-plain-syntax"> and the second 'half' is for the rows of upper minor line. See the diagram below.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .vdu25ParameterLow/High             }</span>
<span class="ACME-plain-syntax">       .vduGraphicsCursorPixels            } three points that define the triangle</span>
<span class="ACME-plain-syntax">       .vduOldGraphicsCursorPixels         }</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotFillTriangle</span><button class="popup" onclick="togglePopup('usagePopup75')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup75">Usage of <span class="code-font"><span class="ACME-function-syntax">plotFillTriangle</span></span>:<br/><a href="S-s8.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d5ea</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">store variables</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">X = source: parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriStorageForCoordinates</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">Y = destination: storage</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP38" class="function-link"><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">remember the parameter position and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the current graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">sort the three points of the triangle into order vertically</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP61" class="function-link"><span class="ACME-function-syntax">sortParameterPointAndOldPosition</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">} sort positions by Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP62" class="function-link"><span class="ACME-function-syntax">sortCoordinatesXY</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">} coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP61" class="function-link"><span class="ACME-function-syntax">sortParameterPointAndOldPosition</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">The three points of the triangle (now sorted from lowest to highest) are:</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                              ##  &lt;-.vduGraphicsCursorPixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                            ###      /|\</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                          ##  #       |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                    upper minor line-&gt;  ##   #        |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                      ##     #        | second 'half' of triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    ##      #         | to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                  ##        #         |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                ##         #         \|/</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">.vduOldGraphicsCursorPixels-&gt;  #           #         /|\</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                #         #           |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                #         #  &lt;-main   |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                 #       #     line   |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                 #       #            |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">              lower minor line-&gt;  #     #             | first 'half' of triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                  #     #             | to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                   #   #              |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                   #   #              |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    # #               |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    # #               |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                     #               \|/</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                     #  &lt;-.vdu25Parameter</span>
<span class="ACME-plain-syntax">    </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">get the dX, dY for the main line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">X = source (parameter and graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">            cursor)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> offset 0,1,2,3 = parameter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> offset 4,5,6,7 = graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineDeltaXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">Y = destination (main line delta)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP34" class="function-link"><span class="ACME-function-syntax">coordinateSubtraction</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">maindelta = (graphics cursor-param)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineXDirectionFlag</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">store high byte of delta X to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">use as a flag when updating our</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">See</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.</span><a href="S-s8.html#SP67" class="internal">fillTriangleUpdateLinePosition</a>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">initialise variables for the main line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineErrorTermLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP36" class="function-link"><span class="ACME-function-syntax">lineInitialisation</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">Initialise variables for the main</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">line. This makes the deltas positive</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and initialises the error term.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">copy .vdu25Parameter to current main edge point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP11" class="function-link"><span class="ACME-function-syntax">copyParameterPointToDestinationY</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">} main edge point =</span>
<span class="ACME-plain-syntax">                                                                  </span><span class="ACME-comment-syntax">} parameter point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">swap graphics cursor points</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP11" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span></a><span class="ACME-plain-syntax">          </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fill the bottom half of the triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP64" class="function-link"><span class="ACME-function-syntax">plotFillTriangleHalf</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">fill bottom 'half' of triangle</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">swap graphics cursor points back</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP11" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span></a><span class="ACME-plain-syntax">          </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">swap parameter point with old graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP11" class="function-link"><span class="ACME-function-syntax">exchangeOldGraphicsCursorPositionWithVariableX</span></a><span class="ACME-plain-syntax"> </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Now our triangle looks like this:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                              ##  &lt;-.vduGraphicsCursorPixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                            ###      /|\</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                          ##  #       |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                    upper minor line-&gt;  ##   #        |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                      ##     #        | second 'half' of triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    ##      #         | to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                  ##        #         |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                ##         #         \|/</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">            .vdu25Parameter-&gt;  #############         /|\</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                ###########           |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                ###########  &lt;-main   |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                 #########     line   |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                 #########            |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">              lower minor line-&gt;  #######             | first 'half' of triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                  #######             | is filled</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                   #####              |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                   #####              |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    ###               |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                    ###               |</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                     #               \|/</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">                                     #  &lt;-.vduOldGraphicsCursorPixels</span>
<span class="ACME-plain-syntax">    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">It is now half filled, and the parameters of the vertices have been swapped ready for</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">filling the second half.</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fill the top half of the triangle</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP64" class="function-link"><span class="ACME-function-syntax">plotFillTriangleHalf</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">fill top 'half' of triangle</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">restore parameter point and graphics cursor variables back to where they started.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriStorageForCoordinates</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">X = source</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">Y = destination</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP38" class="function-link"><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">restore original parameter position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and graphics cursor position</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">move the graphics cursor to the new parameter point, and return</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP9" class="function-link"><span class="ACME-function-syntax">plotMoveGraphicsCursorInAbsolutePixels</span></a><span class="ACME-plain-syntax">         </span>
</pre>
<p class="commentary firstcommentary"><a id="SP61" class="paragraph-anchor"></a><b>&#167;61. Sort the parameter point and the old graphics cursor point, sorting by Y coordinate. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> if (parameter point is higher or level with old graphics cursor) then swap points in place</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sortParameterPointAndOldPosition</span><button class="popup" onclick="togglePopup('usagePopup76')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup76">Usage of <span class="code-font"><span class="ACME-function-syntax">sortParameterPointAndOldPosition</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d632</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">} Sort paramX and old</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">} graphics position X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP62" class="paragraph-anchor"></a><b>&#167;62. Sort one point with another, sorting by Y coordinate. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> given two pairs of coordinates (one indexed by register X the other by register Y), sort</span>
<span class="ACME-plain-syntax"> them by their Y coordinates (lowest first)</span>

<span class="ACME-plain-syntax"> if (point X is higher or level with point Y) then swap points in place</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">sortCoordinatesXY</span><button class="popup" onclick="togglePopup('usagePopup77')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup77">Usage of <span class="code-font"><span class="ACME-function-syntax">sortCoordinatesXY</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d636</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">Y coordinate low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">Y coordinate low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">Y coordinate high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">Y coordinate high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP63" class="function-link"><span class="ACME-function-syntax">exit10</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (Y coordinates of variable</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">indexed by Y &gt; Y coordinate of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">variable indexed by X) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP12" class="function-link"><span class="ACME-function-syntax">exchangeFourBytes</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">swap coordinates</span>
</pre>
<p class="commentary firstcommentary"><a id="SP63" class="paragraph-anchor"></a><b>&#167;63. OSBYTE 134 - Read text cursor position. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte134EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup78')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup78">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte134EntryPoint</span></span>:<br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d647</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">read current text cursor X position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">} subtract text window left position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = text cursor X - text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get current text cursor Y position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">} subtract text window top position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = text cursor Y - text window top</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit10</span><button class="popup" onclick="togglePopup('usagePopup79')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup79">Usage of <span class="code-font"><span class="ACME-function-syntax">exit10</span></span>:<br/><a href="S-s8.html#SP62">&#167;62</a>, <a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d657</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP64" class="paragraph-anchor"></a><b>&#167;64. Fill half a triangle. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Draws rows of a triangle from bottom to top following the main line and the minor line</span>
<span class="ACME-plain-syntax"> as edges, until we reach the top of the minor line. See .</span><a href="S-s8.html#SP60" class="internal">plotFillTriangle</a><span class="ACME-plain-syntax">. The minor line</span>
<span class="ACME-plain-syntax"> starts at the parameter point and moves up the screen to the current graphics point.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Carry clear = first half of triangle is being drawn</span>
<span class="ACME-plain-syntax">       Carry set = second half of triangle is being drawn</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotFillTriangleHalf</span><button class="popup" onclick="togglePopup('usagePopup80')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup80">Usage of <span class="code-font"><span class="ACME-function-syntax">plotFillTriangleHalf</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d658</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store flags</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">find the dX, dY for the minor line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">X = src (offset 4=graphics</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">cursor)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineDeltaXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">Y = destination (minor delta)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP34" class="function-link"><span class="ACME-function-syntax">coordinateSubtraction</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">minor delta = graphics cursor - param</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">Get and store the sign of the delta in X, so we know which way to update in X later.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">See .</span><a href="S-s8.html#SP67" class="internal">fillTriangleUpdateLinePosition</a><span class="ACME-comment-syntax">.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineDeltaXHigh</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get high byte of deltaX</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineXDirectionFlag</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">store as flag</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">initialise the minor line variables:</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">      .vduPlotTriMinorLineDeltaX = ABS(.vduPlotTriMinorLineDeltaX)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">      .vduPlotTriMinorLineDeltaY = ABS(.vduPlotTriMinorLineDeltaY)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">      .vduPlotTriMinorLineErrorTerm = .vduPlotTriMinorLineDeltaY / 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineErrorTermLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP36" class="function-link"><span class="ACME-function-syntax">lineInitialisation</span></a>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">initialise current point on the minor line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP11" class="function-link"><span class="ACME-function-syntax">copyParameterPointToDestinationY</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">current minor line point = parameter</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">calculate triangle fill 'height' = parameter point Y - graphics cursor height</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">this is actually the negative of the height to fill, which we use as a loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterYLow</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTriangleFillHeightLow</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25ParameterYHigh</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">} height = paramY - cursorY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTriangleFillHeightHigh</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTriangleFillHeightLow</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">check number of rows to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (no rows to draw) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(finish up)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">loop to fill each row (.vduTriangleFillHeight is the loop counter, counting up)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotFillTriangleHalfLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d688</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP64" class="function-link"><span class="ACME-function-syntax">fillRowLeftToRightBetweenMainAndMinorLines</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">fill one row</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">update the minor line position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineErrorTermLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">fillTriangleUpdateLinePosition</span></a><span class="ACME-plain-syntax">                         </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">update the main line position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineErrorTermLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">fillTriangleUpdateLinePosition</span></a><span class="ACME-plain-syntax">                         </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">increment the loop counter until we hit zero</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTriangleFillHeightLow</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">update loop counter (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP64" class="function-link"><span class="ACME-function-syntax">plotFillTriangleHalfLoop</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">if (counter not done yet) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (loop back and do it again)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTriangleFillHeightHigh</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">increment loop counter (high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP64" class="function-link"><span class="ACME-function-syntax">plotFillTriangleHalfLoop</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">if (counter not done yet) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (loop back and do it again)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">finish up</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP63" class="function-link"><span class="ACME-function-syntax">exit10</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (carry clear) then branch (exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">At this point carry is set (we are drawing the top half of the triangle). We draw the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">final row at top of the triangle...</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillRowLeftToRightBetweenMainAndMinorLines</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d6a2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMinorLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPlotTriMainLineCurrentPointXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP65" class="paragraph-anchor"></a><b>&#167;65. Fill a single horizontal row. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Used as part of clearing the graphics window or filling a triangle.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = offset into VDU variables for one extreme graphics pixel X coordinate</span>
<span class="ACME-plain-syntax">       Y = offset into VDU variables for the other extreme graphics pixel X coordinate</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillRow</span><button class="popup" onclick="togglePopup('usagePopup81')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup81">Usage of <span class="code-font"><span class="ACME-function-syntax">fillRow</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP41">&#167;41</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d6a6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">} if (leftmost &lt;= rightmost) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} swap X and Y so (leftmost &lt;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} rightmost)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDF=offset to leftmost</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push graphics window left edge</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">check leftmost coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">check window bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (within bounds) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">out of bounds. Work out what to do.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP65" class="function-link"><span class="ACME-function-syntax">donePlottingPoints</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">} if (reason for being out of bounds</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} is not just that it's too far</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} right) then branch (finish up)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">out of bounds (point is right of the right hand edge of the graphics window)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsRightLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">source = right edge of</span>
<span class="ACME-plain-syntax">                                                               </span><span class="ACME-comment-syntax">graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">destination = leftmost pixel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP40" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">copy coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">X = offset to leftmost pixel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP6" class="function-link"><span class="ACME-function-syntax">setScreenAddress</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">set a screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">X=offset to rightmost pixel X</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkPointXIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">check window bounds</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = reason for being offscreen / 2</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(checks for offscreen to the right /</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">up / down)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP65" class="function-link"><span class="ACME-function-syntax">donePlottingPoints</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (point is offscreen to the right,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">up or down) then branch (finish up)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not outside bounds to the left</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">of the graphics window) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">out of bounds (point is left of the graphics window left edge)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">outside the left edge,</span>
<span class="ACME-plain-syntax">                                                               </span><span class="ACME-comment-syntax">leftmost = left edge instead.</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">Y = offset to leftmost pixel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} tempStoreDC/DD = width of row to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} fill (rightmost - leftmost)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">First calculate leftmost byte to write</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">shift current mask left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">OR in the mask for a pixel</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} get low byte (as decremented by</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} .calculateLeftmostByte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP66" class="function-link"><span class="ACME-function-syntax">calculateLeftmostByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} check to see if we are done yet</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} (check if width = 0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">} decrement high byte if needed</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP66" class="function-link"><span class="ACME-function-syntax">calculateLeftmostByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} if (width &gt; 0, i.e. not done yet)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">we get here if width is now zero, i.e. the leftmost byte is all we needed to draw</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPointWithinBounds</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">display final byte</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">donePlottingPoints</span><button class="popup" onclick="togglePopup('usagePopup82')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup82">Usage of <span class="code-font"><span class="ACME-function-syntax">donePlottingPoints</span></span>:<br/><a href="S-s8.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d70e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">we get here when we are done drawing all the pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">restore X = offset to leftmost</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">restore left edge of graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">restore left edge of graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP66" class="paragraph-anchor"></a><b>&#167;66. Calculate leftmost byte. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">calculateLeftmostByte</span><button class="popup" onclick="togglePopup('usagePopup83')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup83">Usage of <span class="code-font"><span class="ACME-function-syntax">calculateLeftmostByte</span></span>:<br/><a href="S-s8.html#SP65">&#167;65</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d719</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">check the pixel mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">loop back until mask has bit set in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 7</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store the full mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPointWithinBounds</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">display a point (write leftmost byte</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to screen)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} increment width (was decremented</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} one too many times)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">we are going to write a line of completely filled bytes.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">first calculate the number of bytes we need to fill (= width in pixels / pixels per byte)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = X = width low byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Push width (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} divide .vduTempStoreDD (high byte)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} and Accumulator (low byte) by two</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get number of pixels/byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">check for four colour MODEs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (four colour MODE) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(only divide by 2 once more)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP66" class="function-link"><span class="ACME-function-syntax">finishedGettingByteCount</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">if (&gt;four colour mode, i.e. MODE 2)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">two colour mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} divide .vduTempStoreDD (high byte)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} and Accumulator (low byte) by two</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">four colour mode</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} divide .vduTempStoreDD (high byte)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} and Accumulator (low byte) by two</span>


<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">finished getting the number of bytes to fill. At this point the accumulator holds the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">number of filled bytes we need to draw</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishedGettingByteCount</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d73e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorVerticalOffsetInCell</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">Y=line in current graphics cell</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">containing current point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=number of bytes to fill</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP66" class="function-link"><span class="ACME-function-syntax">finalByte</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (no full bytes to write) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (plot final byte)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">loop to fill all the complete bytes we can</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">loopPlotBytes</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d744</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">} Y=Y-8, move to next cell left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">decrement high byte of current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics cursor</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP14" class="function-link"><span class="ACME-function-syntax">plotByte</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">display a filled byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP66" class="function-link"><span class="ACME-function-syntax">loopPlotBytes</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">if (more bytes to fill) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(loop back)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">now we may need to plot some pixels into the final byte</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finalByte</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d753</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore pixel width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">check modulo pixels per byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP65" class="function-link"><span class="ACME-function-syntax">donePlottingPoints</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (no remainder, i.e. no more</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pixels to write) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remainder = loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>

<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">shift A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduColourMaskRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">OR with right colour mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not done shifting the right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour mask) then branch (loop back)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduCurrentPlotByteMask</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store as byte mask</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">} Y=Y-8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduScreenAddressOfGraphicsCursorCellHigh</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">decrement byte of top line off</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">current graphics cursor cell</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP13" class="function-link"><span class="ACME-function-syntax">plotPointWithinBoundsAtY</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">display final point</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP65" class="function-link"><span class="ACME-function-syntax">donePlottingPoints</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">jump to next point</span>
</pre>
<p class="commentary firstcommentary"><a id="SP67" class="paragraph-anchor"></a><b>&#167;67. Update one edge when filling a triangle. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Update the variables of one edge, looping if needed to move the position up by one row.</span>
<span class="ACME-plain-syntax"> We update either the 'main line' or the 'minor line'. See .</span><a href="S-s8.html#SP60" class="internal">plotFillTriangle</a><span class="ACME-plain-syntax">.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = .vduPlotTriMainLineErrorTermLow  - .vduVariablesStart    to update the main edge</span>
<span class="ACME-plain-syntax">       X = .vduPlotTriMinorLineErrorTermLow - .vduVariablesStart    to update the minor edge</span>

<span class="ACME-plain-syntax"> Offsets 0-10 from X are used in the code below and refer to:</span>

<span class="ACME-plain-syntax">       0,1 = error term</span>
<span class="ACME-plain-syntax">       2,3 = delta X</span>
<span class="ACME-plain-syntax">       4,5 = delta Y</span>
<span class="ACME-plain-syntax">       6,7 = current point X</span>
<span class="ACME-plain-syntax">       8,9 = current point Y</span>
<span class="ACME-plain-syntax">       10  = X direction flag (top bit set means decrement X, otherwise increment X)</span>

<span class="ACME-plain-syntax"> See .</span><a href="S-s2.html#SP15" class="internal">vduPlotTriMainLineErrorTermLow</a><span class="ACME-plain-syntax"> for the variables.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillTriangleUpdateLinePosition</span><button class="popup" onclick="togglePopup('usagePopup84')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup84">Usage of <span class="code-font"><span class="ACME-function-syntax">fillTriangleUpdateLinePosition</span></span>:<br/><a href="S-s8.html#SP60">&#167;60</a>, <a href="S-s8.html#SP64">&#167;64</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d774</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">8</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} Increment current Y position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">9</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">} error -= delta X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">exit11</span></a><span class="ACME-plain-syntax">                                         </span><span class="ACME-comment-syntax">if (error &gt;=0) then branch (exit)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillTriangleUpdatePositionLoop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d791</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">10</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">fillTriangleMoveLeft</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">if (X direction flag set) then branch</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillTriangleMoveRight</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d796</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">updateErrorTerm</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">} increment current X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">7</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">updateErrorTerm</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">jump forward</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">fillTriangleMoveLeft</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d7a1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">7</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} decrement current X</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">}</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">updateErrorTerm</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d7ac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">4,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">} error += deltaY</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">5,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">1,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP67" class="function-link"><span class="ACME-function-syntax">fillTriangleUpdatePositionLoop</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">if (still on same row) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(loop back)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit11</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d7c1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s7.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresssection"><a href="S-s5.html">5</a></li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresssection"><a href="S-s7.html">7</a></li><li class="progresscurrent">8</li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresssection"><a href="S-s15.html">15</a></li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresssection"><a href="S-s21.html">21</a></li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progresssection"><a href="S-s26.html">26</a></li><li class="progressnext"><a href="S-s9.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

