<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 7: Graphics cursor and soft character definitions</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*CAT</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory-mapped i/o</a></li>
<li><a href="S-s4.html"><b>$C000</b>: chapter 4</a></li>
<li><a href="S-s5.html"><b>$C4C0</b>: chapter 5</a></li>
<li><a href="S-s6.html"><b>$CB1D</b>: chapter 6</a></li>
<li><span class="unlink"><b>$CCF8</b>: chapter 7</span></li>
<li><a href="S-s8.html"><b>$D060</b>: chapter 8</a></li>
<li><a href="S-s9.html"><b>$D7C2</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$D940</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$DC1C</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$DEC5</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$E0A4</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$E20E</b>: chapter 14</a></li>
<li><a href="S-s15.html"><b>$E5B3</b>: chapter 15</a></li>
<li><a href="S-s16.html"><b>$EB03</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$EEDA</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$F135</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$F588</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$F8A9</b>: chapter 20</a></li>
<li><a href="S-s21.html"><b>$FAE8</b>: chapter 21</a></li>
<li><a href="S-s22.html"><b>$FC00</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$FF00</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$FFA7</b>: chapter 24</a></li>
<li><a href="S-s25.html">appendix</a></li>
<li><a href="S-s26.html">index</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 7: Graphics cursor and soft character definitions' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">MOS 1.20</a></li><li><b>Chapter 7: Graphics cursor and soft character definitions</b></li></ul></div>
<p class="purpose">OSBYTE 20; Cursor editing mode; Software scroll up/downwards; Exchange four VDU variables; Plot character at graphics cursor; Graphics cursor handling; MODE 7 character conversion; Setup soft character definitions - 872 bytes (5.3%)</p>

<ul class="toc"><li><a href="S-s7.html#SP1">&#167;1. Subtract the number of bytes in a row from AX</a></li><li><a href="S-s7.html#SP2">&#167;2. OSBYTE 20 - 'Explode' soft character definitions</a></li><li><a href="S-s7.html#SP3">&#167;3. moveTextCursorToNextLine</a></li><li><a href="S-s7.html#SP4">&#167;4. moveTextCursorToNextLineCursorEditing</a></li><li><a href="S-s7.html#SP5">&#167;5. incYCoordinate</a></li><li><a href="S-s7.html#SP6">&#167;6. Set up a write cursor</a></li><li><a href="S-s7.html#SP7">&#167;7. Restore a normal cursor</a></li><li><a href="S-s7.html#SP8">&#167;8. restoreWriteCursorNonMODE7</a></li><li><a href="S-s7.html#SP9">&#167;9. Software scroll text window downwards</a></li><li><a href="S-s7.html#SP10">&#167;10. exchangeTwoVDUBytes</a></li><li><a href="S-s7.html#SP11">&#167;11. exchangeGraphicsCursorWithOldPosition</a></li><li><a href="S-s7.html#SP12">&#167;12. exchangeFourBytes</a></li><li><a href="S-s7.html#SP13">&#167;13. exchangeABytes</a></li><li><a href="S-s7.html#SP14">&#167;14. Software scroll text window upwards</a></li><li><a href="S-s7.html#SP15">&#167;15. Copy bytes of one character row of the text window</a></li><li><a href="S-s7.html#SP16">&#167;16. checkVerticalTextWindowBoundsAndMoveToLeftColumn</a></li><li><a href="S-s7.html#SP17">&#167;17. setTextCursorToLeftHandColumn</a></li><li><a href="S-s7.html#SP18">&#167;18. copyCharacterLineOfTextWindow</a></li><li><a href="S-s7.html#SP19">&#167;19. clearOneLine</a></li><li><a href="S-s7.html#SP20">&#167;20. validatePositionAndSetupScreenAddress</a></li><li><a href="S-s7.html#SP21">&#167;21. Set text cursor screen addresses from X,Y position</a></li><li><a href="S-s7.html#SP22">&#167;22. Display a character at the current graphics cursor</a></li><li><a href="S-s7.html#SP23">&#167;23. graphicsCursorHome</a></li><li><a href="S-s7.html#SP24">&#167;24. setGraphicsCursorToLeftHandColumn</a></li><li><a href="S-s7.html#SP25">&#167;25. displayACharacter</a></li><li><a href="S-s7.html#SP26">&#167;26. displayACharacterAtAddress</a></li><li><a href="S-s7.html#SP27">&#167;27. displayCharacterMODE7</a></li><li><a href="S-s7.html#SP28">&#167;28. convertMODE7Character</a></li><li><a href="S-s7.html#SP29">&#167;29. displayACharacter4ColourMODE</a></li><li><a href="S-s7.html#SP30">&#167;30. nextPatternByte</a></li><li><a href="S-s7.html#SP31">&#167;31. displayACharacter16ColourMODE</a></li><li><a href="S-s7.html#SP32">&#167;32. Get character definition address</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. Subtract the number of bytes in a row from AX. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = High byte of 16 bit value</span>
<span class="ACME-plain-syntax">       X = Low byte of 16 bit value</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">subtractNumberOfBytesInARowFromAX</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">subtractNumberOfBytesInARowFromAX</span></span>:<br/><a href="S-s7.html#SP9">&#167;9</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP56">&#167;56</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ccf8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry for subtraction</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">result goes into X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduStartScreenAddressHighByte</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">high byte of screen RAM address</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit6</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">exit6</span></span>:<br/><a href="S-s7.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd06</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. OSBYTE 20 - 'Explode' soft character definitions. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This sets how much RAM is reserved for custom ('soft') character definitions. These areas</span>
<span class="ACME-plain-syntax"> of memory are sometimes known as 'font zones'.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X   memory assigned          character range   notes</span>
<span class="ACME-plain-syntax">       0   $0C00-&gt;$0CFF               $80-$8F         minimum memory assigned ('imploded')</span>
<span class="ACME-plain-syntax">       1   OSHWM-&gt;OSHWM+$FF           $A0-$BF         includes allocations above</span>
<span class="ACME-plain-syntax">       2   OSHWM+$100-&gt;OSHWM+$1FF     $C0-$DF         includes allocations above</span>
<span class="ACME-plain-syntax">       3   OSHWM+$200-&gt;OSHWM+$2FF     $E0-$FF         includes allocations above</span>
<span class="ACME-plain-syntax">       4   OSHWM+$300-&gt;OSHWM+$3FF     $20-$3F         includes allocations above</span>
<span class="ACME-plain-syntax">       5   OSHWM+$400-&gt;OSHWM+$4FF     $40-$5F         includes allocations above</span>
<span class="ACME-plain-syntax">       6   OSHWM+$500-&gt;OSHWM+$5FF     $60-$7F         includes allocations above</span>

<span class="ACME-plain-syntax"> Here OSHWM refers to the value of .defaultOSHWM, which holds the value of OSHWM before any</span>
<span class="ACME-plain-syntax"> font explosions.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osbyte20EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">osbyte20EntryPoint</span></span>:<br/>Chapter 2: Memory Layout and Constants - <a href="S-s2.html#SP15">&#167;15</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP1">&#167;1</a><br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd07</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001111</span><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontFlags</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">characters 160-255 have soft</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character definitions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s2.html#SP23" class="function-link"><span class="ACME-function-syntax">softCharacterDefinitions</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">page for software character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">definitions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh7</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh1</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">set loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh1</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">set all font zone addresses (high</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte) to $0C</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">to indicate the page available</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">for user character definitions</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #7                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X &lt; 7, i.e. parameter is in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">range) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">X=6</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">softCharacterDefinitionsSwitch</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">character definition explosion switch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">defaultOSHWM</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">A = initial OSHWM value, before font</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">    explosions.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X = 0, loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">softCharacterDefinitionsSwitch</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">character definition explosion switch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP17" class="function-link"><span class="ACME-function-syntax">softCharacterRamAllocationTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">Y = RAM allocation offset</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh1</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">store in relevant font zone address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">add 1 page (carry clear)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X is not zero) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">currentOSHWM</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">store new value of PAGE (OSHWM)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP1" class="function-link"><span class="ACME-function-syntax">exit6</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (zero) then branch (return)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP7" class="function-link"><span class="ACME-function-syntax">romServiceCallFontImplosionExplosionWarning</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">} issue ROM service call to let ROMs</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} know of the font explosion and</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s18.html#SP5" class="function-link"><span class="ACME-function-syntax">osbyte143EntryPoint</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">} to let languages know OSHWM</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} is changing. Y is new PAGE number</span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. moveTextCursorToNextLine. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveTextCursorToNextLine</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">moveTextCursorToNextLine</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP21">&#167;21</a>, <a href="S-s5.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd3f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">A=2 to check if scrolling disabled</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (scrolling is disabled) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">exit8</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (cursor editing mode is disabled)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then return</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry clear on entry) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">get top of text window</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP4" class="function-link"><span class="ACME-function-syntax">moveTextCursorToNextLineCursorEditing</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">if (cursor editing mode enabled)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">set current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull return link from stack</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP29" class="function-link"><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">set cursor position</span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. moveTextCursorToNextLineCursorEditing. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveTextCursorToNextLineCursorEditing</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">moveTextCursorToNextLineCursorEditing</span></span>:<br/><a href="S-s7.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd59</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextInputCursorYCoordinate</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">Y coordinate of text input cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">pullAndExit</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">if (A = line count) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP5" class="function-link"><span class="ACME-function-syntax">incYCoordinate</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextInputCursorYCoordinate</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">Y coordinate of text input cursor</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit7</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">exit7</span></span>:<br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd65</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. incYCoordinate. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">incYCoordinate</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">incYCoordinate</span></span>:<br/><a href="S-s7.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd66</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextInputCursorYCoordinate</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">Y coordinate of text input cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. Set up a write cursor. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> When entering a line of text, if the user presses a cursor key then two cursors are shown:</span>
<span class="ACME-plain-syntax"> The WRITE cursor is shown at the point of text entry (looks like a solid block character),</span>
<span class="ACME-plain-syntax"> and is the position at which new characters will be input.</span>
<span class="ACME-plain-syntax"> The READ cursor (shown as a flashing underline) is positioned by the cursor keys.</span>
<span class="ACME-plain-syntax"> The COPY key reads the character under the READ cursor and enters it at WRITE cursor.</span>

<span class="ACME-plain-syntax"> Editing finishes when RETURN is pressed.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setUpWriteCursor</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">setUpWriteCursor</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP2">&#167;2</a>, <a href="S-s5.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd6a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = bytes per character - 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP8" class="function-link"><span class="ACME-function-syntax">restoreWriteCursorNonMODE7</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">if (not MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduMODE7CursorCharacter</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get MODE 7 write character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cursor character $7F</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">store it at top scan line of current</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">pullTwiceAndExit</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">pullTwiceAndExit</span></span>:<br/><a href="S-s7.html#SP7">&#167;7</a>, <a href="S-s7.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd77</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull A</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">pullAndExit</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">pullAndExit</span></span>:<br/><a href="S-s7.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd78</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit8</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">exit8</span></span>:<br/><a href="S-s7.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd79</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. Restore a normal cursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restoreWriteCursor</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">restoreWriteCursor</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP9">&#167;9</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd7a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = bytes per character - 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP8" class="function-link"><span class="ACME-function-syntax">restoreWriteCursorNonMODE7</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">if (not MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">read from cursor screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduMODE7CursorCharacter</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTeletextCharacterForCursor</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">MODE 7 write cursor character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">store it in MODE 7 screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">pullTwiceAndExit</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">and exit</span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. restoreWriteCursorNonMODE7. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restoreWriteCursorNonMODE7</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">restoreWriteCursorNonMODE7</span></span>:<br/><a href="S-s7.html#SP6">&#167;6</a>, <a href="S-s7.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cd8f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$FF (cursor byte mask)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #31                                             </span><span class="ACME-comment-syntax">check bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not MODE 2) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$3F</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$3F (cursor byte mask)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">get scan line byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">invert it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">store it on scan line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement scan line counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">do it again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">pullTwiceAndExit</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">ALWAYS branch (pull and exit)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. Software scroll text window downwards. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">scrollTextWindowDownwards</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">scrollTextWindowDownwards</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cda4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP16" class="function-link"><span class="ACME-function-syntax">checkVerticalTextWindowBoundsAndMoveToLeftColumn</span></a><span class="ACME-plain-syntax">   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set cursor screen addresses</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">loopBackScrollDown</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cdb0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP1" class="function-link"><span class="ACME-function-syntax">subtractNumberOfBytesInARowFromAX</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">subtract bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">screen RAM size high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">noWraparound</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">if (C set; there was no wraparound)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP18" class="function-link"><span class="ACME-function-syntax">copyCharacterLineOfTextWindow</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">copy line to new position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">using (.vduTempStoreDA) for read and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.vduWriteCursorScreenAddressLow)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">for write</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">noWraparound</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cdc6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP1" class="function-link"><span class="ACME-function-syntax">subtractNumberOfBytesInARowFromAX</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">subtract bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (outside screen RAM) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP15" class="function-link"><span class="ACME-function-syntax">copyCharacterRow</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">copy a character row of the text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">set write pointer from read pointer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement window height</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">loopBackScrollDown</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (not zero) then branch (loop back)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeTextCursorPositionWithWorkspaceAB</span><button class="popup" onclick="togglePopup('usagePopup15')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup15">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeTextCursorPositionWithWorkspaceAB</span></span>:<br/><a href="S-s7.html#SP14">&#167;14</a>, <a href="S-s7.html#SP16">&#167;16</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cdda</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">point to workspace</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">point to text column/line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. exchangeTwoVDUBytes. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeTwoVDUBytes</span><button class="popup" onclick="togglePopup('usagePopup16')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup16">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeTwoVDUBytes</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP9">&#167;9</a>, <a href="S-s5.html#SP38">&#167;38</a><br/>Chapter 8: PLOT - <a href="S-s8.html#SP35">&#167;35</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cdde</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">number of bytes to swap</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP13" class="function-link"><span class="ACME-function-syntax">exchangeABytes</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">ALWAYS branch. Exchange</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.vduWorkspaceA/B)+Y with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.workspaceA/B)+X</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. exchangeGraphicsCursorWithOldPosition. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span><button class="popup" onclick="togglePopup('usagePopup17')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup17">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeGraphicsCursorWithOldPosition</span></span>:<br/>Chapter 8: PLOT - <a href="S-s8.html#SP9">&#167;9</a>, <a href="S-s8.html#SP59">&#167;59</a>, <a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cde2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">point to graphics cursor</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeOldGraphicsCursorPositionWithVariableX</span><button class="popup" onclick="togglePopup('usagePopup18')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup18">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeOldGraphicsCursorPositionWithVariableX</span></span>:<br/>Chapter 8: PLOT - <a href="S-s8.html#SP60">&#167;60</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cde4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduOldGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">point to last graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. exchangeFourBytes. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeFourBytes</span><button class="popup" onclick="togglePopup('usagePopup19')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup19">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeFourBytes</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP62">&#167;62</a><br/>Chapter 8: PLOT - <a href="S-s8.html#SP49">&#167;49</a>, <a href="S-s8.html#SP62">&#167;62</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cde6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">A = 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. exchangeABytes. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeABytes</span><button class="popup" onclick="togglePopup('usagePopup20')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup20">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeABytes</span></span>:<br/><a href="S-s7.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cde8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it as loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">get byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">get byte pointed to by Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">put it in 300+X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">put it in 300+Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment pointers</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch (loop back</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and do it again)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. Software scroll text window upwards. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">scrollTextWindowUpwards</span><button class="popup" onclick="togglePopup('usagePopup21')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup21">Usage of <span class="code-font"><span class="ACME-function-syntax">scrollTextWindowUpwards</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cdff</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP16" class="function-link"><span class="ACME-function-syntax">checkVerticalTextWindowBoundsAndMoveToLeftColumn</span></a><span class="ACME-plain-syntax">   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">top of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set cursor screen addresses</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">loopBackScrollUp</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce0b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP68" class="function-link"><span class="ACME-function-syntax">addNumberOfBytesInACharacterRowToAX</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">add bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">screen RAM size high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">(.vduTempStoreDA)=X/A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDC=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP18" class="function-link"><span class="ACME-function-syntax">copyCharacterLineOfTextWindow</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">copy line to new position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">using (.vduTempStoreDA) for read</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.vduWriteCursorScreenAddressLow)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">for write</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP14" class="function-link"><span class="ACME-function-syntax">finishScroll</span></a><span class="ACME-plain-syntax">                                   </span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP68" class="function-link"><span class="ACME-function-syntax">addNumberOfBytesInACharacterRowToAX</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">add bytes per char. row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (outside screen RAM) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP15" class="function-link"><span class="ACME-function-syntax">copyCharacterRow</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">copy a character row of the text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">finishScroll</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce2a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement window height</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP14" class="function-link"><span class="ACME-function-syntax">loopBackScrollUp</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (not zero) then branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">exchangeTextCursorPositionWithWorkspaceAB</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">ALWAYS branch - swap text cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position with workspace</span>
</pre>
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. Copy bytes of one character row of the text window. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .vduTempStoreDA/DB                   is address to copy from</span>
<span class="ACME-plain-syntax">       .vduWriteCursorScreenAddressLow/High is the destination address</span>
<span class="ACME-plain-syntax">       .vduTextWindowWidthInBytesLow/High   is number of bytes to copy</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyCharacterRow</span><button class="popup" onclick="togglePopup('usagePopup22')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup22">Usage of <span class="code-font"><span class="ACME-function-syntax">copyCharacterRow</span></span>:<br/><a href="S-s7.html#SP9">&#167;9</a>, <a href="S-s7.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce38</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesHigh</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">text window width high (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (no more than 256 bytes to copy)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0 to set loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">} copy 256 bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">} loop till Y=0 again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">increment high bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement window width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not done yet) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesLow</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text window width low (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (text window is zero bytes wide)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (return)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">copy Y bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not done yet) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

</pre>
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. checkVerticalTextWindowBoundsAndMoveToLeftColumn. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkVerticalTextWindowBoundsAndMoveToLeftColumn</span><button class="popup" onclick="togglePopup('usagePopup23')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup23">Usage of <span class="code-font"><span class="ACME-function-syntax">checkVerticalTextWindowBoundsAndMoveToLeftColumn</span></span>:<br/><a href="S-s7.html#SP9">&#167;9</a>, <a href="S-s7.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce5b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">exchangeTextCursorPositionWithWorkspaceAB</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">exchange text cursor position with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspaceAB</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">top of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store height of text area</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP17" class="function-link"><span class="ACME-function-syntax">setTextCursorToLeftHandColumn</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set text column to left hand column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back return address (to exit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">caller routine early)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">exchangeTextCursorPositionWithWorkspaceAB</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">exchange text cursor position with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspaceAB</span>
</pre>
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. setTextCursorToLeftHandColumn. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setTextCursorToLeftHandColumn</span><button class="popup" onclick="togglePopup('usagePopup24')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup24">Usage of <span class="code-font"><span class="ACME-function-syntax">setTextCursorToLeftHandColumn</span></span>:<br/><a href="S-s7.html#SP16">&#167;16</a>, <a href="S-s7.html#SP19">&#167;19</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP39">&#167;39</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce6e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">storeTextCursorXSetCarryAndReturn</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">ALWAYS branch (set X window position)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. copyCharacterLineOfTextWindow. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">copyCharacterLineOfTextWindow</span><button class="popup" onclick="togglePopup('usagePopup25')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup25">Usage of <span class="code-font"><span class="ACME-function-syntax">copyCharacterLineOfTextWindow</span></span>:<br/><a href="S-s7.html#SP9">&#167;9</a>, <a href="S-s7.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ce73</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">text window right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store text window width</span>
<span class="ACME-identifier-syntax">--</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">bytes per character to set loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">copy loop</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">source: copy from .vduTempStoreDA/DB</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">destination: store to screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">keep copying for one character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">X=2 loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">move screen pointer on by bytes per</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">and (when X=0) do the same with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduTempStoreDA/DB</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (this remains in screen RAM OK)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">wrap around screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">take off screen RAM size high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">store high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = X - 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X = 0) then branch (loop back</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to adjust second set of pointers)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement text window width counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">--</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">if (still +ve) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back and do it all again)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. clearOneLine. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearOneLine</span><button class="popup" onclick="togglePopup('usagePopup26')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup26">Usage of <span class="code-font"><span class="ACME-function-syntax">clearOneLine</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP28">&#167;28</a>, <a href="S-s5.html#SP36">&#167;36</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ceac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP17" class="function-link"><span class="ACME-function-syntax">setTextCursorToLeftHandColumn</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set text column to left hand column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set cursor screen addresses</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">text window right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">as window width</span>
<span class="ACME-identifier-syntax">--</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundTextColour</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">background text colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">bytes per character</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1 decrementing loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">store background colour at this</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">point on screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y is not zero) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry to add</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A restoring it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">add carry if any</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (+ve) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">wrap around</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">screen RAM size high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">restore values</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">decrement window width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">--</span><span class="ACME-plain-syntax">                                              </span><span class="ACME-comment-syntax">and if not 0 do it all again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">storeTextCursorXSetCarryAndReturn</span><button class="popup" onclick="togglePopup('usagePopup27')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup27">Usage of <span class="code-font"><span class="ACME-function-syntax">storeTextCursorXSetCarryAndReturn</span></span>:<br/><a href="S-s7.html#SP17">&#167;17</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cee3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">restore text column</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCarryAndReturn</span><button class="popup" onclick="togglePopup('usagePopup28')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup28">Usage of <span class="code-font"><span class="ACME-function-syntax">setCarryAndReturn</span></span>:<br/><a href="S-s7.html#SP20">&#167;20</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cee6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP20" class="paragraph-anchor"></a><b>&#167;20. validatePositionAndSetupScreenAddress. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">validatePositionAndSetupScreenAddress</span><button class="popup" onclick="togglePopup('usagePopup29')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup29">Usage of <span class="code-font"><span class="ACME-function-syntax">validatePositionAndSetupScreenAddress</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP38">&#167;38</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cee8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get text cursor X position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">test against left edge of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">setCarryAndReturn</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (less than left edge) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return with carry set)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">test against right edge of text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (equal to right edge) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(thats OK)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">setCarryAndReturn</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (greater than right edge) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return with carry set)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">test against top edge of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">setCarryAndReturn</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (less than top edge) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return with carry set)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">test against bottom edge of text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">if (equal to bottom edge) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (ok to set cursor screen</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">addresses)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">setCarryAndReturn</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (greater than bottom edge) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return with carry set)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP21" class="paragraph-anchor"></a><b>&#167;21. Set text cursor screen addresses from X,Y position. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Let X,Y be the text cursor position (in absolute character cells from top left corner)</span>

<span class="ACME-plain-syntax">     MODE 0: address = screen_start + Y*640 + X* 8</span>
<span class="ACME-plain-syntax">     MODE 1: address = screen_start + Y*640 + X*16</span>
<span class="ACME-plain-syntax">     MODE 2: address = screen_start + Y*640 + X*32</span>
<span class="ACME-plain-syntax">     MODE 3: address = screen_start + Y*640 + X* 8</span>
<span class="ACME-plain-syntax">     MODE 4: address = screen_start + Y*320 + X* 8</span>
<span class="ACME-plain-syntax">     MODE 5: address = screen_start + Y*320 + X*16</span>
<span class="ACME-plain-syntax">     MODE 6: address = screen_start + Y*320 + X* 8</span>
<span class="ACME-plain-syntax">     MODE 7: address = screen_start + Y* 40 + X</span>

<span class="ACME-plain-syntax"> Given the text cursor X,Y position, use the multiplication table and other characteristic</span>
<span class="ACME-plain-syntax"> values for the current MODE to calculate the address on screen.</span>

<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .vduTextCursorX/YPosition stores the X,Y coordinates of the text cursor</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       Carry clear</span>
<span class="ACME-plain-syntax">       Stores the result in .vduTextCursorCRTCAddressLow/High, then wraps the address back on</span>
<span class="ACME-plain-syntax">       screen if beyond the bottom of the screen. Store the new wrapped result in</span>
<span class="ACME-plain-syntax">       .vduWriteCursorScreenAddressLow/High.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setTextCursorScreenAddresses</span><button class="popup" onclick="togglePopup('usagePopup30')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup30">Usage of <span class="code-font"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></span>:<br/><a href="S-s7.html#SP9">&#167;9</a>, <a href="S-s7.html#SP14">&#167;14</a>, <a href="S-s7.html#SP19">&#167;19</a>, <a href="S-s7.html#SP20">&#167;20</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP9">&#167;9</a>, <a href="S-s5.html#SP29">&#167;29</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf06</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">multiply by two to get table offset</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduMultiplicationTableLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get CRTC multiplication table pointer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">.vduWriteCursorScreenAddressHigh=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">A=2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODEGroup</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">AND with MODE group:</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">  0 = 20k (MODE 0,1,2)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">  1 = 16k (MODE 3)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">  2 = 10k (MODE 4,5)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">  3 = 8k (MODE 6)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">  4 = 1k (MODE 7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduMultiplicationTableLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get CRTC multiplication table pointer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">branch if MODE 0,1,2,3 or 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">MODE 4,5,6: Halve value from</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">multiplication table (high and low</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = A / 2 + (128*carry)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">add start of screen (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">store</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get offset from start of screen</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">add start of screen (high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store in Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">mode7Cursor</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">if (in MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #15                                             </span><span class="ACME-comment-syntax">is it mode 1 or mode 5? (four colour</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">modes = 16 bytes per character)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">mode1or5Cursor</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (mode 1 or 5) then branch (with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">carry set)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">mode0346Cursor</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (mode 0,3,4, or 6) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(with carry clear)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A*16 if entered here (MODE 2)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">mode1or5Cursor</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf39</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A*8 if entered here</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">mode0346Cursor</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf3a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A*4 if entered here</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">skipIncs</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (carry clear) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y is the high byte of the address</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipIncs</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf40</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=A*2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">skipInc</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">if (carry clear) branch (to add to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduWriteCursorScreenAddressLow)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">mode7Cursor</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf44</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipInc</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf45</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">add to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduWriteCursorScreenAddressLow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">and store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">text cursor CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">add carry if set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">store the text cursor CRTC address</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(before any wraparound)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not negative) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">wrap around...</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">...subtract the screen size (high</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">store in high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP22" class="paragraph-anchor"></a><b>&#167;22. Display a character at the current graphics cursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotACharacterAtGraphicsCursor</span><button class="popup" onclick="togglePopup('usagePopup31')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup31">Usage of <span class="code-font"><span class="ACME-function-syntax">plotACharacterAtGraphicsCursor</span></span>:<br/><a href="S-s7.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf5d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">foreground graphics colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGCOLMode</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">foreground graphics GCOL mode</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">plotACharacterWithXYAsGraphicsColourAndGCOLMode</span><button class="popup" onclick="togglePopup('usagePopup32')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup32">Usage of <span class="code-font"><span class="ACME-function-syntax">plotACharacterWithXYAsGraphicsColourAndGCOLMode</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP67">&#167;67</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf63</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP6" class="function-link"><span class="ACME-function-syntax">setGraphicsColourMaskXY</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">set graphics byte mask in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduGraphicsColourByteOR/EOR</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP41" class="function-link"><span class="ACME-function-syntax">copyGraphicsCursorPixelPositionToWorkspaceABCD</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">copy graphics cursor in pixels to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace (.vduWorkspaceA-D)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayNextRowOfCharacter</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf6b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDC=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">Y=.vduTempStoreDC [redundant</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">instruction]</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get pattern byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP22" class="function-link"><span class="ACME-function-syntax">characterPatternZero</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">if (A=0) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">.vduTempStoreDD = 1 bit character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pattern byte</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (pattern's top bit is clear) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (nothing to draw)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP12" class="function-link"><span class="ACME-function-syntax">plotAPixelInACharacter</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">display a pixel</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">current horizontal graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">current horizontal graphics cursor</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">shift the bit pattern left to draw</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">next pixel</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (there's still something left to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">draw) then branch (loop back)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">characterPatternZero</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cf86</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">source is workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">destination is horizontal graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cursor pixel position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP40" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">copy two bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">} decrement graphics cursor Y pixel</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} position</span>
<span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                       </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #8                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP22" class="function-link"><span class="ACME-function-syntax">displayNextRowOfCharacter</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (Y&lt;8) then branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">source: workspaceA-D</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">destination: graphics cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">copy to graphics cursor position</span>
</pre>
<p class="commentary firstcommentary"><a id="SP23" class="paragraph-anchor"></a><b>&#167;23. graphicsCursorHome. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">graphicsCursorHome</span><button class="popup" onclick="togglePopup('usagePopup33')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup33">Usage of <span class="code-font"><span class="ACME-function-syntax">graphicsCursorHome</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP37">&#167;37</a>, <a href="S-s5.html#SP40">&#167;40</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfa6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsTopLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">source bytes (graphics window</span>
<span class="ACME-plain-syntax">                                                             </span><span class="ACME-comment-syntax">top)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsYLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">destination bytes (graphics</span>
<span class="ACME-plain-syntax">                                                             </span><span class="ACME-comment-syntax">cursor Y)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP40" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">copy two bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP24" class="paragraph-anchor"></a><b>&#167;24. setGraphicsCursorToLeftHandColumn. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setGraphicsCursorToLeftHandColumn</span><button class="popup" onclick="togglePopup('usagePopup34')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup34">Usage of <span class="code-font"><span class="ACME-function-syntax">setGraphicsCursorToLeftHandColumn</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP39">&#167;39</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfad</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">source: left edge of graphics</span>
<span class="ACME-plain-syntax">                                                              </span><span class="ACME-comment-syntax">window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">destination: graphics cursor</span>
<span class="ACME-plain-syntax">                                                              </span><span class="ACME-comment-syntax">X coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP40" class="function-link"><span class="ACME-function-syntax">copyTwoBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">copy two bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">set up external coordinates</span>
<span class="ACME-plain-syntax">                                                              </span><span class="ACME-comment-syntax">for graphics</span>
</pre>
<p class="commentary firstcommentary"><a id="SP25" class="paragraph-anchor"></a><b>&#167;25. displayACharacter. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayACharacter</span><button class="popup" onclick="togglePopup('usagePopup35')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup35">Usage of <span class="code-font"><span class="ACME-function-syntax">displayACharacter</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfb7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP27" class="function-link"><span class="ACME-function-syntax">displayCharacterMODE7</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP32" class="function-link"><span class="ACME-function-syntax">getCharacterDefinitionAddress</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set up character definition pointers</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP26" class="paragraph-anchor"></a><b>&#167;26. displayACharacterAtAddress. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayACharacterAtAddress</span><button class="popup" onclick="togglePopup('usagePopup36')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup36">Usage of <span class="code-font"><span class="ACME-function-syntax">displayACharacterAtAddress</span></span>:<br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP65">&#167;65</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfbf</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$20</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">and check bit 5 (printing at</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics cursor)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP22" class="function-link"><span class="ACME-function-syntax">plotACharacterAtGraphicsCursor</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">if (set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">Y=7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #3                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP29" class="function-link"><span class="ACME-function-syntax">displayACharacter4ColourMODE</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">if (X = 3) then branch to handle 4</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour MODEs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP31" class="function-link"><span class="ACME-function-syntax">displayACharacter16ColourMODE</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (X &gt; 3) then branch to deal with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">16 colours</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">display a character in a 2 colour MODE</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get pattern byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">write to screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (still +ve) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP27" class="paragraph-anchor"></a><b>&#167;27. displayCharacterMODE7. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayCharacterMODE7</span><button class="popup" onclick="togglePopup('usagePopup37')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup37">Usage of <span class="code-font"><span class="ACME-function-syntax">displayCharacterMODE7</span></span>:<br/><a href="S-s7.html#SP25">&#167;25</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP66">&#167;66</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfdc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">Y=2, loop counter/index into the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">teletext conversion table</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP16" class="function-link"><span class="ACME-function-syntax">teletextCharacterConversionTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">compare with teletext conversion</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP28" class="function-link"><span class="ACME-function-syntax">convertMODE7Character</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (found character to convert) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">loop back until done</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writeByteToMODE7Screen</span><button class="popup" onclick="togglePopup('usagePopup38')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup38">Usage of <span class="code-font"><span class="ACME-function-syntax">writeByteToMODE7Screen</span></span>:<br/><a href="S-s7.html#SP28">&#167;28</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfe6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">)             </span><span class="ACME-comment-syntax">write byte to screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP28" class="paragraph-anchor"></a><b>&#167;28. convertMODE7Character. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">convertMODE7Character</span><button class="popup" onclick="togglePopup('usagePopup39')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup39">Usage of <span class="code-font"><span class="ACME-function-syntax">convertMODE7Character</span></span>:<br/><a href="S-s7.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfe9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP16" class="function-link"><span class="ACME-function-syntax">teletextCharacterConversionTable</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">convert with teletext conversion</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP27" class="function-link"><span class="ACME-function-syntax">writeByteToMODE7Screen</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">ALWAYS branch back to write it</span>
</pre>
<p class="commentary firstcommentary"><a id="SP29" class="paragraph-anchor"></a><b>&#167;29. displayACharacter4ColourMODE. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayACharacter4ColourMODE</span><button class="popup" onclick="togglePopup('usagePopup40')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup40">Usage of <span class="code-font"><span class="ACME-function-syntax">displayACharacter4ColourMODE</span></span>:<br/><a href="S-s7.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cfee</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get pattern byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">move high nybble to low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP4" class="function-link"><span class="ACME-function-syntax">fourColourMODEByteMaskTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">convert 4 bits of the character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">definition into bytes to write</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to the screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">write to screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">add 8 to move screen RAM pointer 8</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">clear high nybble</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP4" class="function-link"><span class="ACME-function-syntax">fourColourMODEByteMaskTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">4 colour MODE byte mask look up table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">write to screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">A=A-9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP29" class="function-link"><span class="ACME-function-syntax">displayACharacter4ColourMODE</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">if (not negative) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit9</span><button class="popup" onclick="togglePopup('usagePopup41')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup41">Usage of <span class="code-font"><span class="ACME-function-syntax">exit9</span></span>:<br/><a href="S-s7.html#SP30">&#167;30</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d017</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP30" class="paragraph-anchor"></a><b>&#167;30. nextPatternByte. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">nextPatternByte</span><button class="popup" onclick="togglePopup('usagePopup42')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup42">Usage of <span class="code-font"><span class="ACME-function-syntax">nextPatternByte</span></span>:<br/><a href="S-s7.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d018</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y-$21</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$21</span><span class="ACME-plain-syntax">                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP29" class="function-link"><span class="ACME-function-syntax">exit9</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (Y is negative) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP31" class="paragraph-anchor"></a><b>&#167;31. displayACharacter16ColourMODE. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">displayACharacter16ColourMODE</span><button class="popup" onclick="togglePopup('usagePopup43')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup43">Usage of <span class="code-font"><span class="ACME-function-syntax">displayACharacter16ColourMODE</span></span>:<br/><a href="S-s7.html#SP26">&#167;26</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d01e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">get pattern byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">iloop</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d023</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">carry now occupies bit 0 of DC</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP30" class="function-link"><span class="ACME-function-syntax">nextPatternByte</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">when DC=0 again branch to deal</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">with next pattern byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get bit 7 from .vduTempStoreDC into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A bit 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">rotate again to get second</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">bit into A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">and store result in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP5" class="function-link"><span class="ACME-function-syntax">sixteenColourMODEByteMaskTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">convert two bits of the character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">definition into bytes to write</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to the screen</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">adjust for current foreground and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">and store result</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">} Y=Y+8 moving screen RAM pointer on</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} 8 bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP31" class="function-link"><span class="ACME-function-syntax">iloop</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">branch back to deal with next bit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">pair</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP32" class="paragraph-anchor"></a><b>&#167;32. Get character definition address. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A is the ascii code for a printable character 32-255 (bit pattern abcdefgh)</span>
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       .vduTempStoreDE/F is the address of the character definition either from the default</span>
<span class="ACME-plain-syntax">                      ROM characters or the soft character definitions</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">getCharacterDefinitionAddress</span><button class="popup" onclick="togglePopup('usagePopup44')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup44">Usage of <span class="code-font"><span class="ACME-function-syntax">getCharacterDefinitionAddress</span></span>:<br/><a href="S-s7.html#SP25">&#167;25</a><br/>Chapter 5: VDU and OSWORD routines - <a href="S-s5.html#SP50">&#167;50</a>, <a href="S-s5.html#SP67">&#167;67</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP3">&#167;3</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $d03e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">bcdefgh0  C=a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">cdefgh0a  C=b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">defgh0ab  C=c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">save this pattern (defgh0ab)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000011</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">000000ab</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">00000abc  C=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = soft font zone (1 - 7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000011</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">A = 000000bc (1 - 3)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s4.html#SP1" class="function-link"><span class="ACME-function-syntax">characterDefinitions</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">A = high byte of character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">definitions ($C0, $C1, $C2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = high byte of ROM address of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP11" class="function-link"><span class="ACME-function-syntax">fontMaskTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">get single bit set depending on X</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(1-7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontFlags</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">test font flags to see if there are</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">soft character definitions</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (hard character definitions) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh1</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get high byte from table for soft</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character definitions</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store Y in high byte of address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get back pattern (defgh0ab)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%11111000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">defgh000</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and store it. This is 8 times the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">ASCII character giving the low</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte of the address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s6.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresssection"><a href="S-s5.html">5</a></li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresscurrent">7</li><li class="progresssection"><a href="S-s8.html">8</a></li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresssection"><a href="S-s15.html">15</a></li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresssection"><a href="S-s21.html">21</a></li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progresssection"><a href="S-s26.html">26</a></li><li class="progressnext"><a href="S-s8.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

