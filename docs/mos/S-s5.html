<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
	<head>
		<title>Chapter 5: VDU and OSWORD routines</title>
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Breadcrumbs.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Carousel.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Navigation.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Base.css" rel="stylesheet" rev="stylesheet" type="text/css">
		<meta name="viewport" content="width=device-width initial-scale=1">
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta http-equiv="Content-Language" content="en-gb">

<link href="../docs-assets/Contents.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Progress.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Fonts.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/Popups.css" rel="stylesheet" rev="stylesheet" type="text/css">
<script>
function togglePopup(material_id) {
  var popup = document.getElementById(material_id);
  popup.classList.toggle("show");
}
</script>

<link href="../docs-assets/Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
<link href="../docs-assets/ACME-Colours.css" rel="stylesheet" rev="stylesheet" type="text/css">
		
	</head>
	<body class="commentary-font">
		<nav role="navigation">
		<p>BBC Computer 32K</p>
<h1>*CAT</h1>
<ul><li><a href="../index.html">&#x21A9; home</a></li><li><a href="index.html"><span class="selectedlink">contents</span></a></li>
<li><a href="S-s1.html">introduction</a></li>
<li><a href="S-s2.html">constants</a></li>
<li><a href="S-s3.html">memory-mapped i/o</a></li>
<li><a href="S-s4.html"><b>$C000</b>: chapter 4</a></li>
<li><span class="unlink"><b>$C4C0</b>: chapter 5</span></li>
<li><a href="S-s6.html"><b>$CB1D</b>: chapter 6</a></li>
<li><a href="S-s7.html"><b>$CCF8</b>: chapter 7</a></li>
<li><a href="S-s8.html"><b>$D060</b>: chapter 8</a></li>
<li><a href="S-s9.html"><b>$D7C2</b>: chapter 9</a></li>
<li><a href="S-s10.html"><b>$D940</b>: chapter 10</a></li>
<li><a href="S-s11.html"><b>$DC1C</b>: chapter 11</a></li>
<li><a href="S-s12.html"><b>$DEC5</b>: chapter 12</a></li>
<li><a href="S-s13.html"><b>$E0A4</b>: chapter 13</a></li>
<li><a href="S-s14.html"><b>$E20E</b>: chapter 14</a></li>
<li><a href="S-s15.html"><b>$E5B3</b>: chapter 15</a></li>
<li><a href="S-s16.html"><b>$EB03</b>: chapter 16</a></li>
<li><a href="S-s17.html"><b>$EEDA</b>: chapter 17</a></li>
<li><a href="S-s18.html"><b>$F135</b>: chapter 18</a></li>
<li><a href="S-s19.html"><b>$F588</b>: chapter 19</a></li>
<li><a href="S-s20.html"><b>$F8A9</b>: chapter 20</a></li>
<li><a href="S-s21.html"><b>$FAE8</b>: chapter 21</a></li>
<li><a href="S-s22.html"><b>$FC00</b>: chapter 22</a></li>
<li><a href="S-s23.html"><b>$FF00</b>: chapter 23</a></li>
<li><a href="S-s24.html"><b>$FFA7</b>: chapter 24</a></li>
<li><a href="S-s25.html">appendix</a></li>
<li><a href="S-s26.html">index</a></li>

</ul>
		</nav>
		<main role="main">
		<!--Weave of 'Chapter 5: VDU and OSWORD routines' generated by Inweb-->
<div class="breadcrumbs">
    <ul class="crumbs"><li><a href="../index.html">Home</a></li><li><a href="index.html">MOS 1.20</a></li><li><b>Chapter 5: VDU and OSWORD routines</b></li></ul></div>
<p class="purpose">VDU 0-6, 8-31, 127. OSWORD 9, 11, 12; VDUCHR entry point; Swap cursor variables; Check text or graphics cursor active; Hardware scrolling; Scroll in paged mode - 1629 bytes (9.9%)</p>

<ul class="toc"><li><a href="S-s5.html#SP1">&#167;1. Note about the BBC Micro Character Set (it's almost, but not quite 7-bit ASCII)</a></li><li><a href="S-s5.html#SP2">&#167;2. VDUCHR entry point</a></li><li><a href="S-s5.html#SP3">&#167;3. handleDeleteCharacter</a></li><li><a href="S-s5.html#SP4">&#167;4. VDU 0 / 6 / 27      Empty handlers</a></li><li><a href="S-s5.html#SP5">&#167;5. vduParametersAreOutstanding</a></li><li><a href="S-s5.html#SP6">&#167;6. VDU 1       Send next byte to printer only</a></li><li><a href="S-s5.html#SP7">&#167;7. explicitAddressNoParameters</a></li><li><a href="S-s5.html#SP8">&#167;8. exitVDUCHR</a></li><li><a href="S-s5.html#SP9">&#167;9. reswapCursorsBack</a></li><li><a href="S-s5.html#SP10">&#167;10. checkForVDUReenable</a></li><li><a href="S-s5.html#SP11">&#167;11. Check whether the text or graphics cursor is active</a></li><li><a href="S-s5.html#SP12">&#167;12. VDU 14    Set paged mode</a></li><li><a href="S-s5.html#SP13">&#167;13. VDU 2     Printer On</a></li><li><a href="S-s5.html#SP14">&#167;14. VDU 21    Disable VDU drivers</a></li><li><a href="S-s5.html#SP15">&#167;15. VDU 3     Printer off</a></li><li><a href="S-s5.html#SP16">&#167;16. VDU 15    Paged mode off</a></li><li><a href="S-s5.html#SP17">&#167;17. VDU 4       Select text cursor</a></li><li><a href="S-s5.html#SP18">&#167;18. VDU 5       Select graphics cursor</a></li><li><a href="S-s5.html#SP19">&#167;19. VDU 8       Cursor left (.charBACKSPACE)</a></li><li><a href="S-s5.html#SP20">&#167;20. wrapFromLeftEdgeToRightEdgeOfTextWindow</a></li><li><a href="S-s5.html#SP21">&#167;21. cursorAtTopOfTextWindow</a></li><li><a href="S-s5.html#SP22">&#167;22. moveGraphicsCursorLeftEightPixels</a></li><li><a href="S-s5.html#SP23">&#167;23. Move graphics cursor (left or down)</a></li><li><a href="S-s5.html#SP24">&#167;24. VDU 11       Cursor up</a></li><li><a href="S-s5.html#SP25">&#167;25. VDU 9        Cursor right</a></li><li><a href="S-s5.html#SP26">&#167;26. moveTextCursorToLeftEdgeAndDown</a></li><li><a href="S-s5.html#SP27">&#167;27. moveTextCursorDown</a></li><li><a href="S-s5.html#SP28">&#167;28. clearOneLineAndPositionCursor</a></li><li><a href="S-s5.html#SP29">&#167;29. Set cursor address</a></li><li><a href="S-s5.html#SP30">&#167;30. moveGraphicsCursorRightEightPixels</a></li><li><a href="S-s5.html#SP31">&#167;31. Move graphics cursor (up or right)</a></li><li><a href="S-s5.html#SP32">&#167;32. VDU 10       Cursor down</a></li><li><a href="S-s5.html#SP33">&#167;33. VDU 28       Define Text Window</a></li><li><a href="S-s5.html#SP34">&#167;34. OSWORD 9 - Read a pixel</a></li><li><a href="S-s5.html#SP35">&#167;35. OSWORD 11 - Read palette</a></li><li><a href="S-s5.html#SP36">&#167;36. VDU 12      Clear text or graphics window</a></li><li><a href="S-s5.html#SP37">&#167;37. VDU 30      Home Cursor</a></li><li><a href="S-s5.html#SP38">&#167;38. VDU 31      Position text cursor</a></li><li><a href="S-s5.html#SP39">&#167;39. VDU 13      Carriage Return (.charRETURN)</a></li><li><a href="S-s5.html#SP40">&#167;40. clearGraphicsWindowAndHomeGraphicsCursor</a></li><li><a href="S-s5.html#SP41">&#167;41. VDU 16      Clear graphics window</a></li><li><a href="S-s5.html#SP42">&#167;42. VDU 17      Define text colour</a></li><li><a href="S-s5.html#SP43">&#167;43. VDU 18      Define graphics colour</a></li><li><a href="S-s5.html#SP44">&#167;44. setGraphicsGCOLColour</a></li><li><a href="S-s5.html#SP45">&#167;45. restoreMODE7TextBackgroundColour</a></li><li><a href="S-s5.html#SP46">&#167;46. VDU 20      Restore default colours</a></li><li><a href="S-s5.html#SP47">&#167;47. VDU 19      Write palette</a></li><li><a href="S-s5.html#SP48">&#167;48. OSWORD 12 - Write Palette</a></li><li><a href="S-s5.html#SP49">&#167;49. VDU 22      Select MODE</a></li><li><a href="S-s5.html#SP50">&#167;50. VDU 23      Define Character</a></li><li><a href="S-s5.html#SP51">&#167;51. Plot extension</a></li><li><a href="S-s5.html#SP52">&#167;52. VDU 23 with 0-31 as the next byte</a></li><li><a href="S-s5.html#SP53">&#167;53. vdu23CommaZeroSetCRTCRegister</a></li><li><a href="S-s5.html#SP54">&#167;54. setCRTCRegisterDirect</a></li><li><a href="S-s5.html#SP55">&#167;55. VDU 25      Plot</a></li><li><a href="S-s5.html#SP56">&#167;56. Hardware screen scroll up/down</a></li><li><a href="S-s5.html#SP57">&#167;57. VDU 26      Reset to default windows</a></li><li><a href="S-s5.html#SP58">&#167;58. Set cursor screen address</a></li><li><a href="S-s5.html#SP59">&#167;59. Set hardware screen or cursor address</a></li><li><a href="S-s5.html#SP60">&#167;60. Write to two sequential registers on the CRTC</a></li><li><a href="S-s5.html#SP61">&#167;61. VDU 24      Define graphics window</a></li><li><a href="S-s5.html#SP62">&#167;62. exchangeGraphicsCursorPositionWithWorkspaceABCD</a></li><li><a href="S-s5.html#SP63">&#167;63. calculateBytesPerTextWindowRow</a></li><li><a href="S-s5.html#SP64">&#167;64. VDU 29      Set graphics origin</a></li><li><a href="S-s5.html#SP65">&#167;65. VDU 127     Delete</a></li><li><a href="S-s5.html#SP66">&#167;66. deleteCharacterInMODE7</a></li><li><a href="S-s5.html#SP67">&#167;67. deleteCharacterAtGraphicsCursor</a></li><li><a href="S-s5.html#SP68">&#167;68. addNumberOfBytesInACharacterRowToAX</a></li><li><a href="S-s5.html#SP69">&#167;69. Paged mode scrolling</a></li><li><a href="S-s5.html#SP70">&#167;70. clearPagedModeCounter</a></li></ul><hr class="tocbar">

<p class="commentary firstcommentary"><a id="SP1" class="paragraph-anchor"></a><b>&#167;1. Note about the BBC Micro Character Set (it's almost, but not quite 7-bit ASCII). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> One of the main tasks for OSWRCH is to draw characters to the screen. The VDUCHR routine</span>
<span class="ACME-plain-syntax"> performs this job. In particular, with A in the range 32-126 these are the 'printable'</span>
<span class="ACME-plain-syntax"> characters. They result in a visual character appearing on screen. They almost match the</span>
<span class="ACME-plain-syntax"> standard 7-bit ASCII character set. The exception being ASCII CODE 96 '`' (GRAVE ACCENT)</span>
<span class="ACME-plain-syntax"> which is not available. When this code is used with OSWRCH, a pound sign 'Â£' is displayed</span>
<span class="ACME-plain-syntax"> instead. For character definitions, see </span><a href="S-s4.html" class="internal">Chapter 4: Character definitions and VDU tables</a><span class="ACME-plain-syntax">.</span>

<span class="ACME-plain-syntax"> Additionally, MODE 7 (the TELETEXT mode) has a different character set from ASCII, which</span>
<span class="ACME-plain-syntax"> means 10 of the ASCII printable characters can't be displayed. Substitutions are made</span>
<span class="ACME-plain-syntax"> as follows:</span>

<span class="ACME-plain-syntax">     ASCII CODE 91  '[' is displayed as an arrow pointing left</span>
<span class="ACME-plain-syntax">     ASCII CODE 92  '\' is displayed as the fraction 1/2</span>
<span class="ACME-plain-syntax">     ASCII CODE 93  ']' is displayed as an arrow pointing right</span>
<span class="ACME-plain-syntax">     ASCII CODE 94  '^' is displayed as an arrow pointing up</span>
<span class="ACME-plain-syntax">     ASCII CODE 95  '_' is displayed as a dash</span>
<span class="ACME-plain-syntax">     ASCII CODE 96  '`' is displayed as a pound sign</span>
<span class="ACME-plain-syntax">     ASCII CODE 123 '{' is displayed as the fraction 1/4</span>
<span class="ACME-plain-syntax">     ASCII CODE 124 '|' is displayed as a double vertical bar</span>
<span class="ACME-plain-syntax">     ASCII CODE 125 '}' is displayed as the fraction 3/4</span>
<span class="ACME-plain-syntax">     ASCII CODE 126 '~' is displayed as the divide symbol</span>

<span class="ACME-plain-syntax"> Note that when writing directly to the display memory in MODE 7 this gives different</span>
<span class="ACME-plain-syntax"> results in three cases to printing via OSWRCH. See .</span><a href="S-s4.html#SP16" class="internal">teletextCharacterConversionTable</a>

<span class="ACME-plain-syntax"> The character being output is interpreted as below:</span>

<span class="ACME-plain-syntax"> Character Range   Description</span>
<span class="ACME-plain-syntax">   0-31            Control characters, which are interpreted as a whole range of special</span>
<span class="ACME-plain-syntax">                   commands. Multiple bytes may need to be output to complete the</span>
<span class="ACME-plain-syntax">                   command. Each VDU command is described at it's own entry point</span>
<span class="ACME-plain-syntax">                   which are listed in a table (See .</span><a href="S-s4.html#SP6" class="internal">vduEntryPointTableLow</a><span class="ACME-plain-syntax">).</span>
<span class="ACME-plain-syntax">   32-126          Printable ASCII(-ish) characters as described above.</span>
<span class="ACME-plain-syntax">   127             Delete character. Attempts to remove the previous printed character</span>
<span class="ACME-plain-syntax">                   from the screen at the text or graphics cursor (whichever is active).</span>
<span class="ACME-plain-syntax">   128-255         Available for users programs as soft characters (see .</span><a href="S-s7.html#SP2" class="internal">osbyte20EntryPoint</a><span class="ACME-plain-syntax">).</span>
<span class="ACME-plain-syntax">                   In MODE 7 these control the appearance of Teletext characters.</span>
</pre>
<p class="commentary firstcommentary"><a id="SP2" class="paragraph-anchor"></a><b>&#167;2. VDUCHR entry point. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This is a limited version of OSWRCH that assumes output is to the display only, not to</span>
<span class="ACME-plain-syntax"> Econet, the printer, RS-423, nor SPOOLed to a file. It assumes the VDU drivers are enabled.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vduChrEntryPoint</span><button class="popup" onclick="togglePopup('usagePopup1')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup1">Usage of <span class="code-font"><span class="ACME-function-syntax">vduChrEntryPoint</span></span>:<br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a><br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP1">&#167;1</a><br/>Chapter 24: OS entry points; Tube; FRED; JIM; SHEILA - <a href="S-s24.html#SP6">&#167;6</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c4c0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">twosComplimentOfNumberOfBytesInVDUQueue</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">get the number of items in the VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">queue</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">vduParametersAreOutstanding</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (parameters are still needed)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (cursor editing mode is NOT</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">active) then branch forward</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">handle cursor editing mode...</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP9" class="function-link"><span class="ACME-function-syntax">exchangeTextCursorAndInputCursorValues</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">temporarily swap the text cursor and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">input cursor coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">setUpWriteCursor</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">set up write cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (display is disabled) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charRETURN</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (character is not RETURN) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP9" class="function-link"><span class="ACME-function-syntax">terminateEdit</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">terminate editing</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP3" class="function-link"><span class="ACME-function-syntax">handleDeleteCharacter</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (character is DELETE) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax">                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP3" class="function-link"><span class="ACME-function-syntax">readVDUEntryPointAddressAndParameters</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">if (character less than space, i.e.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">a VDU control code) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte again</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (screen disabled) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP25" class="function-link"><span class="ACME-function-syntax">displayACharacter</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">display a character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP25" class="function-link"><span class="ACME-function-syntax">vdu9EntryPoint</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">and cursor right</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP8" class="function-link"><span class="ACME-function-syntax">exitVDUCHR</span></a><span class="ACME-plain-syntax">                                     </span>
</pre>
<p class="commentary firstcommentary"><a id="SP3" class="paragraph-anchor"></a><b>&#167;3. handleDeleteCharacter. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">handleDeleteCharacter</span><button class="popup" onclick="togglePopup('usagePopup2')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup2">Usage of <span class="code-font"><span class="ACME-function-syntax">handleDeleteCharacter</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c4ed</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s4.html#SP6" class="function-link"><span class="ACME-function-syntax">vduEntryPointTableDelete</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP6" class="function-link"><span class="ACME-function-syntax">vduEntryPointTableLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">index to read the vdu entry</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">point table for DELETE</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">readVDUEntryPointAddressAndParameters</span><button class="popup" onclick="togglePopup('usagePopup3')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup3">Usage of <span class="code-font"><span class="ACME-function-syntax">readVDUEntryPointAddressAndParameters</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c4ef</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store the VDU number in Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP6" class="function-link"><span class="ACME-function-syntax">vduEntryPointTableLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get low byte of entry point address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorLow</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">store it in jump vector</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP7" class="function-link"><span class="ACME-function-syntax">vduEntryPointTableHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get high byte of entry point address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP7" class="function-link"><span class="ACME-function-syntax">explicitAddressNoParameters</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (a direct access with no</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">parameters) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%11110000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">set up negated parameter count (set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bits in top nybble)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">twosComplimentOfNumberOfBytesInVDUQueue</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">store it back as number of items in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">VDU queue</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} get high nybble into low nybble</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s4.html#SP2" class="function-link"><span class="ACME-function-syntax">vduBaseAddress</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">add base address (high byte) to get</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">high byte of VDU entry point address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorHigh</span></a><span class="ACME-plain-syntax">                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">check for cursor editing mode enabled</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">reexchangeCursorsAndExit</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">if (cursor editing mode enabled)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (re-exchange cursors)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP4" class="paragraph-anchor"></a><b>&#167;4. VDU 0 / 6 / 27      Empty handlers. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">   VDU 0  - Does nothing</span>
<span class="ACME-plain-syntax">   VDU 6  - Enable VDU drivers (re-enabling is handled prior to here, see .</span><a href="S-s5.html#SP10" class="internal">checkForVDUReenable</a><span class="ACME-plain-syntax">)</span>
<span class="ACME-plain-syntax">   VDU 27 - ESCAPE code, does nothing</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu0EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup4')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup4">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu0EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c511</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu6EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup5')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup5">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu6EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c511</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu27EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup6')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup6">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu27EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c511</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit</span><button class="popup" onclick="togglePopup('usagePopup7')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup7">Usage of <span class="code-font"><span class="ACME-function-syntax">exit</span></span>:<br/><a href="S-s5.html#SP5">&#167;5</a>, <a href="S-s5.html#SP6">&#167;6</a>, <a href="S-s5.html#SP8">&#167;8</a>, <a href="S-s5.html#SP10">&#167;10</a>, <a href="S-s5.html#SP17">&#167;17</a>, <a href="S-s5.html#SP18">&#167;18</a>, <a href="S-s5.html#SP21">&#167;21</a>, <a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP38">&#167;38</a>, <a href="S-s5.html#SP41">&#167;41</a>, <a href="S-s5.html#SP43">&#167;43</a>, <a href="S-s5.html#SP52">&#167;52</a>, <a href="S-s5.html#SP61">&#167;61</a>, <a href="S-s5.html#SP63">&#167;63</a>, <a href="S-s5.html#SP69">&#167;69</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP4">&#167;4</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP4">&#167;4</a>, <a href="S-s7.html#SP7">&#167;7</a>, <a href="S-s7.html#SP8">&#167;8</a>, <a href="S-s7.html#SP16">&#167;16</a><br/>Chapter 8: PLOT - <a href="S-s8.html#SP16">&#167;16</a>, <a href="S-s8.html#SP45">&#167;45</a>, <a href="S-s8.html#SP47">&#167;47</a>, <a href="S-s8.html#SP48">&#167;48</a>, <a href="S-s8.html#SP64">&#167;64</a>, <a href="S-s8.html#SP67">&#167;67</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP4">&#167;4</a>, <a href="S-s9.html#SP6">&#167;6</a>, <a href="S-s9.html#SP7">&#167;7</a>, <a href="S-s9.html#SP8">&#167;8</a><br/>Chapter 10: Resets - <a href="S-s10.html#SP4">&#167;4</a>, <a href="S-s10.html#SP30">&#167;30</a><br/>Chapter 11: Interrupt processing - <a href="S-s11.html#SP6">&#167;6</a>, <a href="S-s11.html#SP11">&#167;11</a>, <a href="S-s11.html#SP12">&#167;12</a>, <a href="S-s11.html#SP13">&#167;13</a>, <a href="S-s11.html#SP15">&#167;15</a>, <a href="S-s11.html#SP17">&#167;17</a><br/>Chapter 12: Command Line Interpreter (star commands) - <a href="S-s12.html#SP2">&#167;2</a>, <a href="S-s12.html#SP5">&#167;5</a>, <a href="S-s12.html#SP9">&#167;9</a>, <a href="S-s12.html#SP13">&#167;13</a>, <a href="S-s12.html#SP18">&#167;18</a>, <a href="S-s12.html#SP22">&#167;22</a><br/>Chapter 13: Writing characters; printer; buffers - <a href="S-s13.html#SP1">&#167;1</a>, <a href="S-s13.html#SP2">&#167;2</a>, <a href="S-s13.html#SP3">&#167;3</a>, <a href="S-s13.html#SP8">&#167;8</a>, <a href="S-s13.html#SP11">&#167;11</a>, <a href="S-s13.html#SP12">&#167;12</a><br/>Chapter 14: Star commands - <a href="S-s14.html#SP2">&#167;2</a>, <a href="S-s14.html#SP7">&#167;7</a>, <a href="S-s14.html#SP9">&#167;9</a>, <a href="S-s14.html#SP10">&#167;10</a>, <a href="S-s14.html#SP15">&#167;15</a>, <a href="S-s14.html#SP24">&#167;24</a>, <a href="S-s14.html#SP25">&#167;25</a>, <a href="S-s14.html#SP29">&#167;29</a>, <a href="S-s14.html#SP31">&#167;31</a>, <a href="S-s14.html#SP32">&#167;32</a>, <a href="S-s14.html#SP34">&#167;34</a>, <a href="S-s14.html#SP35">&#167;35</a><br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP9">&#167;9</a>, <a href="S-s15.html#SP14">&#167;14</a>, <a href="S-s15.html#SP17">&#167;17</a>, <a href="S-s15.html#SP19">&#167;19</a>, <a href="S-s15.html#SP20">&#167;20</a>, <a href="S-s15.html#SP22">&#167;22</a>, <a href="S-s15.html#SP25">&#167;25</a>, <a href="S-s15.html#SP30">&#167;30</a>, <a href="S-s15.html#SP31">&#167;31</a>, <a href="S-s15.html#SP34">&#167;34</a>, <a href="S-s15.html#SP42">&#167;42</a>, <a href="S-s15.html#SP45">&#167;45</a>, <a href="S-s15.html#SP46">&#167;46</a>, <a href="S-s15.html#SP65">&#167;65</a>, <a href="S-s15.html#SP66">&#167;66</a><br/>Chapter 16: Sound and Speech - <a href="S-s16.html#SP13">&#167;13</a>, <a href="S-s16.html#SP15">&#167;15</a><br/>Chapter 17: Keyboard processing - <a href="S-s17.html#SP6">&#167;6</a>, <a href="S-s17.html#SP10">&#167;10</a>, <a href="S-s17.html#SP11">&#167;11</a><br/>Chapter 18: Tape and ROM Filing systems - <a href="S-s18.html#SP5">&#167;5</a>, <a href="S-s18.html#SP8">&#167;8</a>, <a href="S-s18.html#SP17">&#167;17</a>, <a href="S-s18.html#SP18">&#167;18</a>, <a href="S-s18.html#SP26">&#167;26</a>, <a href="S-s18.html#SP28">&#167;28</a>, <a href="S-s18.html#SP29">&#167;29</a>, <a href="S-s18.html#SP31">&#167;31</a>, <a href="S-s18.html#SP33">&#167;33</a>, <a href="S-s18.html#SP35">&#167;35</a><br/>Chapter 19: Low Level Tape Operations - <a href="S-s19.html#SP2">&#167;2</a>, <a href="S-s19.html#SP3">&#167;3</a>, <a href="S-s19.html#SP4">&#167;4</a>, <a href="S-s19.html#SP5">&#167;5</a>, <a href="S-s19.html#SP6">&#167;6</a>, <a href="S-s19.html#SP11">&#167;11</a>, <a href="S-s19.html#SP12">&#167;12</a>, <a href="S-s19.html#SP17">&#167;17</a><br/>Chapter 20: Filing System Messaging and Error Reporting - <a href="S-s20.html#SP3">&#167;3</a>, <a href="S-s20.html#SP5">&#167;5</a>, <a href="S-s20.html#SP14">&#167;14</a>, <a href="S-s20.html#SP18">&#167;18</a><br/>Chapter 21: More Low Level Tape Operations - <a href="S-s21.html#SP3">&#167;3</a>, <a href="S-s21.html#SP17">&#167;17</a>, <a href="S-s21.html#SP18">&#167;18</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c511</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP5" class="paragraph-anchor"></a><b>&#167;5. vduParametersAreOutstanding. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vduParametersAreOutstanding</span><button class="popup" onclick="togglePopup('usagePopup8')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup8">Usage of <span class="code-font"><span class="ACME-function-syntax">vduParametersAreOutstanding</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c512</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-identifier-syntax">-</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">store parameter in vdu queue</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(X = 256 - number of parameters</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">i.e. X=$FF for 1, $FE for 2 etc.)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">twosComplimentOfNumberOfBytesInVDUQueue</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">store it as number of bytes in VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">queue (2's complement)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">clearCarryAndExit</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (more parameters are needed) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">preVDU1</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">if (VDU disabled) then branch to VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">1 code</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">handleCursorEditing</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (cursor editing mode) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP5" class="function-link"><span class="ACME-function-syntax">executeRequiredVDUFunction</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">execute required function for VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">command</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">handleCursorEditing</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c526</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP9" class="function-link"><span class="ACME-function-syntax">exchangeTextCursorAndInputCursorValues</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">swap values of cursors</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP6" class="function-link"><span class="ACME-function-syntax">setUpWriteCursor</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">set up write cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP5" class="function-link"><span class="ACME-function-syntax">executeRequiredVDUFunction</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">execute required function for VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">command</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">reexchangeCursorsAndExit</span><button class="popup" onclick="togglePopup('usagePopup9')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup9">Usage of <span class="code-font"><span class="ACME-function-syntax">reexchangeCursorsAndExit</span></span>:<br/><a href="S-s5.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c52f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP9" class="function-link"><span class="ACME-function-syntax">reswapCursorsBack</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">re-exchange cursors</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearCarryAndExit</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c532</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">carry clear</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">preVDU1</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c534</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorHigh</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">check the upper byte of entry point</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s5.html#SP6" class="function-link"><span class="ACME-function-syntax">vdu1EntryPoint</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">check for the default handler</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP5" class="function-link"><span class="ACME-function-syntax">clearCarryAndExit</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (not the default handler) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP6" class="paragraph-anchor"></a><b>&#167;6. VDU 1       Send next byte to printer only. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu1EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup10')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup10">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu1EntryPoint</span></span>:<br/><a href="S-s5.html#SP5">&#167;5</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c53b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remember A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">get VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get bit 0 into carry (printer</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">enabled bit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP4" class="function-link"><span class="ACME-function-syntax">exit</span></a><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">if (printer not enabled) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP2" class="function-link"><span class="ACME-function-syntax">sendValidByteToPrinter</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">send byte in A (next byte) to printer</span>
</pre>
<p class="commentary firstcommentary"><a id="SP7" class="paragraph-anchor"></a><b>&#167;7. explicitAddressNoParameters. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">explicitAddressNoParameters</span><button class="popup" onclick="togglePopup('usagePopup11')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup11">Usage of <span class="code-font"><span class="ACME-function-syntax">explicitAddressNoParameters</span></span>:<br/><a href="S-s5.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c545</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduJumpVectorHigh</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">upper byte of link address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A (the VDU number)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">set carry if VDU number is within range 8-13 (cursor movement)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #8                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (VDU number &lt; 8) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(carry clear)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">invert value</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$F2</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">if (VDU number &gt; 13) then clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">re-invert value back again</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP10" class="function-link"><span class="ACME-function-syntax">checkForVDUReenable</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">if (VDU disabled) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP5" class="function-link"><span class="ACME-function-syntax">executeRequiredVDUFunction</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">execute required function</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags back</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not VDU 8-13 cursor movement)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (skip 'printer enabled'</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">check)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP8" class="paragraph-anchor"></a><b>&#167;8. exitVDUCHR. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exitVDUCHR</span><button class="popup" onclick="togglePopup('usagePopup12')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup12">Usage of <span class="code-font"><span class="ACME-function-syntax">exitVDUCHR</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c55e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">read VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">carry is set if printer is enabled</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BVC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP4" class="function-link"><span class="ACME-function-syntax">exit</span></a><span class="ACME-plain-syntax">                                           </span><span class="ACME-comment-syntax">if (no cursor editing mode) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP9" class="paragraph-anchor"></a><b>&#167;9. reswapCursorsBack. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">reswapCursorsBack</span><button class="popup" onclick="togglePopup('usagePopup13')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup13">Usage of <span class="code-font"><span class="ACME-function-syntax">reswapCursorsBack</span></span>:<br/><a href="S-s5.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c565</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP7" class="function-link"><span class="ACME-function-syntax">restoreWriteCursor</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">restore normal write cursor</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeTextCursorAndInputCursorValues</span><button class="popup" onclick="togglePopup('usagePopup14')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup14">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeTextCursorAndInputCursorValues</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a>, <a href="S-s5.html#SP5">&#167;5</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c568</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">offset within VDU variables</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">for text cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextInputCursorXCoordinate</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">offset within VDU variables</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">for text input cursor</span>
<span class="ACME-plain-syntax">                                                                </span><span class="ACME-comment-syntax">position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP10" class="function-link"><span class="ACME-function-syntax">exchangeTwoVDUBytes</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">exchange current text cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates with text input cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">coordinates</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set cursor screen addresses</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP58" class="function-link"><span class="ACME-function-syntax">setHardwareCursorAddress</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">set cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">get VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000010</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">invert bit 1 to allow or inhibit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">scrolling</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">store VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP10" class="paragraph-anchor"></a><b>&#167;10. checkForVDUReenable. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">checkForVDUReenable</span><button class="popup" onclick="togglePopup('usagePopup15')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup15">Usage of <span class="code-font"><span class="ACME-function-syntax">checkForVDUReenable</span></span>:<br/><a href="S-s5.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c580</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">check for VDU 6 (to reenable output</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to the display)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">exit1</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (not VDU 6) then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01111111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">set A to clear the top bit of the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP16" class="function-link"><span class="ACME-function-syntax">clearVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">ALWAYS branch, clearing the top bit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(enabling output to the display</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">again)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP11" class="paragraph-anchor"></a><b>&#167;11. Check whether the text or graphics cursor is active. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">    A = 0   if text cursor is active           (Z flag set)</span>
<span class="ACME-plain-syntax">    A = $20 otherwise (graphics cursor active) (Z flag clear)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">isTextCursorActive</span><button class="popup" onclick="togglePopup('usagePopup16')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup16">Usage of <span class="code-font"><span class="ACME-function-syntax">isTextCursorActive</span></span>:<br/><a href="S-s5.html#SP19">&#167;19</a>, <a href="S-s5.html#SP24">&#167;24</a>, <a href="S-s5.html#SP32">&#167;32</a>, <a href="S-s5.html#SP36">&#167;36</a>, <a href="S-s5.html#SP37">&#167;37</a>, <a href="S-s5.html#SP38">&#167;38</a>, <a href="S-s5.html#SP39">&#167;39</a>, <a href="S-s5.html#SP52">&#167;52</a>, <a href="S-s5.html#SP65">&#167;65</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c588</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">test bit 5 of status byte</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit1</span><button class="popup" onclick="togglePopup('usagePopup17')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup17">Usage of <span class="code-font"><span class="ACME-function-syntax">exit1</span></span>:<br/><a href="S-s5.html#SP10">&#167;10</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c58c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP12" class="paragraph-anchor"></a><b>&#167;12. VDU 14    Set paged mode. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu14EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup18')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup18">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu14EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c58d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y = 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">paged mode counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">A = 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP14" class="function-link"><span class="ACME-function-syntax">setVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP13" class="paragraph-anchor"></a><b>&#167;13. VDU 2     Printer On. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu2EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup19')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup19">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu2EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c596</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP9" class="function-link"><span class="ACME-function-syntax">printerServiceCall</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">select printer buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$94</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$94 when inverted at next</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">statement this = 1</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">thereby setting bit 0 of the VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">status byte (printer output enable)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP14" class="paragraph-anchor"></a><b>&#167;14. VDU 21    Disable VDU drivers. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Output to the VDU is disabled (until a VDU 6 is used to re-enable output).</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu21EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup20')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup20">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu21EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c59b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$95</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">if A=21  (entry from VDU 21) then A</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">= $80</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">if A=$94 (entry from VDU 2)  then A</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">= 1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setVDUStatusByteFlags</span><button class="popup" onclick="togglePopup('usagePopup21')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup21">Usage of <span class="code-font"><span class="ACME-function-syntax">setVDUStatusByteFlags</span></span>:<br/><a href="S-s5.html#SP12">&#167;12</a>, <a href="S-s5.html#SP18">&#167;18</a>, <a href="S-s5.html#SP33">&#167;33</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c59d</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte set bit 0 or bit 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP16" class="function-link"><span class="ACME-function-syntax">storeVDUStatusByteAndReturn</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">ALWAYS branch (since A != 0)</span>
</pre>
<p class="commentary firstcommentary"><a id="SP15" class="paragraph-anchor"></a><b>&#167;15. VDU 3     Printer off. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu3EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup22')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup22">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu3EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5a1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s13.html#SP9" class="function-link"><span class="ACME-function-syntax">printerServiceCall</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">select printer buffer</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #10                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP16" class="paragraph-anchor"></a><b>&#167;16. VDU 15    Paged mode off. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = 15  paged mode off</span>
<span class="ACME-plain-syntax">       A = 10  printer off</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu15EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup23')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup23">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu15EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5a6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$F4</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">convert to $FB or $FE to clear</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bit 2 or 1 respectively</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearVDUStatusByteFlags</span><button class="popup" onclick="togglePopup('usagePopup24')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup24">Usage of <span class="code-font"><span class="ACME-function-syntax">clearVDUStatusByteFlags</span></span>:<br/><a href="S-s5.html#SP10">&#167;10</a>, <a href="S-s5.html#SP17">&#167;17</a>, <a href="S-s5.html#SP57">&#167;57</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a>, <a href="S-s9.html#SP9">&#167;9</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5a8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">AND with VDU status byte</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">storeVDUStatusByteAndReturn</span><button class="popup" onclick="togglePopup('usagePopup25')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup25">Usage of <span class="code-font"><span class="ACME-function-syntax">storeVDUStatusByteAndReturn</span></span>:<br/><a href="S-s5.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5aa</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">store VDU status byte</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP17" class="paragraph-anchor"></a><b>&#167;17. VDU 4       Select text cursor. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> At all times either the text cursor is active or the graphics cursor is active</span>
<span class="ACME-plain-syntax"> Characters are either drawn normally in text cells (at the text cursor) or at any pixel</span>
<span class="ACME-plain-syntax"> position (the graphics cursor)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu4EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup26')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup26">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu4EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5ad</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">pixels per byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not in graphics MODE) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP52" class="function-link"><span class="ACME-function-syntax">setTextCursor</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">set text cursor (CRTC hardware)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%11011111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">clear bit 5 (graphics cursor bit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP16" class="function-link"><span class="ACME-function-syntax">clearVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">ALWAYS branch - clear bit 5 and exit</span>
</pre>
<p class="commentary firstcommentary"><a id="SP18" class="paragraph-anchor"></a><b>&#167;18. VDU 5       Select graphics cursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu5EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup27')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup27">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu5EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5b9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">pixels per byte minus one</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not in graphics MODE) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #32                                             </span><span class="ACME-comment-syntax">cursor setting</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP52" class="function-link"><span class="ACME-function-syntax">setCursorOnOrOff</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">turn off cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP14" class="function-link"><span class="ACME-function-syntax">setVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">ALWAYS branch - set bit 5 of VDU</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">status byte and exit</span>
</pre>
<p class="commentary firstcommentary"><a id="SP19" class="paragraph-anchor"></a><b>&#167;19. VDU 8       Cursor left (.charBACKSPACE). </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu8EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup28')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup28">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu8EntryPoint</span></span>:<br/><a href="S-s5.html#SP65">&#167;65</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5c5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> or A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP22" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorLeftEightPixels</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">if (currently in graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">mode) then branch (to move cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">left 8 pixels)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">decrement text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">get new text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">check against left of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP20" class="function-link"><span class="ACME-function-syntax">wrapFromLeftEdgeToRightEdgeOfTextWindow</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">if (less than left edge of text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window) then branch (wrap to right</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">edge and one line up)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">get text cursor CRTC address (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">subtract bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">get text cursor CRTC address (high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">subtract 0 + carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduStartScreenAddressHighByte</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">compare with high byte of screen</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">RAM address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (text cursor is not below the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">start of the screen address) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">add screen RAM size high byte to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">wrap back onto screen</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP57" class="function-link"><span class="ACME-function-syntax">setTextCursorCRTCAddress</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">A high and X low byte of cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">address</span>
</pre>
<p class="commentary firstcommentary"><a id="SP20" class="paragraph-anchor"></a><b>&#167;20. wrapFromLeftEdgeToRightEdgeOfTextWindow. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">wrapFromLeftEdgeToRightEdgeOfTextWindow</span><button class="popup" onclick="togglePopup('usagePopup29')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup29">Usage of <span class="code-font"><span class="ACME-function-syntax">wrapFromLeftEdgeToRightEdgeOfTextWindow</span></span>:<br/><a href="S-s5.html#SP19">&#167;19</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5ee</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">load text window right edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">set current text column</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">cursorUp</span><button class="popup" onclick="togglePopup('usagePopup30')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup30">Usage of <span class="code-font"><span class="ACME-function-syntax">cursorUp</span></span>:<br/><a href="S-s5.html#SP24">&#167;24</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c5f4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">paged mode counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not less than zero) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(skip next instruction)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">paged mode counter to restore X=0</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">top of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP21" class="function-link"><span class="ACME-function-syntax">cursorAtTopOfTextWindow</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">if (it's at the top of the text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">decrement current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP29" class="function-link"><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">set cursor position</span>
</pre>
<p class="commentary firstcommentary"><a id="SP21" class="paragraph-anchor"></a><b>&#167;21. cursorAtTopOfTextWindow. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">cursorAtTopOfTextWindow</span><button class="popup" onclick="togglePopup('usagePopup31')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup31">Usage of <span class="code-font"><span class="ACME-function-syntax">cursorAtTopOfTextWindow</span></span>:<br/><a href="S-s5.html#SP20">&#167;20</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c60a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP3" class="function-link"><span class="ACME-function-syntax">moveTextCursorToNextLine</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">move cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">A=8 to check for software scrolling</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (software scrolling enabled) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP56" class="function-link"><span class="ACME-function-syntax">hardwareScrollDown</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">scroll down</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP21" class="function-link"><span class="ACME-function-syntax">skipScrolling</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP9" class="function-link"><span class="ACME-function-syntax">scrollTextWindowDownwards</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">soft scroll 1 line</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">skipScrolling</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c61c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP28" class="function-link"><span class="ACME-function-syntax">clearOneLineAndPositionCursor</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">clear one line and exit</span>
</pre>
<p class="commentary firstcommentary"><a id="SP22" class="paragraph-anchor"></a><b>&#167;22. moveGraphicsCursorLeftEightPixels. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorLeftEightPixels</span><button class="popup" onclick="togglePopup('usagePopup32')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup32">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorLeftEightPixels</span></span>:<br/><a href="S-s5.html#SP19">&#167;19</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c61f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X = 0 to select horizontal movement</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(move left)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP23" class="paragraph-anchor"></a><b>&#167;23. Move graphics cursor (left or down). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = 0 to move left or</span>
<span class="ACME-plain-syntax">       X = 2 to move down</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorLeftOrDownEightPixels</span><button class="popup" onclick="togglePopup('usagePopup33')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup33">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorLeftOrDownEightPixels</span></span>:<br/><a href="S-s5.html#SP32">&#167;32</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c621</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">check window bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">restore X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">current graphics cursor (X=2 for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">vertical movement)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">subtract 8 to move back/down 1</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">store in current graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(X=2 for vertical movement)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry set, no need to adjust</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">high byte) then branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">decrement high byte of graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cursor</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">check the old graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP23" class="function-link"><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (old graphics position out of the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics window bounds) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">check the new graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP23" class="function-link"><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (not out of bounds now) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">this is the case where the old coordinates were within the window, but now are not.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">when moving left, then move up and clamp to the right edge.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">when moving down, clamp to the top edge.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get back X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsRightLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">get graphics window right (X=0) or</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">top (X=2)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #1                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (moving down) then branch forward</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">moving left. A = A - 7 (note carry</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is clear)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">current graphics cursor position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(X=2 means vertical)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsRightHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">graphics window right (X=0) or top</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(X=2) high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">subtract carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">current graphics cursor position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(X=2 means vertical)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP24" class="function-link"><span class="ACME-function-syntax">graphicsCursorUpEightPixels</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">if (moving left) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(because we've hit the left edge,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">move graphics cursor up)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span><button class="popup" onclick="togglePopup('usagePopup34')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup34">Usage of <span class="code-font"><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span></span>:<br/><a href="S-s5.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c658</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">set up external coordinates for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics</span>
</pre>
<p class="commentary firstcommentary"><a id="SP24" class="paragraph-anchor"></a><b>&#167;24. VDU 11       Cursor up. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu11EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup35')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup35">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu11EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c65b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP20" class="function-link"><span class="ACME-function-syntax">cursorUp</span></a><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">if (text cursor is active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">graphicsCursorUpEightPixels</span><button class="popup" onclick="togglePopup('usagePopup36')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup36">Usage of <span class="code-font"><span class="ACME-function-syntax">graphicsCursorUpEightPixels</span></span>:<br/><a href="S-s5.html#SP23">&#167;23</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c660</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">set X = 2 for moving graphics cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">UP</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP31" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorUpOrRightEightPixels</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP25" class="paragraph-anchor"></a><b>&#167;25. VDU 9        Cursor right. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu9EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup37')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup37">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu9EntryPoint</span></span>:<br/><a href="S-s5.html#SP2">&#167;2</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP8">&#167;8</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c664</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">get VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check bit 5 (graphics cursor)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP30" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorRightEightPixels</span></a><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">if (graphics cursor in use) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">text window right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP26" class="function-link"><span class="ACME-function-syntax">moveTextCursorToLeftEdgeAndDown</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (X exceeds window right) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">text cursor CRTC address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">add bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = new low byte of CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text cursor CRTC address high</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">add carry. A = new high byte of CRTC</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP57" class="function-link"><span class="ACME-function-syntax">setTextCursorCRTCAddress</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">use X and A to set new text cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">CRTC address</span>
</pre>
<p class="commentary firstcommentary"><a id="SP26" class="paragraph-anchor"></a><b>&#167;26. moveTextCursorToLeftEdgeAndDown. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveTextCursorToLeftEdgeAndDown</span><button class="popup" onclick="togglePopup('usagePopup38')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup38">Usage of <span class="code-font"><span class="ACME-function-syntax">moveTextCursorToLeftEdgeAndDown</span></span>:<br/><a href="S-s5.html#SP25">&#167;25</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c684</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP27" class="paragraph-anchor"></a><b>&#167;27. moveTextCursorDown. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveTextCursorDown</span><button class="popup" onclick="togglePopup('usagePopup39')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup39">Usage of <span class="code-font"><span class="ACME-function-syntax">moveTextCursorDown</span></span>:<br/><a href="S-s5.html#SP32">&#167;32</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c68a</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP69" class="function-link"><span class="ACME-function-syntax">handleScrollingInPagedModeInternal</span></a><span class="ACME-plain-syntax">             </span><span class="ACME-comment-syntax">check text window bottom edge,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">X=line count</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (current text Y position =&gt;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">bottom edge) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">increment current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP29" class="function-link"><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">ALWAYS branch (set cursor position)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP3" class="function-link"><span class="ACME-function-syntax">moveTextCursorToNextLine</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">move cursor to next line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check bit 3 (software scrolling)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">test VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (software scrolling enabled) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP56" class="function-link"><span class="ACME-function-syntax">hardwareScrollUp</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">perform hardware scroll</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP28" class="function-link"><span class="ACME-function-syntax">clearOneLineAndPositionCursor</span></a><span class="ACME-plain-syntax">                  </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP14" class="function-link"><span class="ACME-function-syntax">scrollTextWindowUpwards</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">execute upward software scroll</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP28" class="paragraph-anchor"></a><b>&#167;28. clearOneLineAndPositionCursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearOneLineAndPositionCursor</span><button class="popup" onclick="togglePopup('usagePopup40')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup40">Usage of <span class="code-font"><span class="ACME-function-syntax">clearOneLineAndPositionCursor</span></span>:<br/><a href="S-s5.html#SP21">&#167;21</a>, <a href="S-s5.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6ac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">clearOneLine</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">clear a line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP29" class="paragraph-anchor"></a><b>&#167;29. Set cursor address. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Calculates cursor screen addresses and sets the hardware</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span><button class="popup" onclick="togglePopup('usagePopup41')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup41">Usage of <span class="code-font"><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span></span>:<br/><a href="S-s5.html#SP20">&#167;20</a>, <a href="S-s5.html#SP27">&#167;27</a>, <a href="S-s5.html#SP39">&#167;39</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP3">&#167;3</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6af</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP21" class="function-link"><span class="ACME-function-syntax">setTextCursorScreenAddresses</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set cursor screen addresses</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">setHardwareCursorAddressLocal</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP30" class="paragraph-anchor"></a><b>&#167;30. moveGraphicsCursorRightEightPixels. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorRightEightPixels</span><button class="popup" onclick="togglePopup('usagePopup42')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup42">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorRightEightPixels</span></span>:<br/><a href="S-s5.html#SP25">&#167;25</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6b4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X=0 for move cursor right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP31" class="paragraph-anchor"></a><b>&#167;31. Move graphics cursor (up or right). </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       X = 0 means move graphics cursor right</span>
<span class="ACME-plain-syntax">       X = 2 means move graphics cursor up</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">moveGraphicsCursorUpOrRightEightPixels</span><button class="popup" onclick="togglePopup('usagePopup43')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup43">Usage of <span class="code-font"><span class="ACME-function-syntax">moveGraphicsCursorUpOrRightEightPixels</span></span>:<br/><a href="S-s5.html#SP24">&#167;24</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6b6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">check window bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">recall X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">get current graphics cursor (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #8                                              </span><span class="ACME-comment-syntax">add 8 pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set current graphics cursor (low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">set current graphics cursor (high)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">A=0 no window violations, 1 or 2</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">indicates violation</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP23" class="function-link"><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (outside graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP15" class="function-link"><span class="ACME-function-syntax">checkGraphicsCursorIsWithinGraphicsWindow</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">check window bounds</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP23" class="function-link"><span class="ACME-function-syntax">setUpExternalGraphicsCoordinates</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (within graphics window) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDB</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get back X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">get left/bottom edge of graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window (low) (X=0 means left,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">else X=2 means bottom)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #1                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (X is 0; hit left edge) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #6                                              </span><span class="ACME-comment-syntax">A = A + 7 (including carry)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXLow</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set current graphics cursor position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(low)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">get left edge (high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">add carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPixelsXHigh</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">set current graphics cursor position</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(high)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP32" class="function-link"><span class="ACME-function-syntax">graphicsCursorDown</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (X = 0) then branch (move</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics cursor down)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">      </span><span class="ACME-comment-syntax">set up external coordinates for</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">graphics</span>
</pre>
<p class="commentary firstcommentary"><a id="SP32" class="paragraph-anchor"></a><b>&#167;32. VDU 10       Cursor down. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu10EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup44')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup44">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu10EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6f0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP27" class="function-link"><span class="ACME-function-syntax">moveTextCursorDown</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">if (text cursor active) then branch</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">graphicsCursorDown</span><button class="popup" onclick="togglePopup('usagePopup45')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup45">Usage of <span class="code-font"><span class="ACME-function-syntax">graphicsCursorDown</span></span>:<br/><a href="S-s5.html#SP31">&#167;31</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6f5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">X = 2 to indicate movement down</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP23" class="function-link"><span class="ACME-function-syntax">moveGraphicsCursorLeftOrDownEightPixels</span></a><span class="ACME-plain-syntax">        </span><span class="ACME-comment-syntax">move graphics cursor down</span>
</pre>
<p class="commentary firstcommentary"><a id="SP33" class="paragraph-anchor"></a><b>&#167;33. VDU 28       Define Text Window. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> A sub-rectangle on screen can be defined that limits where text can be drawn.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu28ParamLeftEdge</span><span class="ACME-plain-syntax">   = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu28ParamBottomEdge</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu28ParamRightEdge</span><span class="ACME-plain-syntax">  = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu28ParamTopEdge</span><span class="ACME-plain-syntax">    = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>
<span class="ACME-comment-syntax">Note that last parameter is always in 0323</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu28EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup46')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup46">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu28EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c6fa</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODE</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">get current screen MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">vdu28ParamBottomEdge</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">get bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">vdu28ParamTopEdge</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">compare with top edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">exit2</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (bottom edge exceeds top edge)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP9" class="function-link"><span class="ACME-function-syntax">textWindowBottomRowTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">check against text window bottom</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">edge maximum</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (on the edge) then branch (it's</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">OK)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">exit2</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (outside bounds) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">vdu28ParamRightEdge</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">get right edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put it in Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP9" class="function-link"><span class="ACME-function-syntax">textWindowRightColumnTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text window right hand edge maximum</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (on the edge) then branch (it's</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">OK)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">exit2</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (outside bounds) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(exit)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry to subtract</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">vdu28ParamLeftEdge</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">left edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">exit2</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (left edge greater than right)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=Y (window width)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP63" class="function-link"><span class="ACME-function-syntax">calculateBytesPerTextWindowRow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">calculate number of bytes in a text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">set bit 3 of .vduStatusByte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP14" class="function-link"><span class="ACME-function-syntax">setVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">indicating that text window is</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">defined</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">vdu28ParamLeftEdge</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">point to parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">point to text window edges</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">copy 4 parameters into the text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window edges</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP20" class="function-link"><span class="ACME-function-syntax">validatePositionAndSetupScreenAddress</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">check ok and set up screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP37" class="function-link"><span class="ACME-function-syntax">vdu30EntryPoint</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">home cursor within window</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setHardwareCursorAddressLocal</span><button class="popup" onclick="togglePopup('usagePopup47')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup47">Usage of <span class="code-font"><span class="ACME-function-syntax">setHardwareCursorAddressLocal</span></span>:<br/><a href="S-s5.html#SP29">&#167;29</a>, <a href="S-s5.html#SP38">&#167;38</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c732</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP58" class="function-link"><span class="ACME-function-syntax">setHardwareCursorAddress</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">set cursor position</span>
</pre>
<p class="commentary firstcommentary"><a id="SP34" class="paragraph-anchor"></a><b>&#167;34. OSWORD 9 - Read a pixel. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       .oswordA = 9</span>
<span class="ACME-plain-syntax">       .oswordX = low byte of parameter block address</span>
<span class="ACME-plain-syntax">       .oswordY = high byte of parameter block address</span>

<span class="ACME-plain-syntax">   .oswordX/Y is the address of the four bytes of parameters:</span>
<span class="ACME-plain-syntax">       byte 0-1: X coordinate</span>
<span class="ACME-plain-syntax">       byte 2-3: Y coordinate</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       Result stored in byte 4 of parameter block:</span>
<span class="ACME-plain-syntax">           $FF if point was off screen, or logical colour of point if on screen</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword9EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup48')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup48">Usage of <span class="code-font"><span class="ACME-function-syntax">osword9EntryPoint</span></span>:<br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c735</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">Y is loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">decrement counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">loop back until done</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s9.html#SP4" class="function-link"><span class="ACME-function-syntax">readPixel</span></a><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">Y=4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">storeAInParameterBlock</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP35" class="paragraph-anchor"></a><b>&#167;35. OSWORD 11 - Read palette. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Y = 0</span>
<span class="ACME-plain-syntax">       .oswordA = 11</span>
<span class="ACME-plain-syntax">       .osWordX = low byte of parameter block address</span>
<span class="ACME-plain-syntax">       .osWordY = high byte of parameter block address</span>

<span class="ACME-plain-syntax">   .oswordX/Y is the address of the four byte parameter block:</span>
<span class="ACME-plain-syntax">       byte 0: logical colour to read</span>

<span class="ACME-plain-syntax"> On Exit:</span>
<span class="ACME-plain-syntax">       byte 0: logical colour</span>
<span class="ACME-plain-syntax">       byte 1: physical colour</span>
<span class="ACME-plain-syntax">       byte 2: zero</span>
<span class="ACME-plain-syntax">       byte 3: zero</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword11EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup49')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup49">Usage of <span class="code-font"><span class="ACME-function-syntax">osword11EntryPoint</span></span>:<br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c748</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put it in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduColourPaletteStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">get value from colour palette</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to point to byte 1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">storeAInParameterBlock</span><button class="popup" onclick="togglePopup('usagePopup50')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup50">Usage of <span class="code-font"><span class="ACME-function-syntax">storeAInParameterBlock</span></span>:<br/><a href="S-s5.html#SP34">&#167;34</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c750</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store data</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">issue 0s</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #4                                              </span><span class="ACME-comment-syntax">to next bytes until Y=4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit2</span><button class="popup" onclick="togglePopup('usagePopup51')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup51">Usage of <span class="code-font"><span class="ACME-function-syntax">exit2</span></span>:<br/><a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP38">&#167;38</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c758</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP36" class="paragraph-anchor"></a><b>&#167;36. VDU 12      Clear text or graphics window. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu12EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup52')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup52">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu12EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c759</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP40" class="function-link"><span class="ACME-function-syntax">clearGraphicsWindowAndHomeGraphicsCursor</span></a><span class="ACME-plain-syntax">       </span><span class="ACME-comment-syntax">if (graphics cursor active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (clear graphics area)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00001000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check if software scrolling (text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window set)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (software scrolling) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP2" class="function-link"><span class="ACME-function-syntax">initializeDisplayAndHomeCursor</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">initialise screen display and home</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cursor</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">top of text window</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP19" class="function-link"><span class="ACME-function-syntax">clearOneLine</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">clear a line</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=X+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not reached bottom edge yet)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (loop back and clear the</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">next row)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP37" class="paragraph-anchor"></a><b>&#167;37. VDU 30      Home Cursor. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Moves the current cursor (text or graphics) to the top left of the defined text or</span>
<span class="ACME-plain-syntax"> graphics window.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu30EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup53')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup53">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu30EntryPoint</span></span>:<br/><a href="S-s5.html#SP33">&#167;33</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c779</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP37" class="function-link"><span class="ACME-function-syntax">homeTextCursor</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (text cursor active) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP23" class="function-link"><span class="ACME-function-syntax">graphicsCursorHome</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">home graphic cursor</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">homeTextCursor</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c781</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP38" class="function-link"><span class="ACME-function-syntax">vdu31ParamYCoordinate</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">store 0 in last two parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP38" class="function-link"><span class="ACME-function-syntax">vdu31ParamXCoordinate</span></a><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP38" class="paragraph-anchor"></a><b>&#167;38. VDU 31      Position text cursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu31ParamXCoordinate</span><button class="popup" onclick="togglePopup('usagePopup54')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup54">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu31ParamXCoordinate</span></span>:<br/><a href="S-s5.html#SP37">&#167;37</a></span></button><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu31ParamYCoordinate</span><button class="popup" onclick="togglePopup('usagePopup55')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup55">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu31ParamYCoordinate</span></span>:<br/><a href="S-s5.html#SP37">&#167;37</a></span></button><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu31EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup56')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup56">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu31EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c787</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP35" class="function-link"><span class="ACME-function-syntax">exit2</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (graphics cursor active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">exchange text column/line with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace .vduWorkspaceA/B</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP38" class="function-link"><span class="ACME-function-syntax">vdu31ParamXCoordinate</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">get X coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowLeft</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">add to text window left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">store as text column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP38" class="function-link"><span class="ACME-function-syntax">vdu31ParamYCoordinate</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">get Y coordinate</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">add top of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP20" class="function-link"><span class="ACME-function-syntax">validatePositionAndSetupScreenAddress</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">set up screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP33" class="function-link"><span class="ACME-function-syntax">setHardwareCursorAddressLocal</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (carry clear, ie. on screen) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (set cursor position)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorXPosition</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">point to text cursor position (low</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">point to vdu workspace (low byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP10" class="function-link"><span class="ACME-function-syntax">exchangeTwoVDUBytes</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">exchange text cursor position with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace .vduWorkspaceA/B</span>
</pre>
<p class="commentary firstcommentary"><a id="SP39" class="paragraph-anchor"></a><b>&#167;39. VDU 13      Carriage Return (.charRETURN). </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu13EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup57')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup57">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu13EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7af</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (text cursor active) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP24" class="function-link"><span class="ACME-function-syntax">setGraphicsCursorToLeftHandColumn</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">set graphics cursor to left hand</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">columm</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP17" class="function-link"><span class="ACME-function-syntax">setTextCursorToLeftHandColumn</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set text column to left hand column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP29" class="function-link"><span class="ACME-function-syntax">setCursorSoftwareAndHardwarePosition</span></a><span class="ACME-plain-syntax">           </span><span class="ACME-comment-syntax">set cursor position</span>
</pre>
<p class="commentary firstcommentary"><a id="SP40" class="paragraph-anchor"></a><b>&#167;40. clearGraphicsWindowAndHomeGraphicsCursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearGraphicsWindowAndHomeGraphicsCursor</span><button class="popup" onclick="togglePopup('usagePopup58')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup58">Usage of <span class="code-font"><span class="ACME-function-syntax">clearGraphicsWindowAndHomeGraphicsCursor</span></span>:<br/><a href="S-s5.html#SP36">&#167;36</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7bd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP23" class="function-link"><span class="ACME-function-syntax">graphicsCursorHome</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">home graphic cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP41" class="paragraph-anchor"></a><b>&#167;41. VDU 16      Clear graphics window. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu16EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup59')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup59">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu16EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7c0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">pixels per byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP41" class="function-link"><span class="ACME-function-syntax">exitNoGraphics</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">if (current MODE has no graphics)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">background graphics colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGCOLMode</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">background graphics plot mode (GCOL</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">n)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP6" class="function-link"><span class="ACME-function-syntax">setGraphicsColourMaskXY</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">set graphics byte mask in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">.vduGraphicsColourByteOR/EOR</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">source      = graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">destination = workspace A to H</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP38" class="function-link"><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">copy graphics window coordinates to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsTopLow</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">graphics window top low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsBottomLow</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">graphics window bottom low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=difference</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduClearGraphicsWindowLineCount</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">and store in workspace (this is line</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">count)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">graphics window right column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">graphics window left column</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP65" class="function-link"><span class="ACME-function-syntax">fillRow</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">fillRow</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceG</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">decrement window height in pixels</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceH</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceG</span></a><span class="ACME-plain-syntax">                                  </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduClearGraphicsWindowLineCount</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">decrement line count</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch (do it</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">again)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exitNoGraphics</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7f8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP42" class="paragraph-anchor"></a><b>&#167;42. VDU 17      Define text colour. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> The parameter is the logical colour to use as the current text foreground colour. If the</span>
<span class="ACME-plain-syntax"> top bit is set, then the current text background is changed. This is the equivalent of</span>
<span class="ACME-plain-syntax"> BASIC's COLOUR command.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu17EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup60')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup60">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu17EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7f9</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y = 0 (to set text foreground colour)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP43" class="function-link"><span class="ACME-function-syntax">defineTextOrGraphicsColour</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP43" class="paragraph-anchor"></a><b>&#167;43. VDU 18      Define graphics colour. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> This sets the current graphics foreground or background colour. It is the equivalent of</span>
<span class="ACME-plain-syntax"> BASIC's GCOL command.</span>

<span class="ACME-plain-syntax"> The first parameter is the GCOL mode: 0=Normal, 1=OR, 2=AND, 3=EOR, 4=Invert</span>

<span class="ACME-plain-syntax"> This signifies how to modify the colour of pixels that will be drawn in the future. This</span>
<span class="ACME-plain-syntax"> can depend on both the current graphics colour and the colour of the current pixel already</span>
<span class="ACME-plain-syntax"> on screen.</span>

<span class="ACME-plain-syntax"> The second parameter:</span>

<span class="ACME-plain-syntax">   bits 0-6 is the logical colour to use.</span>
<span class="ACME-plain-syntax">   bit 7    set indicates that the current background colour should be set, otherwise</span>
<span class="ACME-plain-syntax">            the current foreground colour is set.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu18ParameterGCOLNumber</span><button class="popup" onclick="togglePopup('usagePopup61')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup61">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu18ParameterGCOLNumber</span></span>:<br/><a href="S-s5.html#SP44">&#167;44</a></span></button><span class="ACME-plain-syntax">           = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu18ParameterLogicalColour</span><span class="ACME-plain-syntax">        = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu18EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup62')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup62">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu18EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7fd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #2                                              </span><span class="ACME-comment-syntax">Y = 2 (to set graphics foreground</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">defineTextOrGraphicsColour</span><button class="popup" onclick="togglePopup('usagePopup63')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup63">Usage of <span class="code-font"><span class="ACME-function-syntax">defineTextOrGraphicsColour</span></span>:<br/><a href="S-s5.html#SP42">&#167;42</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c7ff</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP43" class="function-link"><span class="ACME-function-syntax">vdu18ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">get last parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not negative, it's a foreground</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colour) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment y (to set graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">background colour)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">ensure colour is at most 'number of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">logical colours less 1'</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP43" class="function-link"><span class="ACME-function-syntax">exit3</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (not in a graphics MODE) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">limit to an available colour (and</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">clear M)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">add last parameter to get pointer to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">table.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X is the offset into the tables of</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">colours.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">X = (number of logical colours - 1 +</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">logicalColour)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP13" class="function-link"><span class="ACME-function-syntax">twoColourMODEParameterTable</span></a><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">1,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get plot options from table</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundTextColour</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">store current colour:</span>
<span class="ACME-plain-syntax">                                                        </span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">      Y=0 means text foreground</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">      Y=1 means text background</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">      Y=2 means graphics foreground</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">      Y=3 means graphics background</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #2                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP44" class="function-link"><span class="ACME-function-syntax">setGraphicsGCOLColour</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (graphics colour changed) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (set graphics colour)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundTextColour</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">foreground text colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">invert</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">text colour byte to EOR-ed into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundTextColour</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">background text colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">text colour byte to OR-ed into memory</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit3</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c82b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP44" class="paragraph-anchor"></a><b>&#167;44. setGraphicsGCOLColour. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setGraphicsGCOLColour</span><button class="popup" onclick="togglePopup('usagePopup64')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup64">Usage of <span class="code-font"><span class="ACME-function-syntax">setGraphicsGCOLColour</span></span>:<br/><a href="S-s5.html#SP43">&#167;43</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c82c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP43" class="function-link"><span class="ACME-function-syntax">vdu18ParameterGCOLNumber</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get first parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGraphicsColour</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">text colour Y=0=foreground;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">1=background etc.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP45" class="paragraph-anchor"></a><b>&#167;45. restoreMODE7TextBackgroundColour. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restoreMODE7TextBackgroundColour</span><button class="popup" onclick="togglePopup('usagePopup65')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup65">Usage of <span class="code-font"><span class="ACME-function-syntax">restoreMODE7TextBackgroundColour</span></span>:<br/><a href="S-s5.html#SP46">&#167;46</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c833</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #32                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundTextColour</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">background text colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP46" class="paragraph-anchor"></a><b>&#167;46. VDU 20      Restore default colours. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu20EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup66')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup66">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu20EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c839</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #5                                              </span><span class="ACME-comment-syntax">X = 5, loop counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A = 0</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundTextColour</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">zero all colours</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">until X=$FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP45" class="function-link"><span class="ACME-function-syntax">restoreMODE7TextBackgroundColour</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">if (none, it's MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #15                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not 16 colours; ie. not MODE 2)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$3F</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">A=$3F</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundTextColour</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">foreground text colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduForegroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">foreground graphics colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$FF</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">invert A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteOR</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">text colour byte to be OR-ed into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTextColourByteEOR</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">text colour byte to be EOR-ed into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">memory</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">set first parameter of 5</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPX</span><span class="ACME-plain-syntax"> #3                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP46" class="function-link"><span class="ACME-function-syntax">restore4Colours</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">if (there are 4 colours) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP46" class="function-link"><span class="ACME-function-syntax">restore2Colours</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">if (there are 2 colours) then branch</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restore16Colours</span><span class="ACME-plain-syntax">                                       </span><span class="ACME-comment-syntax">there are 16 colours</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set second parameter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19EntryPoint</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">VDU 19 - define logical colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">decrement first parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">and last parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restore4Colours</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c874</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">X = 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">set first parameter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19EntryPoint</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">and do VDU 19</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">restore2Colours</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c885</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">X = 7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">store physical colour and execute</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">VDU 19</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">X = 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">store it as</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">both parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP47" class="paragraph-anchor"></a><b>&#167;47. VDU 19      Write palette. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Map a logical colour to a physical colour</span>

<span class="ACME-plain-syntax">               VDU 19,logical colour,physics colour,0,0,0</span>

<span class="ACME-plain-syntax"> Logical colours are numbers stored in memory to represent a colour. Logical colours are</span>
<span class="ACME-plain-syntax"> in the range 0-15.</span>

<span class="ACME-plain-syntax"> Physical colours are numbers that represent actual colours:</span>

<span class="ACME-plain-syntax">                 0 = black             8 = flashing black-white</span>
<span class="ACME-plain-syntax">                 1 = red               9 = flashing red-cyan</span>
<span class="ACME-plain-syntax">                 2 = green            10 = flashing green-magenta</span>
<span class="ACME-plain-syntax">                 3 = yellow           11 = flashing yellow-blue</span>
<span class="ACME-plain-syntax">                 4 = blue             12 = flashing blue-yellow</span>
<span class="ACME-plain-syntax">                 5 = magenta          13 = flashing magenta-green</span>
<span class="ACME-plain-syntax">                 6 = cyan             14 = flashing cyan-red</span>
<span class="ACME-plain-syntax">                 7 = white            15 = flashing white-black</span>

<span class="ACME-plain-syntax"> The palette defines which physical colour is displayed for each logical colour.</span>
<span class="ACME-plain-syntax"> The Video ULA hardware stores and manages this palette information.</span>

<span class="ACME-plain-syntax"> Flashing colours</span>
<span class="ACME-plain-syntax"> ----------------</span>
<span class="ACME-plain-syntax"> The OS (in the vertical sync interrupt) updates timers to know when to change the current</span>
<span class="ACME-plain-syntax"> appearance of flashing colours. When it's time, the OS signals the VideoULA to flip the</span>
<span class="ACME-plain-syntax"> flashing bit, thereby changing the current appearance.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span><button class="popup" onclick="togglePopup('usagePopup67')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup67">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></span>:<br/><a href="S-s5.html#SP46">&#167;46</a></span></button><span class="ACME-plain-syntax">  = </span><span class="ACME-constant-syntax">$031F</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span><button class="popup" onclick="togglePopup('usagePopup68')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup68">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></span>:<br/><a href="S-s5.html#SP46">&#167;46</a></span></button><span class="ACME-plain-syntax"> = </span><span class="ACME-constant-syntax">$0320</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu19EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup69')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup69">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu19EntryPoint</span></span>:<br/><a href="S-s5.html#SP46">&#167;46</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c892</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEI</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">disable interrupts</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">get logical colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">AND with number of logical colours</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">less 1 to make legal.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store logical colour in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">vdu19ParameterPhysicalColour</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">A=physical colour</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">writePaletteAX</span><button class="popup" onclick="togglePopup('usagePopup70')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup70">Usage of <span class="code-font"><span class="ACME-function-syntax">writePaletteAX</span></span>:<br/><a href="S-s5.html#SP48">&#167;48</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c89e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #15                                             </span><span class="ACME-comment-syntax">make legal</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduColourPaletteStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">store physical in colour palette</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">remember physical colour in Y</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">is it a 4 colour MODE?</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall A = logical colour</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">rotate the logical colour (A) into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the top bits of .tempStoreFA</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">rotate the (number of colours</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">in the MODE-1) down by one bit</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (there are more set bits) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">the final rotate wasn't needed,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">so shift left to rectify</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">at this point .tempStoreFA holds</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the logical colour in the top N bits</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">where N is the number of bits</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">required to store a colour in</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the current MODE.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall physical colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">tempStoreFA</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">OR in the physical colour into</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the bottom bits</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store value in X. This is working</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">towards being the value to send to</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the palette register on the Video</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">ULA.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">notFourColourMODE</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">if (not a four colour MODE, i.e.</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A !=3 earlier) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with four colour MODEs</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">Test bits 5 and 6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (both bit are clear) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01100000</span><span class="ACME-plain-syntax">                                      </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (both bits are set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall X value.</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">invert bits 5 and 6 (one of which</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">is set and the other clear).</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">notFourColourMODE</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">ALWAYS branch. A = value to send</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to palette register of the Video ULA.</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">notFourColourMODE</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c8cc</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP60" class="function-link"><span class="ACME-function-syntax">osbyte155Internal</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">pass data to palette register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = Y + number of logical colours - 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #16                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X = X + 16</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #16                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y &lt; 16) then branch (loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags twice</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP48" class="paragraph-anchor"></a><b>&#167;48. OSWORD 12 - Write Palette. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   .oswordX/Y is the address of the five bytes of parameters:</span>
<span class="ACME-plain-syntax">       byte 0: logical colour</span>
<span class="ACME-plain-syntax">       byte 1: physical colour</span>
<span class="ACME-plain-syntax">       byte 2: zero</span>
<span class="ACME-plain-syntax">       byte 3: zero</span>
<span class="ACME-plain-syntax">       byte 4: zero</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">osword12EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup71')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup71">Usage of <span class="code-font"><span class="ACME-function-syntax">osword12EntryPoint</span></span>:<br/>Chapter 15: OSBYTE and OSWORD - <a href="S-s15.html#SP1">&#167;1</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c8e0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">and with number of logical colours</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">X=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=Y+1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">oswordX</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">get physical colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP47" class="function-link"><span class="ACME-function-syntax">writePaletteAX</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">do VDU19 with parameters in X and A</span>
</pre>
<p class="commentary firstcommentary"><a id="SP49" class="paragraph-anchor"></a><b>&#167;49. VDU 22      Select MODE. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu22Parameter</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu22EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup72')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup72">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu22EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c8eb</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP49" class="function-link"><span class="ACME-function-syntax">vdu22Parameter</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">get parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s6.html#SP2" class="function-link"><span class="ACME-function-syntax">setMODE</span></a><span class="ACME-plain-syntax">                                        </span><span class="ACME-comment-syntax">change MODE</span>
</pre>
<p class="commentary firstcommentary"><a id="SP50" class="paragraph-anchor"></a><b>&#167;50. VDU 23      Define Character. </b></p>

<p class="center-p"><img src="guide.png" alt="guide.png"></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">   A = 0 sets CRTC 6845 register:</span>
<span class="ACME-plain-syntax">       VDU 23,0,R,X,0,0,0,0,0,0 - program CRTC register R with value V</span>
<span class="ACME-plain-syntax">       See </span><a href="S-s3.html" class="internal">Chapter 3: Memory Mapped IO</a><span class="ACME-plain-syntax"> section 'CRTC registers'</span>
<span class="ACME-plain-syntax">   A = 1 turns the cursor on or off:</span>
<span class="ACME-plain-syntax">       VDU 23,1,0,0,0,0,0,0,0,0 - turn cursor off</span>
<span class="ACME-plain-syntax">       VDU 23,1,1,0,0,0,0,0,0,0 - turn cursor on</span>
<span class="ACME-plain-syntax">   A = 32-255 means define character</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23ParameterLogicalColour</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueStartByte</span></a>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter1</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">8</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter2</span><button class="popup" onclick="togglePopup('usagePopup73')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup73">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu23Parameter2</span></span>:<br/><a href="S-s5.html#SP52">&#167;52</a>, <a href="S-s5.html#SP53">&#167;53</a></span></button><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">7</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter3</span><button class="popup" onclick="togglePopup('usagePopup74')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup74">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu23Parameter3</span></span>:<br/><a href="S-s5.html#SP53">&#167;53</a></span></button><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter4</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter5</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter6</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter7</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter8</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23Parameter9</span><span class="ACME-plain-syntax"> = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup75')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup75">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu23EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c8f1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">vdu23ParameterLogicalColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">get character to define</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax">                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP52" class="function-link"><span class="ACME-function-syntax">vdu23SetCRTCRegisterOrCursorVisibility</span></a><span class="ACME-plain-syntax">         </span><span class="ACME-comment-syntax">if (less then SPACE) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(it is an instruction to set a CRT</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">register or cursor visibility)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">save parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = A / 32</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store font zone (1-7) in X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP11" class="function-link"><span class="ACME-function-syntax">fontMaskTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">look up single bit representing</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">the font zone (character / 32)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BIT</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontFlags</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">font flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (not zero) then branch (storage</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">area is established already)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontFlags</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">OR with font flag to set bit</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">found to be 0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontFlags</span></a><span class="ACME-plain-syntax">                                   </span><span class="ACME-comment-syntax">font flag</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back font zone (1-7)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #3                                              </span><span class="ACME-comment-syntax">AND with 3 to clear all but bits</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">0 and 1 (A = 1, 2, 3)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s4.html#SP1" class="function-link"><span class="ACME-function-syntax">characterDefinitions</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">A=$C0, $C1, $C2 to select a</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">character page in ROM</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it in the high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduFontZoneAddressesHigh1</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get font address (high byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDD</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store it in the high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store zero in the low bytes</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">copy character definition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDC</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">get back A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP32" class="function-link"><span class="ACME-function-syntax">getCharacterDefinitionAddress</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set up character definition pointers</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">Y=loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">vdu23Parameter2</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">transfer definition parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">),</span><span class="ACME-reserved-syntax">Y</span><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">to RAM definition</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEY</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">[unused. Was used in MOS 0.92]</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit4</span><button class="popup" onclick="togglePopup('usagePopup76')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup76">Usage of <span class="code-font"><span class="ACME-function-syntax">exit4</span></span>:<br/><a href="S-s5.html#SP52">&#167;52</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c937</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP51" class="paragraph-anchor"></a><b>&#167;51. Plot extension. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> If calling VDU 25 (PLOT) in a non-graphics mode, or using a plot type that is reserved</span>
<span class="ACME-plain-syntax"> for future expansion, then this routine is called. It calls the VDUV vector which allows</span>
<span class="ACME-plain-syntax"> user programs or Paged ROMs to intercept the call and provide new functionality.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vduPlotExtension</span><button class="popup" onclick="togglePopup('usagePopup77')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup77">Usage of <span class="code-font"><span class="ACME-function-syntax">vduPlotExtension</span></span>:<br/><a href="S-s5.html#SP55">&#167;55</a><br/>Chapter 8: PLOT - <a href="S-s8.html#SP4">&#167;4</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c938</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP55" class="function-link"><span class="ACME-function-syntax">vdu25Parameter5</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">A = fifth VDU parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> (.</span><a href="S-s2.html#SP13" class="function-link"><span class="ACME-function-syntax">vectorVDUV</span></a><span class="ACME-plain-syntax">)                                   </span><span class="ACME-comment-syntax">jump via VDUV vector</span>
</pre>
<p class="commentary firstcommentary"><a id="SP52" class="paragraph-anchor"></a><b>&#167;52. VDU 23 with 0-31 as the next byte. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> VDU 23,0      - set CRTC Register</span>
<span class="ACME-plain-syntax"> VDU 23,1      - turn cursor on or off</span>
<span class="ACME-plain-syntax"> VDU 23,2-31   - call VDUV extension vector</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23SetCRTCRegisterOrCursorVisibility</span><button class="popup" onclick="togglePopup('usagePopup78')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup78">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu23SetCRTCRegisterOrCursorVisibility</span></span>:<br/><a href="S-s5.html#SP50">&#167;50</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c93f</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #1                                              </span><span class="ACME-comment-syntax">does A=1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP53" class="function-link"><span class="ACME-function-syntax">vdu23CommaZeroSetCRTCRegister</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">if (A = 0) then branch (set CRTC</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">register)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (A != 1) then branch (to VDUV</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">vector)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active;</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">exit4</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">if (graphics cursor is active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">handle text cursor...</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #32                                             </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">vdu23Parameter2</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">Y = second VDU parameter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP52" class="function-link"><span class="ACME-function-syntax">setCursorOnOrOff</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (Y=0) then branch (turn cursor</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">off)</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setTextCursor</span><button class="popup" onclick="togglePopup('usagePopup79')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup79">Usage of <span class="code-font"><span class="ACME-function-syntax">setTextCursor</span></span>:<br/><a href="S-s5.html#SP17">&#167;17</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP9">&#167;9</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c951</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduLastCursorStartRegisterValue</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">get last setting of CRTC register</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCursorOnOrOff</span><button class="popup" onclick="togglePopup('usagePopup80')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup80">Usage of <span class="code-font"><span class="ACME-function-syntax">setCursorOnOrOff</span></span>:<br/><a href="S-s5.html#SP18">&#167;18</a><br/>Chapter 9: Cursor editing mode - <a href="S-s9.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c954</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcCursorStartRegister</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">Y = .crtcCursorStartRegister</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP54" class="function-link"><span class="ACME-function-syntax">setCRTCRegisterDirect</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">ALWAYS branch</span>
</pre>
<p class="commentary firstcommentary"><a id="SP53" class="paragraph-anchor"></a><b>&#167;53. vdu23CommaZeroSetCRTCRegister. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu23CommaZeroSetCRTCRegister</span><button class="popup" onclick="togglePopup('usagePopup81')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup81">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu23CommaZeroSetCRTCRegister</span></span>:<br/><a href="S-s5.html#SP52">&#167;52</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c958</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">vdu23Parameter3</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">get third parameter (value to write)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP50" class="function-link"><span class="ACME-function-syntax">vdu23Parameter2</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">get second parameter (CRTC register</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">to set)</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCRTCRegisterAY</span><button class="popup" onclick="togglePopup('usagePopup82')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup82">Usage of <span class="code-font"><span class="ACME-function-syntax">setCRTCRegisterAY</span></span>:<br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c95e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcVerticalSyncPositionRegister</span></a><span class="ACME-plain-syntax">              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP54" class="function-link"><span class="ACME-function-syntax">setCRTCRegisterDirect</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (Y &lt; 7) then set register Y with</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">value A directly</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y &gt; 7) branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with vertical sync position register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduVerticalAdjust</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">add screen vertical display</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">adjustment + 1 (carry set)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcInterlaceAndDelayRegister</span></a><span class="ACME-plain-syntax">                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (Y != 8) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with interlace and delay register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">test if bit 7 set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (bit 7 set) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">vduInterlaceValue</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">set interlace value (0 or 1)</span>

<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CPY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcCursorStartRegister</span></a><span class="ACME-plain-syntax">                       </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP54" class="function-link"><span class="ACME-function-syntax">setCRTCRegisterDirect</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">if (Y != 10) then branch - set</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">register Y with value A directly</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">deal with cursor start register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduLastCursorStartRegisterValue</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">last setting of CRTC register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y=A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00100000</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">check bit 5 (print at graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">cursor)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">push flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A = value to set</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcCursorStartRegister</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">Y=10</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLP</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">pull flags</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (graphics cursor is active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch (return)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP54" class="paragraph-anchor"></a><b>&#167;54. setCRTCRegisterDirect. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCRTCRegisterDirect</span><button class="popup" onclick="togglePopup('usagePopup83')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup83">Usage of <span class="code-font"><span class="ACME-function-syntax">setCRTCRegisterDirect</span></span>:<br/><a href="S-s5.html#SP52">&#167;52</a>, <a href="S-s5.html#SP53">&#167;53</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c985</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressRegister</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">Y is which CRTC register to write to</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressWrite</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">write value A into register Y</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP55" class="paragraph-anchor"></a><b>&#167;55. VDU 25      Plot. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25Parameter5</span><button class="popup" onclick="togglePopup('usagePopup84')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup84">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25Parameter5</span></span>:<br/><a href="S-s5.html#SP51">&#167;51</a></span></button><span class="ACME-plain-syntax"> = </span><span class="ACME-constant-syntax">$031F</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu25EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup85')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup85">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu25EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c98c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduPixelsPerByteMinusOne</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">get pixels per byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP51" class="function-link"><span class="ACME-function-syntax">vduPlotExtension</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">if (zero, i.e. no graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">available) then branch (plot</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">extension)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP1" class="function-link"><span class="ACME-function-syntax">vdu25Plot</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">jump to main plot routine</span>
</pre>
<p class="commentary firstcommentary"><a id="SP56" class="paragraph-anchor"></a><b>&#167;56. Hardware screen scroll up/down. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> Changes the start address of the display</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">hardwareScrollDown</span><button class="popup" onclick="togglePopup('usagePopup86')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup86">Usage of <span class="code-font"><span class="ACME-function-syntax">hardwareScrollDown</span></span>:<br/><a href="S-s5.html#SP21">&#167;21</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c994</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">screen top left address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">screen top left address high</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP1" class="function-link"><span class="ACME-function-syntax">subtractNumberOfBytesInARowFromAX</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">subtract bytes per character row</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">from this</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (no wraparound needed) then branch</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">screen RAM size high byte to wrap</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">around</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">hardwareScrollUp</span><button class="popup" onclick="togglePopup('usagePopup87')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup87">Usage of <span class="code-font"><span class="ACME-function-syntax">hardwareScrollUp</span></span>:<br/><a href="S-s5.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c9a4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">screen top left address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">screen top left address high</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP68" class="function-link"><span class="ACME-function-syntax">addNumberOfBytesInACharacterRowToAX</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">add bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">wrap around</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">screen RAM size high byte</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">screen top left address high</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">screen top left address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcStartScreenAddressHighRegister</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">Y = value to change screen address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP59" class="function-link"><span class="ACME-function-syntax">setHardwareScreenOrCursorAddress</span></a><span class="ACME-plain-syntax">               </span><span class="ACME-comment-syntax">ALWAYS branch to set screen address</span>
</pre>
<p class="commentary firstcommentary"><a id="SP57" class="paragraph-anchor"></a><b>&#167;57. VDU 26      Reset to default windows. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu26EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup88')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup88">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu26EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c9bd</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">A=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">X=loop counter</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">zero a whole bunch of vdu variables,</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">including the text and graphics</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">windows</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">use data for current screen mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODE</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">screen MODE</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">reset text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP9" class="function-link"><span class="ACME-function-syntax">textWindowRightColumnTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text window right edge maximum</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowRight</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">store in the text window right</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP63" class="function-link"><span class="ACME-function-syntax">calculateBytesPerTextWindowRow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">calculate number of bytes in a text</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP9" class="function-link"><span class="ACME-function-syntax">textWindowBottomRowTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">text window bottom edge maximum</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">reset graphics window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #3                                              </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterTopEdgeHigh</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">top edge high byte    = 3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">Y = 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterRightEdgeHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">right edge high byte  = 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterTopEdgeLow</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">top edge low          = $FF</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">DEC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterRightEdgeLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">right edge low        = $FF</span>
<span class="ACME-plain-syntax">                                                        </span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">so now top edge = $03FF = 1023</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">and right edge  = $04FF = 1279</span>
<span class="ACME-plain-syntax">                                                        </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24EntryPoint</span></a><span class="ACME-plain-syntax">                                </span><span class="ACME-comment-syntax">do VDU 24 (define graphics</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">window)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">reset scrolling</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%11110111</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP16" class="function-link"><span class="ACME-function-syntax">clearVDUStatusByteFlags</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">} clear bit 3 of .vduStatusByte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">screen start address low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenTopLeftAddressHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">screen start address high</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">reset cursor</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setTextCursorCRTCAddress</span><button class="popup" onclick="togglePopup('usagePopup89')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup89">Usage of <span class="code-font"><span class="ACME-function-syntax">setTextCursorCRTCAddress</span></span>:<br/><a href="S-s5.html#SP19">&#167;19</a>, <a href="S-s5.html#SP25">&#167;25</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $c9f6</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">text cursor CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text cursor CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP58" class="function-link"><span class="ACME-function-syntax">setHardwareCursorAddress</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">set cursor position</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduScreenSizeHighByte</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} screen RAM size high byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP58" class="paragraph-anchor"></a><b>&#167;58. Set cursor screen address. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       AX holds the screen address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setHardwareCursorAddress</span><button class="popup" onclick="togglePopup('usagePopup90')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup90">Usage of <span class="code-font"><span class="ACME-function-syntax">setHardwareCursorAddress</span></span>:<br/><a href="S-s5.html#SP9">&#167;9</a>, <a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca02</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressLow</span></a><span class="ACME-plain-syntax">                 </span><span class="ACME-comment-syntax">set screen address of cursor from AX</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduWriteCursorScreenAddressHigh</span></a><span class="ACME-plain-syntax">                </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressLow</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">text cursor CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorCRTCAddressHigh</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text cursor CRTC address</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP6" class="function-link"><span class="ACME-function-syntax">crtcCursorPositionHighRegister</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">Y=14</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP59" class="paragraph-anchor"></a><b>&#167;59. Set hardware screen or cursor address. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       The screen address or cursor position address is in AX</span>
<span class="ACME-plain-syntax">       Y holds either .crtcCursorPositionHighRegister to change the cursor position</span>
<span class="ACME-plain-syntax">                   or .crtcStartScreenAddressHighRegister to change the screen address</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setHardwareScreenOrCursorAddress</span><button class="popup" onclick="togglePopup('usagePopup91')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup91">Usage of <span class="code-font"><span class="ACME-function-syntax">setHardwareScreenOrCursorAddress</span></span>:<br/><a href="S-s5.html#SP56">&#167;56</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca0e</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODE</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">screen MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> #7                                              </span><span class="ACME-comment-syntax">is it MODE 7?</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">restore A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCS</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP59" class="function-link"><span class="ACME-function-syntax">setCursorPositionMODE7</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (MODE 7 selected) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">divide X/A by 8</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP60" class="function-link"><span class="ACME-function-syntax">setTwoCRTCRegisters</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">set cursor position AX</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setCursorPositionMODE7</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca27</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SBC</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$74</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">MODE 7 subtract $74</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">$20</span><span class="ACME-plain-syntax">                                            </span><span class="ACME-comment-syntax">EOR with $20 (See NAUG Section</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">13.3.11 - MODE 7 scrolling,</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">Page 200)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP60" class="paragraph-anchor"></a><b>&#167;60. Write to two sequential registers on the CRTC. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       Y = register number</span>
<span class="ACME-plain-syntax">       A = First value to write (to register Y)</span>
<span class="ACME-plain-syntax">       X = Second value to write (to register Y+1)</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">setTwoCRTCRegisters</span><button class="popup" onclick="togglePopup('usagePopup92')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup92">Usage of <span class="code-font"><span class="ACME-function-syntax">setTwoCRTCRegisters</span></span>:<br/><a href="S-s5.html#SP59">&#167;59</a><br/>Chapter 6: Changing MODEs - <a href="S-s6.html#SP2">&#167;2</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca2b</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressRegister</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">set which CRTC register to write into</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressWrite</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">write A into CRTC register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">increment Y to the next CRTC register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressRegister</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">set which CRTC register to write into</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STX</span><span class="ACME-plain-syntax"> .</span><a href="S-s3.html#SP4" class="function-link"><span class="ACME-function-syntax">crtcAddressWrite</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">write X into CRTC register</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP61" class="paragraph-anchor"></a><b>&#167;61. VDU 24      Define graphics window. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterLeftEdgeLow</span><span class="ACME-plain-syntax">      = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">7</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterLeftEdgeHigh</span><span class="ACME-plain-syntax">     = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">6</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterBottomEdgeLow</span><span class="ACME-plain-syntax">    = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">5</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterBottomEdgeHigh</span><span class="ACME-plain-syntax">   = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">4</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterRightEdgeLow</span><button class="popup" onclick="togglePopup('usagePopup93')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup93">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu24ParameterRightEdgeLow</span></span>:<br/><a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax">     = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">3</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterRightEdgeHigh</span><button class="popup" onclick="togglePopup('usagePopup94')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup94">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu24ParameterRightEdgeHigh</span></span>:<br/><a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax">    = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">2</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterTopEdgeLow</span><button class="popup" onclick="togglePopup('usagePopup95')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup95">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu24ParameterTopEdgeLow</span></span>:<br/><a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax">       = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> </span><span class="ACME-constant-syntax">1</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24ParameterTopEdgeHigh</span><button class="popup" onclick="togglePopup('usagePopup96')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup96">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu24ParameterTopEdgeHigh</span></span>:<br/><a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax">      = .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduQueueEndByte</span></a>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu24EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup97')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup97">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu24EntryPoint</span></span>:<br/><a href="S-s5.html#SP57">&#167;57</a><br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca39</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">exchange graphics cursor</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">position with .vduWorkspaceABCD</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">will swap them back at the end</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterLeftEdgeLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">src = parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceE</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">dest = Workspace EFGH</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP34" class="function-link"><span class="ACME-function-syntax">coordinateSubtraction</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">EFGH = (width = right - left,</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">        height = top - bottom)</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">Accumulator = height (high byte)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceF</span></a><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">OR with high byte of width</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (either width or height is</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">negative) then branch (to</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">exchange back and exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterRightEdgeLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">   </span><span class="ACME-comment-syntax">point X to right edge low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP17" class="function-link"><span class="ACME-function-syntax">plotConvertExternalAbsoluteCoordinatesToPixels</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">scale pointers to MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterLeftEdgeLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">point X to left edge low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP17" class="function-link"><span class="ACME-function-syntax">plotConvertExternalAbsoluteCoordinatesToPixels</span></a><span class="ACME-plain-syntax">     </span><span class="ACME-comment-syntax">scale pointers to MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterBottomEdgeHigh</span></a><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">check for negative edges</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ORA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterLeftEdgeHigh</span></a><span class="ACME-plain-syntax">                         </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (negative) then branch (to</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">exchange back and exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterTopEdgeHigh</span></a><span class="ACME-plain-syntax">                          </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (non zero) then branch (to</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">exchange back and exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduCurrentScreenMODE</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">get screen MODE</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterRightEdgeHigh</span></a><span class="ACME-plain-syntax">                        </span><span class="ACME-comment-syntax">right edge high</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">store it</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterRightEdgeLow</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">right edge low</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDA</span></a><span class="ACME-plain-syntax">                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (negative) then branch (to</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">exchange back and exit)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROR</span><span class="ACME-plain-syntax">                                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                     </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s4.html#SP9" class="function-link"><span class="ACME-function-syntax">textWindowRightColumnTable</span></a><span class="ACME-plain-syntax">,</span><span class="ACME-reserved-syntax">X</span><span class="ACME-plain-syntax">                       </span><span class="ACME-comment-syntax">compare with text window right</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">hand edge maximum</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                                   </span><span class="ACME-comment-syntax">if (equal) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP62" class="function-link"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">if (non-negative) then branch</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">(to exchange back and exit)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowPixelsLeftLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">destination = graphics window</span>
<span class="ACME-plain-syntax">                                                              </span><span class="ACME-comment-syntax">extents</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP61" class="function-link"><span class="ACME-function-syntax">vdu24ParameterLeftEdgeLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">source = parameters</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP38" class="function-link"><span class="ACME-function-syntax">copyEightBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">copy source to destination</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP62" class="paragraph-anchor"></a><b>&#167;62. exchangeGraphicsCursorPositionWithWorkspaceABCD. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span><button class="popup" onclick="togglePopup('usagePopup98')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup98">Usage of <span class="code-font"><span class="ACME-function-syntax">exchangeGraphicsCursorPositionWithWorkspaceABCD</span></span>:<br/><a href="S-s5.html#SP61">&#167;61</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca81</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsCursorPositionXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">} swap graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduWorkspaceA</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">            </span><span class="ACME-comment-syntax">} position with Workspace</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP12" class="function-link"><span class="ACME-function-syntax">exchangeFourBytes</span></a><span class="ACME-plain-syntax">                              </span><span class="ACME-comment-syntax">} ABCD</span>
</pre>
<p class="commentary firstcommentary"><a id="SP63" class="paragraph-anchor"></a><b>&#167;63. calculateBytesPerTextWindowRow. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">calculateBytesPerTextWindowRow</span><button class="popup" onclick="togglePopup('usagePopup99')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup99">Usage of <span class="code-font"><span class="ACME-function-syntax">calculateBytesPerTextWindowRow</span></span>:<br/><a href="S-s5.html#SP33">&#167;33</a>, <a href="S-s5.html#SP57">&#167;57</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $ca88</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INY</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TYA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} A = Y + 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">Y=0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STY</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesHigh</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">text window width high (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesLow</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text window width low (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacter</span></a><span class="ACME-plain-syntax">                           </span><span class="ACME-comment-syntax">bytes per character</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (zero) then branch (exit)</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ASL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesLow</span></a><span class="ACME-plain-syntax">                   </span><span class="ACME-comment-syntax">text window width low (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ROL</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowWidthInBytesHigh</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">text window width high (bytes)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">divide by 2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (carry clear) then branch (loop</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">back)</span>
<span class="ACME-identifier-syntax">+</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP64" class="paragraph-anchor"></a><b>&#167;64. VDU 29      Set graphics origin. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu29ParameterStart</span><span class="ACME-plain-syntax"> = </span><span class="ACME-constant-syntax">$320</span>

<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu29EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup100')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup100">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu29EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $caa2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> #.</span><a href="S-s5.html#SP64" class="function-link"><span class="ACME-function-syntax">vdu29ParameterStart</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">} copy the four bytes from the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduGraphicsWindowOriginXLow</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduVariablesStart</span></a><span class="ACME-plain-syntax">  </span><span class="ACME-comment-syntax">} vdu queue parameters to the</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP43" class="function-link"><span class="ACME-function-syntax">copyFourBytesWithinVDUVariables</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">} current graphics origin</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s8.html#SP21" class="function-link"><span class="ACME-function-syntax">convertPixelGraphicsCoordinatesToExternal</span></a><span class="ACME-plain-syntax">          </span><span class="ACME-comment-syntax">set up external coordinates for</span>
<span class="ACME-plain-syntax">                                                            </span><span class="ACME-comment-syntax">graphics</span>
</pre>
<p class="commentary firstcommentary"><a id="SP65" class="paragraph-anchor"></a><b>&#167;65. VDU 127     Delete. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">vdu127EntryPoint</span><button class="popup" onclick="togglePopup('usagePopup101')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup101">Usage of <span class="code-font"><span class="ACME-function-syntax">vdu127EntryPoint</span></span>:<br/>Chapter 4: Character definitions and VDU tables - <a href="S-s4.html#SP6">&#167;6</a>, <a href="S-s4.html#SP7">&#167;7</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $caac</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP19" class="function-link"><span class="ACME-function-syntax">vdu8EntryPoint</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">cursor left</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP11" class="function-link"><span class="ACME-function-syntax">isTextCursorActive</span></a><span class="ACME-plain-syntax">                             </span><span class="ACME-comment-syntax">set A=0 if text cursor is active</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax"> or A=$20 if graphics cursor</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP67" class="function-link"><span class="ACME-function-syntax">deleteCharacterAtGraphicsCursor</span></a><span class="ACME-plain-syntax">                </span><span class="ACME-comment-syntax">if (graphics cursor active) then</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduNumberOfLogicalColoursMinusOne</span></a><span class="ACME-plain-syntax">              </span><span class="ACME-comment-syntax">number of logical colours less 1</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BEQ</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP66" class="function-link"><span class="ACME-function-syntax">deleteCharacterInMODE7</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">if (MODE 7) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDE</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store A (always 0)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #&gt;.</span><a href="S-s4.html#SP1" class="function-link"><span class="ACME-function-syntax">characterDefinitions</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">A=high byte of characters in ROM</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduTempStoreDF</span></a><span class="ACME-plain-syntax">                                 </span><span class="ACME-comment-syntax">store in .vduTempStoreDF</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(.vduTempStoreDE)</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">now points to the first character</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">definition: the 'space' pattern</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP26" class="function-link"><span class="ACME-function-syntax">displayACharacterAtAddress</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">display a space</span>
</pre>
<p class="commentary firstcommentary"><a id="SP66" class="paragraph-anchor"></a><b>&#167;66. deleteCharacterInMODE7. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">deleteCharacterInMODE7</span><button class="popup" onclick="togglePopup('usagePopup102')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup102">Usage of <span class="code-font"><span class="ACME-function-syntax">deleteCharacterInMODE7</span></span>:<br/><a href="S-s5.html#SP65">&#167;65</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cac2</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charSPACE</span></a><span class="ACME-plain-syntax">                                     </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP27" class="function-link"><span class="ACME-function-syntax">displayCharacterMODE7</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">} display a space</span>
</pre>
<p class="commentary firstcommentary"><a id="SP67" class="paragraph-anchor"></a><b>&#167;67. deleteCharacterAtGraphicsCursor. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">deleteCharacterAtGraphicsCursor</span><button class="popup" onclick="togglePopup('usagePopup103')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup103">Usage of <span class="code-font"><span class="ACME-function-syntax">deleteCharacterAtGraphicsCursor</span></span>:<br/><a href="S-s5.html#SP65">&#167;65</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cac7</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #.</span><a href="S-s2.html#SP2" class="function-link"><span class="ACME-function-syntax">charDELETE</span></a><span class="ACME-plain-syntax">                                    </span><span class="ACME-comment-syntax">ASCII code for delete</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP32" class="function-link"><span class="ACME-function-syntax">getCharacterDefinitionAddress</span></a><span class="ACME-plain-syntax">                  </span><span class="ACME-comment-syntax">set up character definition pointers</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDX</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBackgroundGraphicsColour</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">background graphics colour</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDY</span><span class="ACME-plain-syntax"> #0                                              </span><span class="ACME-comment-syntax">normal GCOL mode</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s7.html#SP22" class="function-link"><span class="ACME-function-syntax">plotACharacterWithXYAsGraphicsColourAndGCOLMode</span></a><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">plot character in background colour</span>
</pre>
<p class="commentary firstcommentary"><a id="SP68" class="paragraph-anchor"></a><b>&#167;68. addNumberOfBytesInACharacterRowToAX. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> On Entry:</span>
<span class="ACME-plain-syntax">       A = High byte of 16 bit value</span>
<span class="ACME-plain-syntax">       X = Low byte of 16 bit value</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">addNumberOfBytesInACharacterRowToAX</span><button class="popup" onclick="togglePopup('usagePopup104')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup104">Usage of <span class="code-font"><span class="ACME-function-syntax">addNumberOfBytesInACharacterRowToAX</span></span>:<br/><a href="S-s5.html#SP56">&#167;56</a><br/>Chapter 7: Graphics cursor and soft character definitions - <a href="S-s7.html#SP14">&#167;14</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cad4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PHA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">store A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TXA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">A=X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowLow</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">add bytes per character row</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">TAX</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">put low byte back into X</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">PLA</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">recall A</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduBytesPerCharacterRowHigh</span></a><span class="ACME-plain-syntax">                    </span><span class="ACME-comment-syntax">add bytes per character row high</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">byte (and carry)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<p class="commentary firstcommentary"><a id="SP69" class="paragraph-anchor"></a><b>&#167;69. Paged mode scrolling. </b></p>

<pre class="ACME-undisplayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax"> When paged mode is enabled, listing lots of text stops scrolling when the screen is full</span>
<span class="ACME-plain-syntax"> until the user presses SHIFT to display the next page of text.</span>

<span class="ACME-plain-syntax"> Even without paged mode enabled, holding SHIFT and CTRL will inhibit scrolling (pauses)</span>
<span class="ACME-plain-syntax"> until at least one of the keys is released.</span>
</pre>
<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">handleScrollingInPagedMode</span><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cae0</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP70" class="function-link"><span class="ACME-function-syntax">clearPagedModeCounter</span></a><span class="ACME-plain-syntax">                          </span><span class="ACME-comment-syntax">clear paged mode line counter</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">handleScrollingInPagedModeInternal</span><button class="popup" onclick="togglePopup('usagePopup105')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup105">Usage of <span class="code-font"><span class="ACME-function-syntax">handleScrollingInPagedModeInternal</span></span>:<br/><a href="S-s5.html#SP27">&#167;27</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cae3</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">first check for SHIFT and CTRL pressed together - this loops until at least one key is</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">released</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP56" class="function-link"><span class="ACME-function-syntax">osbyte118EntryPoint</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">OSBYTE 118 - set keyboard LEDs based</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">on current keyboard state</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">+</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (CTRL not pressed) then branch</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP69" class="function-link"><span class="ACME-function-syntax">handleScrollingInPagedMode</span></a><span class="ACME-plain-syntax">                     </span><span class="ACME-comment-syntax">if (SHIFT pressed) then branch back</span>
<span class="ACME-identifier-syntax">+</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check flags for relevant state</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP11" class="function-link"><span class="ACME-function-syntax">vduStatusByte</span></a><span class="ACME-plain-syntax">                                  </span><span class="ACME-comment-syntax">VDU status byte</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">EOR</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%00000100</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">invert bit 2 (paged scrolling)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">AND</span><span class="ACME-plain-syntax"> #</span><span class="ACME-constant-syntax">%01000110</span><span class="ACME-plain-syntax">                                      </span><span class="ACME-comment-syntax">if (there are 2 cursors, OR paged</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">mode is off, OR not paged</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">scrolling)...</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BNE</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP70" class="function-link"><span class="ACME-function-syntax">exit5</span></a><span class="ACME-plain-syntax">                                          </span><span class="ACME-comment-syntax">...then branch (exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check the paged mode counter to see if it has run out of lines</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">paged mode counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BMI</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP70" class="function-link"><span class="ACME-function-syntax">incrementPagedModeAndExit</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">if (negative) then branch (increment</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">paged mode counter and exit)</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check if we are at the bottom of the screen (exit if not)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextCursorYPosition</span></a><span class="ACME-plain-syntax">                         </span><span class="ACME-comment-syntax">current text line</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP70" class="function-link"><span class="ACME-function-syntax">incrementPagedModeAndExit</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">increment line counter and exit</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">check if we have shown enough lines to fill the text window vertically</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">}</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LSR</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">} A = A / 4</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">paged mode counter</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">ADC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowTop</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">top of text window</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CMP</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP15" class="function-link"><span class="ACME-function-syntax">vduTextWindowBottom</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">bottom edge</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BCC</span><span class="ACME-plain-syntax"> .</span><a href="S-s5.html#SP70" class="function-link"><span class="ACME-function-syntax">incrementPagedModeAndExit</span></a><span class="ACME-plain-syntax">                      </span><span class="ACME-comment-syntax">increment line counter and exit</span>

<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">CLC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">clear carry</span>
<span class="ACME-identifier-syntax">-</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">JSR</span><span class="ACME-plain-syntax"> .</span><a href="S-s15.html#SP56" class="function-link"><span class="ACME-function-syntax">osbyte118EntryPoint</span></a><span class="ACME-plain-syntax">                            </span><span class="ACME-comment-syntax">OSBYTE 118 - set keyboard LEDs based</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">on current keyboard state</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">SEC</span><span class="ACME-plain-syntax">                                                 </span><span class="ACME-comment-syntax">set carry</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">BPL</span><span class="ACME-plain-syntax"> </span><span class="ACME-identifier-syntax">-</span><span class="ACME-plain-syntax">                                               </span><span class="ACME-comment-syntax">if (SHIFT not pressed) then branch</span>
<span class="ACME-plain-syntax">                                                        </span><span class="ACME-comment-syntax">(loop back)</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-comment-syntax">fall through...</span>
</pre>
<p class="commentary firstcommentary"><a id="SP70" class="paragraph-anchor"></a><b>&#167;70. clearPagedModeCounter. </b></p>

<pre class="ACME-displayed-code all-displayed-code code-font">
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">clearPagedModeCounter</span><button class="popup" onclick="togglePopup('usagePopup106')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup106">Usage of <span class="code-font"><span class="ACME-function-syntax">clearPagedModeCounter</span></span>:<br/><a href="S-s5.html#SP69">&#167;69</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cb14</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">LDA</span><span class="ACME-plain-syntax"> #255                                            </span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">STA</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">set paged mode counter</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">incrementPagedModeAndExit</span><button class="popup" onclick="togglePopup('usagePopup107')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup107">Usage of <span class="code-font"><span class="ACME-function-syntax">incrementPagedModeAndExit</span></span>:<br/><a href="S-s5.html#SP69">&#167;69</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cb19</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">INC</span><span class="ACME-plain-syntax"> .</span><a href="S-s2.html#SP14" class="function-link"><span class="ACME-function-syntax">pagedModeCounter</span></a><span class="ACME-plain-syntax">                               </span><span class="ACME-comment-syntax">increment paged mode counter</span>
<span class="ACME-plain-syntax">.</span><span class="ACME-function-syntax">exit5</span><button class="popup" onclick="togglePopup('usagePopup108')"><span class="ACME-comment-syntax">?</span><span class="popuptext" id="usagePopup108">Usage of <span class="code-font"><span class="ACME-function-syntax">exit5</span></span>:<br/><a href="S-s5.html#SP69">&#167;69</a></span></button><span class="ACME-plain-syntax"> </span><span class="ACME-comment-syntax">= $cb1c</span>
<span class="ACME-plain-syntax">    </span><span class="ACME-reserved-syntax">RTS</span><span class="ACME-plain-syntax">                                                 </span>
</pre>
<nav role="progress"><div class="progresscontainer">
    <ul class="progressbar"><li class="progressprev"><a href="S-s4.html">&#10094;</a></li><li class="progresssection"><a href="S-s1.html">1</a></li><li class="progresssection"><a href="S-s2.html">2</a></li><li class="progresssection"><a href="S-s3.html">3</a></li><li class="progresssection"><a href="S-s4.html">4</a></li><li class="progresscurrent">5</li><li class="progresssection"><a href="S-s6.html">6</a></li><li class="progresssection"><a href="S-s7.html">7</a></li><li class="progresssection"><a href="S-s8.html">8</a></li><li class="progresssection"><a href="S-s9.html">9</a></li><li class="progresssection"><a href="S-s10.html">10</a></li><li class="progresssection"><a href="S-s11.html">11</a></li><li class="progresssection"><a href="S-s12.html">12</a></li><li class="progresssection"><a href="S-s13.html">13</a></li><li class="progresssection"><a href="S-s14.html">14</a></li><li class="progresssection"><a href="S-s15.html">15</a></li><li class="progresssection"><a href="S-s16.html">16</a></li><li class="progresssection"><a href="S-s17.html">17</a></li><li class="progresssection"><a href="S-s18.html">18</a></li><li class="progresssection"><a href="S-s19.html">19</a></li><li class="progresssection"><a href="S-s20.html">20</a></li><li class="progresssection"><a href="S-s21.html">21</a></li><li class="progresssection"><a href="S-s22.html">22</a></li><li class="progresssection"><a href="S-s23.html">23</a></li><li class="progresssection"><a href="S-s24.html">24</a></li><li class="progresssection"><a href="S-s25.html">25</a></li><li class="progresssection"><a href="S-s26.html">26</a></li><li class="progressnext"><a href="S-s6.html">&#10095;</a></li></ul></div>
</nav><!--End of weave-->

		</main>
	</body>
</html>

